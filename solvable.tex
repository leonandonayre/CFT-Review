

\documentclass[12pt, a4paper]{article}

\raggedbottom

\RequirePackage[l2tabu, orthodox]{nag}

\usepackage[top=20mm,bottom=20mm,left=25mm,right=25mm]{geometry}

\usepackage{showkeys}

\usepackage{amsmath,amssymb,amsfonts}

\usepackage[table]{xcolor}

\usepackage{centernot}

\usepackage[nottoc]{tocbibind}

\usepackage{pgf}
\usepackage{tikz}
\usetikzlibrary{shapes.misc}
\tikzset{cross/.style={cross out, draw=black, thick, fill=none, minimum size=2*(#1-\pgflinewidth), inner sep=0pt, outer sep=0pt}, cross/.default={3pt}}
\newcommand{\uvertex}{
\coordinate (base) at (0, 1);
\draw (0, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
  \draw (3, 0) node [cross]{};
  \draw (0, 3) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
  \draw (3, 3) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
}

\usepackage{multirow}

\usepackage{xcolor}

% Syntax: \colorboxed[<color model>]{<color specification>}{<math formula>}
\newcommand*{\colorboxed}{}
\def\colorboxed#1#{%
  \colorboxedAux{#1}%
}
\newcommand*{\colorboxedAux}[3]{%
  % #1: optional argument for color model
  % #2: color specification
  % #3: formula
  \begingroup
    \colorlet{cb@saved}{.}%
    \color#1{#2}%
    \boxed{%
      \color{cb@saved}%
      #3%
    }%
  \endgroup
}

\usepackage[most]{tcolorbox}

\tcbset{
    frame code={}
    center title,
    left=0pt,
    right=0pt,
    top=0pt,
    bottom=0pt,
    colback=green!15,
    colframe=white,
    % width=\dimexpr\textwidth\relax,
    enlarge left by=0mm,
    % boxsep=5pt,
    arc=0pt,outer arc=0pt,
    breakable,
    }

\usepackage{amsthm}

\usepackage{thmtools}
%\usepackage{thm-restate}   This package does not interact very smoothly with \theoremstyle and \listoftheorems

\newtheoremstyle{break}{9pt}{9pt}{\itshape}{}{\bfseries}{}{\newline}{}
\theoremstyle{break}    

\newtheorem{exo}{Exercise}[section]
\newtheorem{hyp}[exo]{Axiom}
\newtheorem{res}[exo]{Result}
\newtheorem{defn}[exo]{Definition}

\makeatletter
\def\ll@exo{%
  \protect\numberline{\csname the\thmt@envname\endcsname}%
  \ifx\@empty\thmt@shortoptarg
    \thmt@thmname
  \else
    \thmt@shortoptarg
  \fi}
\def\l@thmt@exo{} 
\makeatother

\usepackage[colorlinks=true,linktoc=all,linkcolor=black,citecolor=red,urlcolor=blue,backref=page]{hyperref}

\usepackage{etoolbox}
\makeatletter
\patchcmd{\BR@backref}{\newblock}{\newblock(}{}{}
\patchcmd{\BR@backref}{\par}{)\par}{}{}
\makeatother

\renewcommand{\arraystretch}{1.5}

\title{\bfseries Exactly solvable conformal field theories}

\author{Sylvain Ribault \vspace{2mm}
\\
{\normalsize CEA Saclay, Institut de Physique Th\'eorique}
 \\
 {\footnotesize \ttfamily sylvain.ribault@ipht.fr }
}

\begin{document}


\maketitle


\begin{abstract}
In this course, we review two-dimensional CFT in the bootstrap approach, and sketch the known exactly solvable CFTs with no extended chiral symmetry: Liouville theory, (generalized) minimal models, limits thereof, and loop CFTs, including the $O(n)$, Potts and $U(n)$ CFTs. 

Exact solvability relies on local conformal symmetry, and on the existence of degenerate fields: we explain how these assumptions constrain the spectrum and correlation functions. We discuss the crossing symmetry equations, and how they can be solved analytically or numerically, leading to  
analytic formulas for structure constants. 

In the case of loop CFTs, we review the combinatorial description of correlation functions, inspired by the lattice construction of statistical models. We sketch what remains to be done for solving the models. 

% Nothing on log CFT. 

The plan is: 
\begin{enumerate}
 \item The Virasoro algebra and its representations. Fields and operator product expansions.
 \item Fusion rules and fusion products. Correlation functions and Ward identities. Crossing symmetry and conformal blocks. 
 \item Defining a CFT. Diagonal and non-diagonal fields, degenerate fields. Exactly solvable CFTs and their spectrums. 
 \item Degenerate 4-point functions. Analytic formulas for 2-point and 3-point structure constants. 
 \item Computing conformal blocks. Numerical bootstrap.
 \item Correlation functions in loop CFTs. 
\end{enumerate}
\end{abstract}

\vspace{5mm}


\clearpage

\tableofcontents

\hypersetup{linkcolor=blue}

\numberwithin{equation}{section}
%\setcounter{secnumdepth}{2}
%\setcounter{tocdepth}{2}
\setcounter{section}{-1}

\section{Introduction}

\subsubsection*{Exact solvability in CFT}

In 1997, di Francesco, Mathieu and Sénéchal wrote a book called Conformal field theory \cite{fms97}, which dealt almost exclusively with \textit{two-dimensional} conformal field theory. Today, a book with that title would be expected to also cover CFT in $d\geq 3$. However, when it comes to CFTs that we can solve exactly, we are back to $d=2$, because exact solvability relies on two ingredients:
\begin{itemize}
 \item An infinite-dimensional algebra of conformal transformations --- but in $d\geq 3$ the algebra is finite-dimensional. 
 \item Degenerate fields: fields whose OPEs with other fields have finitely many terms, modulo conformal symmetry. 
\end{itemize}
This gives us access to powerful bootstrap techniques, analytic and numerical. In contrast, in higher dimensions, numerical bootstrap techniques rely on the assumption of unitarity. Not only this restricts the CFTs that can be addressed, but also this leads to inequalities rather than equalities, making it harder to reach exact results. 
Even in two dimensions, solvable CFTs are very special cases. Starting from a simple CFTs and following a renormalization group flow, you can easily end up at a fixed point whose CFT is intractable. 

\subsubsection*{Solvable CFTs}

We will deal first of all with CFTs that are considered solved, in that we exactly know the three-point structure constants, and can compute any correlation function to arbitrary precision:
\begin{itemize}
 \item Liouville theory,
 \item (generalized) minimal models, and limits thereof. 
\end{itemize}
We will also propose a unified treatment of loop CFTs, which are not solved but are believed to be solvable, because we have sufficiently many exact results. By loop CFTs we mean a large class of CFTs, with various global symmetry groups, which describe critical limits of various statistical models in various phases, and have various applications: percolation, polymers, and more recently active hydraulics \cite{jcpb23}. 
The known solvable CFTs have fewer applications to gravity: in particular, any CFT holographically dual to three-dimensional gravity should exist in the large central charge limit, which corresponds to the classical limit of gravity; but there are strong technical reasons why non-trivial solvable CFTs must have small central charges. (See Section \ref{sec:dotc}.) 

There are other solved or solvable CFTs that we will not mention, because they have extended chiral algebras, which means extra local symmetries in addition to conformal symmetry. Some CFTs of that type can be solved with the methods that we will cover, for example certain Wess--Zumino--Witten models. 

\subsubsection*{Solving CFTs}

When a CFT is solvable, it can typically be solved in several different ways. In this text, we will only use the conformal bootstrap approach, and omit other historically relevant techniques such as Coulomb gas integrals, and the modular bootstrap. We believe that the conformal bootstrap approach is technically simpler, more general, and more powerful. In particular, our main objects are correlation functions on the sphere, and we do not have a rigid notion of which fields belong to a CFT. For example, in the Ising model, we can introduce disorder fields or compute cluster connectivities, without having to worry about modular invariance of the torus partition function. 

We are not claiming that our approach is always mathematically rigorous: our main concern is to provide simple derivations of non-trivial results, without introducing too many auxiliary objects that are later discarded. The calculations are not all done in detail but they should be doable with reasonable effort. Readers who want formal exercises are directed to earlier texts in the same spirit: the minimal review \cite{rib16}, and the more extended review \cite{rib14}. However, these texts do not cover loop CFTs.


\subsection*{Acknowledgements}

This text was initially written as lecture notes for a course given at IPhT Saclay in March-April 2024. I am grateful to the course organizers Riccardo Guida, Pierfrancesco Urbani and Monica Guica. I would like to thank Linnea Grans-Samuelsson, Jesper Jacobsen, Santiago Migliaccio, Nikita Nemkov, Rongvoram Nivesvivat, Marco Picco, Paul Roux, Hubert Saleur, and Raoul Santachiara for collaboration on loop CFTs and related subjects. Moreover, I am grateful to Jesper Jacobsen and Paul Roux for helpful discussions. 


%\end{tcolorbox}

\section{Basics of two-dimensional CFT}\label{sec:bo}

In this section we introduce conformal symmetry, fields, operator product expansions, and correlation functions. In particular, we emphasize the two ingredients of exact solvability: \textit{local} conformal symmetry and \textit{degenerate} fields. We begin with the Virasoro algebra, which describes local conformal transformations. 

\subsection{The Virasoro algebra and its representations}\label{sec:vir}

\subsubsection{The Virasoro algebra}

Let us consider the Riemann sphere $\overline{\mathbb{C}}=\mathbb{C}\cup \{\infty\}$, equipped with the metric $ds^2 = dzd\bar z$. By definition, a \textbf{conformal transformation} of a Riemannian manifold is a transformation that preserves angles. On any open subset of the Riemann sphere, any holomorphic map $z\to f(z)$ is conformal, because it transforms the metric into itself, up to a scalar factor: 
\begin{align}
 dzd\bar z\to dfd\bar f = |f'(z)|^2 dzd\bar z\ .
\end{align}
Conversely, any conformal map is holomorphic. 
In a quantum field theory on the Riemann sphere, states live on a Euclidean time slice $|z|=1$, so we consider conformal transformations of that circle, equivalently of $\mathbb{C}^*= \mathbb{C}\backslash \{0\}$.
Let the \textbf{Witt algebra} be the algebra of infinitesimal conformal transformation of $\mathbb{C}^*$: this algebra is infinite-dimensional, with the basis 
\begin{align}
 \left(\ell_n\right)_{n\in\mathbb{Z}}  \quad \text{with} \quad \ell_n = -z^{n+1}\frac{\partial}{\partial z}\ ,
 \label{lpz}
\end{align}
and the commutation relations 
\begin{align}
 [\ell_n,\ell_m] = (n-m)\ell_{m+n}\ .
\end{align}
The generators of the Witt algebra include the translation generator $\ell_{-1} = -\frac{\partial}{\partial z}$, and the dilation generator $\ell_0 = -z\frac{\partial}{\partial z}$. In fact, $(\ell_{-1},\ell_0,\ell_1)$ generate the infinitesimal conformal transformations of the Riemann sphere.
The corresponding Lie group is the group of \textbf{global conformal transformations} $PSL_2(\mathbb{C})$, whose elements act as 
\begin{align}
 z \mapsto \frac{az+b}{cz+d}\quad , \quad (a,b,c,d\in \mathbb{C},\ ad-bc\neq 0)\ .
 \label{abcd}
\end{align}
Now, in a quantum theory, symmetries act projectively on states. And projective representations of an algebra are equivalent to representations of that algebra's central extension. Therefore, the algebra that describes local conformal transformations in conformal field theory is the Witt algebra's central extension, called the Virasoro algebra. The \textbf{Virasoro algebra} $\mathfrak{V}$ has generators $(L_n)_{n\in\mathbb{Z}}$ that correspond to the Witt algebra generators, plus a central generator $\mathbf 1$. The commutation relations are 
 \begin{align}
  [\mathbf 1, L_n] = 0 \quad , \quad \boxed{[L_n,L_m] = (n-m)L_{n+m} +\frac{c}{12}(n-1)n(n+1)\delta_{n+m,0}\mathbf 1} \ .
  \label{vir}
 \end{align}
 The \textbf{central charge} $c\in\mathbb{C}$ is a fundamental parameter not only of the Virasoro algebra, but also of any conformal field theory built on that algebra. 

\subsubsection{Highest-weight representations}\label{sec:hwr}

In a conformal field theory, the space of states is a representation of the Virasoro algebra, and can be decomposed into indecomposable representations. But which indecomposable representations are physically relevant? To answer this question, we will focus on the properties of the dilation generator $L_0$ of the Virasoro algebra. Conceptually, this is because $L_0$ can be interpreted as the energy operator. Technically, this is because $L_0$ controls the convergence of operator product expansions, as we will see in Section \ref{sec:csope}. More specifically, a necessary condition for convergence is that the eigenvalues of $L_0$ be bounded from below in any indecomposable representation. We will always assume that this condition holds.

The eigenvalues of $L_0$ are called \textbf{conformal dimensions}. Under the action of the Virasoro generator $L_n$, the conformal dimension decreases by $n$. For any vector $V$ in a representation of the Virasoro algebra, we indeed have 
\begin{align}
 L_0V{} = \Delta V{} \quad \Rightarrow\quad  L_0 L_nV{} = L_nL_0V{} + [L_0, L_n] V{}  = (\Delta-n)L_nV{} \ .
\end{align}
In an indecomposable representation $\mathcal{R}$, the $L_0$-eigenstate with the lowest eigenvalue must therefore be annihilated by $L_{n>0}$. This eigenstate is therefore a \textbf{primary state}, where we define a primary state $V_\Delta$ of conformal dimension $\Delta$ by 
\begin{align}
  \boxed{L_0 V_\Delta = \Delta V_\Delta \quad , \quad L_{n>0} V_\Delta = 0}\ .
 \end{align}
Let us introduce a basis of \textbf{creation operators},
\begin{align}
 \mathcal{L} = \left\{\prod_{i=1}^k L_{-n_i} \right\}_{k\in\mathbb{N},\ 0<n_1\leq \dots \leq n_k}==\left\{1, L_{-1}, L_{-1}^2, L_{-2},\cdots \right\}\ .
 \label{lcm}
\end{align}
Any state of the type $L V{}$ with $L\in\mathcal{L}$ is called a \textbf{descendant state} of the primary state $V$. Let  $N=|L|=\sum_{i=1}^k n_i \in\mathbb{N}$ be the  \textbf{level} of that state, then its conformal dimension is $\Delta+N$. By extension, a linear combination of descendant states is also called a descendant state. 

A primary state $V{} \in \mathcal{R}$ generates a subrepresentation $\mathcal{R}_{V{}}= \text{Span}(LV{})_{L\in\mathcal{L}}\subset\mathcal{R}$, which is the space of its descendant states. If the states $(LV{})_{L\in\mathcal{L}}$ are linearly independent, then $\mathcal{R}_{V{}}$ is called the \textbf{Verma module} $\mathcal{V}_\Delta$. If not, $\mathcal{R}_{V{}}$ is a quotient of $\mathcal{V}_\Delta$ by a subrepresentation: such quotients are called \textbf{highest-weight representations}. In such a representation, $L_0$ is diagonalizable. 
Let us sketch a Verma module by displaying all its basis states up to the level $N=3$, with arrows representing the action of the Virasoro generators $L_{-1},L_{-2},L_{-3}$:
\begin{align}
 \begin{tikzpicture}[scale = .25, baseline=(current  bounding  box.center)]
  \draw[-latex, very thick] (20, 0) -- (20, -21) node [right] {$N$};
  \foreach \x in {0, ..., 3}
  {
  \draw [dotted] (-20, {-6*\x}) -- (20, {-6*\x}) node [right] {${\x}$};
  }
  \node[fill = white] at (0, 0) (0) {$V{}$};
  \node[fill = white] at (-4,-6) (1) {$L_{-1}V{}$};
  \node[fill = white] at (-8, -12) (11) {$L_{-1}^2V{}$};
  \node[fill = white] at (-12, -18) (111) {$L_{-1}^3V{}$};
  \node[fill = white] at (0,-12) (2) {$L_{-2}V{}$};
  \node[fill = white] at (0,-18) (12) {$L_{-1}L_{-2}V{}$};
  \node[fill = white] at (8,-18) (3) {$L_{-3}V{}$};
  \draw[-latex] (0) -- (1);
  \draw[-latex] (1) -- (11);
  \draw[-latex] (11) -- (111);
  \draw[-latex] (0) -- (2);
  \draw[-latex] (0) -- (3);
  \draw[-latex] (2) -- (12);
 \end{tikzpicture}
\end{align}
We do not display $L_{-2}L_{-1}V = L_{-1}L_{-2}V -L_{-3}V$, as it is a combination of already displayed states. 

\subsubsection{Null vectors of Verma modules}\label{sec:nvvm}

In a representation of the Virasoro algebra, we define a \textbf{null vector} or singular vector as a primary state that is a descendant of another primary state. Null vectors play an important structural role: a highest-weight representation is irreducible if and only if it has no null vector. 

Let us look for null vectors in the Verma module $\mathcal{V}_\Delta$. This can be done level by level, starting with level $1$. That level is generated by a single state $L_{-1}V_\Delta$. To determine whether that state is primary, let us determine how it behaves under the action of $L_{n\geq 1}$:
\begin{align}
L_n L_{-1}V_\Delta = [L_n, L_{-1}] V_\Delta = (n+1) L_{n-1}V_\Delta = 
\left\{\begin{array}{ll} 0 &  \quad \text{if } n\geq 2\ , \\ 2\Delta V_\Delta & \quad \text{if } n = 1\ . \end{array}\right. 
\end{align}
Therefore, $\mathcal{V}_\Delta$ has a null vector at level $1$ if and only if $\Delta=0$. Next, consider the case of level $2$, where we write states as 
\begin{align}
 X{} = \left(a^{L_{-1}^2} L_{-1}^2 + a^{L_{-2}} L_{-2}\right) V_\Delta\ ,
\end{align}
where $a^{L_{-1}^2}$ and $a^{L_{-2}}$ are complex coefficients. It is easy to show that $L_{n\geq 3}X{}=0$, and we compute 
\begin{align}
 L_1X{} &= \left((4\Delta+2)a^{L_{-1}^2} + 3a^{L_{-2}}\right) L_{-1}V_\Delta\ ,
 \label{l1c}
\\
L_2 X{} &= \left(6\Delta a^{L_{-1}^2}+(4\Delta+\tfrac12 c) a^{L_{-2}}\right)V_\Delta\ .
\label{l2c}
\end{align}
Therefore, the conditions $L_1X{}=L_2 X{}=0$ for $X{}$ to be a null vector boil down to a system of two linear equations for the coefficients $(a^{L_{-1}^2},a^{L_{-2}})$. The vanishing of that system's determinant determines the conformal dimension $\Delta$ as a function of the central charge $c$,
\begin{align}
 \Delta = \frac{1}{16}\left( 5-c\pm\sqrt{(c-1)(c-25)} \right) \ .
 \label{dpm}
\end{align}
Solving CFTs will lead to fairly complicated formulas, which would become even more complicated if we tolerated a square root at this early stage.
To get rid of the square root, we rewrite the central charge in terms a the parameter $\beta$ such that 
\begin{align}
 \boxed{c = 1- 6\left(\beta - \beta^{-1}\right)^2 } \ .
 \label{cb}
\end{align}
Then the conformal dimensions \eqref{dpm} become 
$
 \Delta = -\frac12 + \frac34\beta^{\pm 2}
$. The price to pay for this simplification is that the four values $\beta,-\beta,\beta^{-1},-\beta^{-1}$ all correspond to the same central charge. 

More generally, there is an infinite family of conformal dimensions $(\Delta_{(r, s)})_{r,s\in\mathbb{N}^*}$ such that $\mathcal{V}_{\Delta_{(r, s)}}$ has a null vector $L_{\langle r,s\rangle} V_{\Delta_{(r, s)}}$ at level $N=rs$. Let us summarize the cases $N=1,2$ in these notations:
\begin{align}
\begin{array}{|c|c|c|c|}
\hline 
N & (r, s) & \Delta_{(r, s)} &  L_{\langle r,s\rangle} 
\\
\hline\hline
1 & (1, 1) & 0 &  L_{-1}
\\
\hline
\multirow{2}{*}{2} & 
(2, 1) & -\frac12 + \frac34 \beta^{2}  & L_{-1}^2 -\beta^{2} L_{-2}
\\
\cline{2-4}
& (1, 2) & -\frac12 + \frac34 \beta^{-2} & L_{-1}^2 -\beta^{-2} L_{-2} 
\\
\hline
\end{array}
\label{ars}
\end{align}
To write $\Delta_{(r, s)}$ for any $r,s\in\mathbb{N}^*$, we rewrite the conformal dimension in terms of the momentum $P$ defined by 
\begin{align}
 \boxed{\Delta = \frac{c-1}{24} + P^2}\ .
 \label{dp}
\end{align}
We can rewrite Verma modules as $\mathcal{V}_P=\mathcal{V}_{-P}$, where the parameter $P$ is redundant due to the invariance under the \textbf{reflection} $P\to -P$. The dimensions $\Delta_{(r, s)}$ correspond to the momentums 
\begin{align}
 \boxed{P_{(r, s)} = \frac12\left(r\beta -s\beta^{-1}\right)}\ ,
 \label{prs}
\end{align}
and it follows that the null vector $L_{\langle r,s\rangle} V_{\Delta_{(r, s)}}$ is a primary state of dimension
\begin{align}
 \Delta_{(r, s)} + rs = \Delta_{(r, -s)}\ , 
 \label{drms}
\end{align}
We will provide a derivation of $P_{(r, s)}$ using operator product expansions in Section \ref{sec:dope}. On the other hand, the expressions of $L_{\langle r,s\rangle} $ are complicated and not particularly useful. 

For $\beta^2\in\mathbb{C}\backslash \mathbb{Q}$, the Verma module $\mathcal{V}_\Delta$ has a null vector if and only if $\Delta=\Delta_{(r, s)}$ for some $r,s\in\mathbb{N}^*$, in which case it has only one null vector. For $\beta^2\in\mathbb{Q}$ however, a Verma module can have several null vectors. If $\beta^2 = \frac{q}{p}$ with $p,q$ coprime integers, we indeed have the identity
\begin{align}
 \Delta_{(r+p,s+q)} = \Delta_{(r,s)}\ ,
 \label{rpsq}
\end{align}
which together with $\Delta_{(r,s)}=\Delta_{(-r,-s)}$ implies infinitely many coincidences of the type $\Delta_{(r,s)}=\Delta_{(r_1,s_1)}$ with $r_1,s_1\in\mathbb{Z}$. 
Whenever $r_1,s_1>0$, the Verma module $\mathcal{V}_{\Delta_{(r,s)}}$ has a null vector $L_{\langle r_1,s_1\rangle} V_{\Delta_{(r,s)}}$. 
Moreover, if we apply the identity \eqref{rpsq} to the dimension $\Delta_{(r_1,-s_1)}$ \eqref{drms} of that null vector, we find that it is itself of the type $\Delta_{\langle r_2,s_2\rangle}$. If $r_2,s_2>0$, this leads to another null vector $L_{\langle r_2,s_2\rangle}L_{\langle r_1,s_1\rangle} V_{\Delta_{(r,s)}}$. It turns out that all null vectors of Verma modules are of the type $L_{\langle r_1,s_1\rangle} V_{\Delta_{(r,s)}}$ or $L_{\langle r_2,s_2\rangle}L_{\langle r_1,s_1\rangle} V_{\Delta_{(r,s)}}$. In particular,
\begin{align}
 \exists r_4,s_4\in \mathbb{N}^*\ , \ L_{\langle r_3,s_3\rangle}L_{\langle r_2,s_2\rangle}L_{\langle r_1,s_1\rangle} V_{\Delta_{(r,s)}} = L_{\langle r_4,s_4\rangle} V_{\Delta_{(r,s)}}\ .
 \label{lllel}
\end{align}
To see this, let $\epsilon,\eta\in\{+,-\}$ be the signs such that $P_{(-r_1,s_1)}=\epsilon P_{(r_2,s_2)}$ and $P_{(r_2,-s_2)}=\eta P_{(r_3,s_3)}$, and let $r_4=|\epsilon r_1-r_2+\eta r_3|$ and $s_4=|\epsilon s_1+s_2+\eta s_3|$, then $\sum_{i=1}^3 r_is_i=r_4s_4$, i.e. the two null vectors in Eq. \eqref{lllel} have the same level. 

 Numbers of null vectors depend a lot on the sign of $\beta^2$. If $\beta^2<0$, then $\{\Delta_{(r, s)}\}_{r,s\in\mathbb{N}^*}$ is bounded from above, and Eq. \eqref{drms} implies that a Verma module can only have finitely many null vectors. If $\beta^2>0$, then by Eq. \eqref{rpsq} the existence of a null vector implies the existence of infinitely many others: 
\begin{align}
 \begin{array}{|c||c|c|c|}
  \hline 
  \text{Value of }\beta^2 & \mathbb{C}\backslash \mathbb{Q} & \mathbb{Q}_{>0} & \mathbb{Q}_{<0}
  \\
  \hline 
  \text{Value of }c & \text{generic} & c\leq 1 , c\in\mathbb{Q} &  c\geq 25, c\in\mathbb{Q}
  \\
  \hline 
  \#\text{null vectors in } \mathcal{V}_{\Delta_{(r, s)}} & 1 & \infty & \text{finite} 
  \\
  \hline 
 \end{array}
\end{align}
To illustrate the two cases $\beta^2\in \mathbb{Q}_{>0}$ and $\beta^2\in \mathbb{Q}_{<0}$, let us plot at each $(r,s)\in \{1,\dots, 10\}^2$ a dot whose size increases with 
$\Delta_{(r,s)}$, together with the vector $(p, q)$ of Eq. \eqref{rpsq} as a red arrow:
\begin{align}
 \begin{tikzpicture}[baseline=(base), scale = .5]
 \coordinate (base) at (0, 4);
  \draw[latex-latex] (0, 10) node [left] {$s$} -- (0, 0) node[below left] {$0$} -- (10, 0) node [below] {$r$};
  \draw[thick, red, -latex] (0, 0) -- (5, 3);
  \foreach \r in {1,...,10}{
  \foreach \s in {1,...,10}{
  %\pgfmathsetmacro{\mycol}{100-1.8*abs(3*\r-5*\s)}
  %\filldraw[black!\mycol] (\r, \s) circle [radius = 4pt];
  \pgfmathsetmacro{\myrad}{.2+.12*abs(3*\r-5*\s)}
  \filldraw (\r, \s) circle [radius = \myrad pt];
  }}
  \node at (5, -2) {$\beta^2 = \frac35>0$};
 \end{tikzpicture}
 \qquad \qquad
 \begin{tikzpicture}[baseline=(base), scale = .5]
 \coordinate (base) at (0, 4);
  \draw[latex-latex] (0, 10) node [left] {$s$} -- (0, 0) node[below left] {$0$} -- (10, 0) node [below] {$r$};
  \draw[thick, red, -latex] (5, 0) -- (0, 3);
  \foreach \r in {1,...,10}{
  \foreach \s in {1,...,10}{
  %\pgfmathsetmacro{\mycol}{3*\r+5*\s}
  %\filldraw[black!\mycol] (\r, \s) circle [radius = 4pt];
  \pgfmathsetmacro{\myrad}{6-(3*\r+5*\s)/15}
  \filldraw (\r, \s) circle [radius = \myrad pt];
  }}
  \node at (5, -2) {$\beta^2 = -\frac35<0$};
 \end{tikzpicture}
\end{align}

\subsubsection{Vanishing and non-vanishing null vectors}

When a representation $\mathcal{R}$ has a null vector $X{}=LV{}$, this allows us to define a quotient representation $\frac{\mathcal{R}}{\mathcal{R}_{X{}}}$ by setting the null vector to zero. 
By an abuse of terminology, we say that $\frac{\mathcal{R}}{\mathcal{R}_{X{}}}$ has a \textbf{vanishing null vector}, which really means that the primary state $V{}$ obeys the \textbf{null vector equation} $LV{}=0$. On the other hand, $\mathcal{R}$ itself has a non-vanishing null vector $X{}$. 

If $\mathcal{R}$ has several null vectors, we can define various quotient representations by setting some null vectors to zero. A \textbf{degenerate representation} is a representation that has at least one vanishing null vector. A degenerate representation is partly degenerate if it has some non-vanishing null vectors, and \textbf{fully degenerate} if all null vectors vanish. Partly degenerate representations play an important role in CFTs with extended chiral algebras, such as conformal Toda theories \cite{fl07c}. But most degenerate representations that we will consider will be fully degenerate. 

For $r,s\in\mathbb{N}^*$, let us call $\mathcal{R}^d_{\langle r,s\rangle}$ the quotient of the Verma module $\mathcal{V}_{\Delta_{\langle r,s\rangle}}$ where the null vector $L_{\langle r,s\rangle}V_{\Delta_{(r,s)}}$ vanishes:
\begin{align}
 \mathcal{R}^d_{\langle r,s\rangle} 
 =\frac{\mathcal{V}_{\Delta_{\langle r,s\rangle}}}{\mathcal{V}_{\Delta_{\langle r,-s\rangle}}}\ . 
 \label{rvv}
\end{align}
If $\beta^2\in \mathbb{Q}$, the Verma module $\mathcal{V}_{\Delta_{\langle r,s\rangle}}$ in general has several null vectors, and $\mathcal{R}^d_{\langle r,s\rangle}$ may be partly degenerate. Let us call $\mathcal{R}^f_{\langle r,s\rangle}$ the fully degenerate quotient of  $\mathcal{V}_{\Delta_{\langle r,s\rangle}}$: this quotient can generally not be obtained by setting one null vector to zero, but it is always enough to set two null vectors to zero, with all other null vectors being descendants of these two. Schematically,
\begin{align}
 \mathcal{R}^f_{\langle r,s\rangle} = \frac{\mathcal{V}_{\Delta_{\langle r,s\rangle}}}{\mathcal{V}_{\Delta_{\langle r_1,-s_1\rangle}}+ \mathcal{V}_{\Delta_{\langle r_2,-s_2\rangle}}}\ .
\end{align}
We define the \textbf{degenerate state} $V^d_{\langle r,s\rangle}$ and \textbf{fully degenerate state} $V^f_{\langle r,s\rangle}=V^f_{\langle r_1,s_1\rangle}=V^f_{\langle r_2,s_2\rangle}$ as the primary states of the representation $\mathcal{R}^d_{\langle r,s\rangle}$ and 
$\mathcal{R}^f_{\langle r,s\rangle}$. These states obey the null vector equation
\begin{align}
L_{\langle r, s\rangle} V^d_{\langle r,s\rangle} = L_{\langle r, s\rangle} V^f_{\langle r,s\rangle} = 0\ .
\label{lvdz}
\end{align}
The primary state $V_{\Delta_{(r,s)}}$ has the same dimension as $V^d_{\langle r,s\rangle}$ and $V^f_{\langle r,s\rangle}$, but does not necessarily obey the null vector equation. 

\subsection{Fields and operator product expansions}\label{sec:fope}

The fundamental objects of conformal field theory are fields. In quantum field theory, all states can be obtained by acting on the vacuum state with fields: this is called the \textbf{state-field correspondence} or operator-state correspondence. In conformal field theory, the correspondence is bijective, and allows us to identify the space of fields with the \textbf{space of states} or \textbf{spectrum}  --- a vector space on which the Virasoro algebra acts. To a state $V$, the correspondence associates a field $V(z)$, which depends on a position $z\in\overline{\mathbb{C}}$ in the Riemann sphere. Primary states, descendant states and degenerate states respectively give rise to \textbf{primary fields}, \textbf{descendant fields} and \textbf{degenerate fields}.

In the bootstrap approach, which is axiomatic rather than constructive, we need not define fields. Rather, we use fields as convenient notations for stating properties of correlation functions, which we will introduce in Section \ref{sec:cor}. 

\subsubsection{The energy-momentum tensor}

The dependence of fields on the coordinate $z$ is determined by the assumption that the Virasoro generator $L_{-1}$ generates translations, just like the Witt algebra generator $\ell_{-1}$ \eqref{lpz}:
\begin{align}
  \boxed{\frac{\partial}{\partial z} V(z) = L_{-1} V(z)}  \ .
  \label{pvlv}
 \end{align}
 Since fields depend on $z$, the Virasoro algebra that acts on fields also depends on $z$. This can be made explicit using the notation
\begin{align}
   L_n V(z) = L_n^{(z)} V(z) \ . 
\end{align}
Applying Eq. \eqref{pvlv} to $L_n^{(z)} V(z)$, we find how the Virasoro generator $L_n^{(z)}$ depends on $z$,
 \begin{align}
 \frac{\partial}{\partial z} L_n^{(z)} = [L_{-1}^{(z)},L_n^{(z)}]= -(n+1)L_{n-1}^{(z)}\ ,\qquad (\forall n\in\mathbb{Z})\ .
\end{align}
This can be rewritten as the $z$-independence of a formal Laurent series that combines all the generators $(L_n^{(z)})_{n\in\mathbb{Z}}$, 
\begin{align}
 \frac{\partial}{\partial z} \sum_{n\in\mathbb{Z}} \frac{L_n^{(z)}}{(y-z)^{n+2}} = 0\ ,\qquad (\forall y\in\mathbb{C}\backslash \{z\})\ .
\end{align}
The formal Laurent series is then called the \textbf{energy-momentum tensor}, 
\begin{align}
  \boxed{T(y) = \sum_{n\in\mathbb{Z}} \frac{L_n^{(z)}}{(y-z)^{n+2}}} \ .
  \label{tl}
 \end{align}
 A priori, the energy-momentum tensor only makes sense when acting on a field $V(z)$,
 \begin{align}
 T(y)V(z) = \sum_{n\in\mathbb{Z}} \frac{L_n V(z)}{(y-z)^{n+2}}\quad , \quad L_n V(z) = \frac{1}{2\pi i} \oint_{z}dy\ (y-z)^{n+1} T(y)V(z)\ .
 \label{lvtv}
\end{align}
However, we will shortly interpret $T(y)$ as a field, and $T(y)V(z)$ as an operator product expansion of two fields. For the moment, let us apply this equation to a primary field $V_\Delta(z)$. Using Eq. \eqref{pvlv} and writing the regular terms as $O(1)$, we obtain
\begin{align}
 \boxed{T(y)V_\Delta(z) = \frac{\Delta}{(y-z)^2} V_\Delta(z) + \frac{1}{y-z} \frac{\partial}{\partial z} V_\Delta(z) + O(1)}\ .
 \label{tvd}
\end{align}
This is equivalent to the statement that $V_\Delta(z)$ is a primary field of dimension $\Delta$.

\subsubsection{Operator product expansions}\label{sec:ope}

The fundamental axiom of conformal field theory, which underlies the conformal bootstrap approach, is the existence of \textbf{operator product expansions (OPEs)}. This axiom states that there exists a bilinear product on the space of fields. Given a basis $(V_k)_k$ of the space of states, this reads 
\begin{align}
  \boxed{V_1(z_1)V_2(z_2) = \sum_k C^k_{12}(z_1,z_2) V_k(z_2)}\ ,
  \label{ope}
 \end{align}
for some \textbf{OPE coefficients} $C^k_{12}(z_1,z_2)$. Operator product expansions generally exist in quantum field theory, but they are particularly useful in conformal field theory because they are supposed to hold for any $z_1$ in a finite neighbourhood of $z_2$ (but $z_1\neq z_2$), and not just asymptotically as $z_1\to z_2$. The finite neighbourhood in question may depend on the correlation function in which we perform the OPE, and also on the basis $(V_k)_k$. 

We further assume that the product of fields is commutative,
\begin{align}
 \boxed{V_1(z_1)V_2(z_2) = V_2(z_2)V_1(z_1)}\ .
 \label{comm}
\end{align}
This implies that OPEs are commutative and associative. However, the resulting constraints on the coefficients $C^i_{12}(z_1,z_2)$ are not particularly simple, because of having to choose a position ($z_2$ in our conventions) for the fields in the right-hand side of the OPE \eqref{ope}. 

We also assume that there exists an \textbf{identity field} $I(z)$ whose OPE with any other field is trivial, namely $I(z_1)V(z_2) = V(z_2)$. (The corresponding state is called the vacuum state.) Let us consider the energy-momentum tensor $T$ as a field, then we have 
$
 T(y)I(z) = T(y) = T(z)  + O(y-z)
$. 
Comparing this with Eq. \eqref{lvtv} applied to $I(z)$, we find 
\begin{align}
 L_{n\geq -1} I(z) = 0 \quad , \quad T(z) = L_{-2}I(z)\ .
\end{align}
In particular, the identity field is a degenerate primary field of conformal dimension zero, with a vanishing null vector at level $1$, i.e. $I(z) \propto V^d_{\langle 1,1\rangle}(z)$. And from the expression of $T(z)$ as a descendant of that field, we deduce
\begin{align}
 T(y)T(z) = \frac{\frac{c}{2}}{(y-z)^4} + \frac{2T(z)}{(y-z)^2} + \frac{\partial T(z)}{y-z} + O(1)\ .
\label{tt}
\end{align}
This OPE is equivalent to the commutation relations of the Virasoro algebra \eqref{vir}.

\subsubsection{Conformal symmetry constraints on OPEs}\label{sec:csope}

For technical simplicity, we focus on an OPE of two primary fields. In that OPE, we single out the contributions of a primary field $V_\Delta$ and its descendants:
\begin{align}
 V_{\Delta_1}(z_1)V_{\Delta_2}(z_2) \supset \sum_{L\in \mathcal{L}} C_{\Delta_1,\Delta_2}^{\Delta, L}(z_1,z_2) LV_\Delta(z_2) \ ,
\end{align}
where $\mathcal{L}$ \eqref{lcm} is the set of creation operators. On both sides of the OPE, we insert $\frac{1}{2\pi i}\oint_{z_1,z_2} dy (y-z_2)^{n+1}T(y)$, where the integration contour encloses both $z_1$ and $z_2$. Using Eqs. \eqref{lvtv} and \eqref{tvd}, we find
\begin{align}
 \left(L_n^{(z_2)} +z_{12}^{n+1}\partial_{z_1} + (n+1)z_{12}^n\Delta_1\right) V_{\Delta_1}(z_1)V_{\Delta_2}(z_2) \supset \sum_{L\in \mathcal{L}} C_{\Delta_1,\Delta_2}^{\Delta, L}(z_1,z_2)L_nLV_\Delta(z_2) \ .
\end{align}
We focus on three cases:
\begin{itemize}
 \item $\boxed{n=-1}$\ : We use Eq. \eqref{pvlv} for $V_{\Delta_2}(z_2)$ and $LV_{\Delta}(z_2)$, and perform the OPE again on the left-hand side:
 \begin{align}
 \left(\partial_{z_1}+\partial_{z_2}\right) \sum_{L\in \mathcal{L}} C_{\Delta_1,\Delta_2}^{\Delta, L}(z_1,z_2)LV_\Delta(z_2) = \sum_{L\in \mathcal{L}} C_{\Delta_1,\Delta_2}^{\Delta, L}(z_1,z_2)\partial_{z_2} LV_\Delta(z_2) \ .
 \end{align}
 This leads to $(\partial_{z_1}+\partial_{z_2})C^{\Delta,L}_{\Delta_1,\Delta_2}(z_1,z_2)=0$, i.e. translation invariance of the OPE coefficients.
 \item $\boxed{n=0}$\ : We use $L_0LV_{\Delta}(z_2)= (\Delta+|L|) V_{\Delta}(z_2)$, and perform the OPE again on the left-hand side. This leads to $(z_{12}\partial_{z_1}+\Delta_1+\Delta_2-\Delta-|L|)C^{\Delta,L}_{\Delta_1,\Delta_2}(z_1,z_2) = 0$, and we deduce the dependence of OPE coefficients on $z_1,z_2$:
 \begin{align}
  C^{\Delta,L}_{\Delta_1,\Delta_2}(z_1,z_2) = z_{12}^{\Delta+|L|-\Delta_1-\Delta_2} C^{\Delta,L}_{\Delta_1,\Delta_2}\ . 
 \end{align}
\item $\boxed{n\geq 1}$\ : We use $L_n^{(z_2)}V_{\Delta_2}(z_2)=0$, and perform the OPE again on the left-hand side. The action of the differential operator on the OPE coefficients is now known, and we find 
\begin{align}
 \sum_{L\in\mathcal{L}} C^{\Delta,L}_{\Delta_1,\Delta_2}z_{12}^{|L|+n}(\Delta+|L|+n\Delta_1-\Delta_2) LV_{\Delta}= \sum_{L\in\mathcal{L}} C^{\Delta,L}_{\Delta_1,\Delta_2}z_{12}^{|L|}L_n LV_{\Delta}\ .
\end{align}
Extracting the coefficient of $z_{12}^N$ for some $N\in\mathbb{N}$, we find 
\begin{align}
 (\Delta+N-n+n\Delta_1-\Delta_2)\sum_{|L|=N-n} C^{\Delta,L}_{\Delta_1,\Delta_2}LV_{\Delta} = L_n \sum_{|L|=N}C^{\Delta,L}_{\Delta_1,\Delta_2} LV_{\Delta}\ .
 \label{opew}
\end{align}
\end{itemize}
This leads to a system of linear equations for the OPE coefficients $C^{\Delta,L}_{\Delta_1,\Delta_2}$, called \textbf{OPE Ward identities}. For $\Delta\notin \left\{\Delta_{(r,s)}\right\}_{r,s\in\mathbb{N}^*}$, this system has a unique solution $\left(f^{\Delta,L}_{\Delta_1,\Delta_2}\right)_{L\in\mathcal{L}}=\left(f^L\right)_{L\in\mathcal{L}}$, assuming that the coefficient of the primary field is normalized as
$f^{1}=1$. Let us illustrate this claim by deriving the first few coefficients $f^{L_{-1}},f^{L_{-1}^2},f^{L_{-2}}$. In the case $N=n=1$, Eq. \eqref{opew} reduces to
\begin{align}
 (\Delta+\Delta_1-\Delta_2)V_\Delta = f^{L_{-1}} L_1L_{-1}V_\Delta=2\Delta f^{L_{-1}}V_\Delta\ .
 \label{dddv}
\end{align}
This determines $f^{L_{-1}}$, except if $\Delta=0$, i.e. if there is a null vector at level one in the Verma module $\mathcal{V}_\Delta$. In the resulting expression, the null vector manifests itself as a simple pole at $\Delta=0$:
\begin{align}
 f^{L_{-1}} = \frac{\Delta+\Delta_1-\Delta_2}{2\Delta}\ . 
 \label{fl1}
\end{align}
Similarly, the level two coefficients $f^{L_{-1}^2},f^{L_{-2}}$ are determined by the case $N=2$ with $n=1,2$. For $W = \left(f^{L_{-1}^2}L_{-1}^2 + f^{L_{-2}}L_{-2}\right) V_\Delta$, these equations read 
\begin{align}
 (\Delta+1+\Delta_1-\Delta_2)f^{L_{-1}}L_{-1}V_\Delta  &= L_1W\ ,
 \label{el1c}
 \\
 (\Delta+2\Delta_1-\Delta_2)V_\Delta  &=L_2W \ .
 \label{el2c}
\end{align}
This is a system of linear equations for $f^{L_{-1}^2},f^{L_{-2}}$, whose homogeneous part is the condition that $W$ be a null vector \eqref{l1c}, \eqref{l2c}. Thererfore, the determinant vanishes if and only if $\Delta\in \left\{\Delta_{(2,1)},\Delta_{(1,2)}\right\}$. Otherwise, the solution is unique. 

To summarize, the contributions of $V_\Delta$ and its descendants in an OPE of two primary fields read
\begin{align}
 \boxed{V_{\Delta_1}(z_1)V_{\Delta_2}(z_2) \supset  C_{\Delta_1,\Delta_2}^{\Delta} z_{12}^{\Delta-\Delta_1-\Delta_2} \Bigg(V_\Delta(z_2) +\sum_{L\in \mathcal{L}-\{1\}}z_{12}^{|L|} f^{\Delta,L}_{\Delta_1,\Delta_2} LV_\Delta(z_2)\Bigg)}
 \ ,
 \label{prope}
\end{align}
where the \textbf{OPE structure constant} $C^\Delta_{\Delta_1,\Delta_2}$ is left undetermined by conformal symmetry, while the dependence on $z_1,z_2$ and the coefficients $f^{\Delta,L}_{\Delta_1,\Delta_2}$ are universal quantities that are in principle known. The coefficient $f^{\Delta,L}_{\Delta_1,\Delta_2}$ depends on the conformal dimensions and also on the central charge, and has simple poles at $\Delta=\Delta_{(r,s)}$ with $r,s\in\mathbb{N}^*$ such that $rs\leq |L|$. 

In the case of the OPE coefficients $C^{\Delta,L}_{\Delta_1,\Delta_2}(z_1,z_2)$, we have seen that the primary field determines the contributions of its descendant fields. This will also be true in correlation functions, as a result of Virasoro symmetry. However, this would not necessarily hold if we had a larger chiral symmetry algebra such as a W-algebra. 

The form of the dependence on $z_1,z_2$ provides an a posteriori justification for our assumption in Section \ref{sec:hwr} that $L_0$-eigenvalues be bounded from below. We have indeed seen that an $L_0$-eigenvector $LV_\Delta$ of dimension $\Delta+|L|$ comes with a factor $z_{12}^{\Delta+|L|}$. If $L_0$-eigenvalues were not bounded from below, the sum over states could not converge in a neighbourhood of $z_1=z_2$. 


\subsubsection{Fusion rules and fusion products}\label{sec:dope}

Because of the poles in OPE coefficients, there are constraints on the fields that can appear in OPEs. Let us focus on the pole at $\Delta_{(1,1)}=0$. There are two types of primary fields of dimension $0$: the non-degenerate field $V_0$, which generates the Verma module $\mathcal{V}_0$, and the degenerate field $V^d_{\langle 1,1\rangle}$, which obeys the null vector equation $L_{-1}V^d_{\langle 1,1\rangle}=\partial V^d_{\langle 1,1\rangle}=0$ and generates the degenerate representation $\mathcal{R}^d_{\langle 1,1\rangle}$. Can $V_0$ appear in the OPE $V_{\Delta_1}V_{\Delta_2}$? The pole of $f^{L_{-1}}$ \eqref{fl1} means that our normalization condition $f^1=1$ was wrong: we in fact have $f^1=0$ while $f^{L_{-1}}\neq 0$. Therefore, the non-vanishing null vector $L_{-1}V_0$ may appear in the OPE, together with its descendants, while $V_0$ itself and its other descendants give vanishing contributions. In the case of $V^d_{\langle 1,1\rangle}$ however, the null vector vanishes, and no descendant of $V^d_{\langle 1,1\rangle}$ may appear --- unless the left-hand side of the OPE Ward identity \eqref{dddv} vanishes, which happens if $\Delta_1=\Delta_2$. 

On the other hand, the OPE $V_0V_{\Delta_2}$ is just a special case of the OPE \eqref{prope}.
But the OPE $V^d_{\langle 1,1\rangle}V_{\Delta_2}$ must obey 
\begin{align}
 0 = \frac{\partial}{\partial z_1} V^d_{\langle 1,1\rangle}(z_1)V_{\Delta_2}(z_2) \supset C_{\langle 1,1\rangle,\Delta_2}^{\Delta} \frac{\partial}{\partial z_1} z_{12}^{\Delta-\Delta_2} \left(V_\Delta(z_2) +\cdots \right) \ ,
\end{align}
therefore $V_\Delta$ may appear only provided $\Delta=\Delta_2$. This agrees with the remark (in Section \ref{sec:ope}) that $V^d_{\langle 1,1\rangle}$ is proportional to the identity field. 

Let us introduce the \textbf{fusion rules} as a convenient notation for writing constraints on OPEs, by omitting everything but the primary fields:
\begin{align}
 V^d_{\langle 1,1\rangle} V_{\Delta} = V_\Delta \quad , \quad V_{\Delta_1} V_{\Delta_2} \ni V^d_{\langle 1,1\rangle} \implies \Delta_1=\Delta_2\ . 
\end{align}
This may be reformulated in terms of 
the \textbf{fusion product} of representations of the Virasoro algebra:
\begin{align}
 \mathcal{R}^d_{\langle 1,1\rangle} \times \mathcal{V}_\Delta = \mathcal{V}_\Delta \quad , \quad \dim\text{Hom}\left(\mathcal{V}_{\Delta_1}\times \mathcal{V}_{\Delta_2}, \mathcal{R}^d_{\langle 1,1\rangle}\right) = \delta_{\Delta_1,\Delta_2}\ ,
 \label{rtv}
\end{align}
where $\text{Hom}(\mathcal{R},\mathcal{R}')$ is the space of linear maps from $\mathcal{R}$ to $\mathcal{R}'$ that commute with the action of the Virasoro algebra. 
The fusion product can be algebraically defined \cite{gab99}. It differs from the tensor product, in particular its definition involves the fields' positions, although the resulting product does not. Just like OPEs, the fusion product is commutative and associative. Moreover, as we just saw in the case of Verma modules, we have an isomorphism
\begin{align}
 \text{Hom}\left(\mathcal{R},\mathcal{R}'\right) \simeq \text{Hom}\left(\mathcal{R}\times\mathcal{R}',\mathcal{R}^d_{\langle 1,1\rangle}\right)\ . 
 \label{hrr}
\end{align}

\subsubsection{Fusion products of degenerate representations}

Thanks to the isomorphism \eqref{hrr}, we can find the fusion rules of $V^d_{\langle 2,1\rangle}$ by studying whether it may appear in an OPE $V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)$. This amounts to finding whether the two-dimensional linear system \eqref{el1c}, \eqref{el2c} has a solution, even though it is of rank one. With the help of Eq. \eqref{l1c}, \eqref{l2c}, this condition boils down to 
\begin{align}
 \left(4\Delta_{\langle 2,1\rangle}+2\right) \left(\Delta_{\langle 2,1\rangle}+¨2\Delta_1-\Delta_2\right) = 3\left(\Delta_{\langle 2,1\rangle}+\Delta_1-\Delta_2\right)\left(\Delta_{\langle 2,1\rangle}+1+\Delta_1-\Delta_2\right)\ .
\end{align}
Using the expression \eqref{ars} for $\Delta_{\langle 2,1\rangle}$, and replacing conformal dimensions with momentums \eqref{dp}, this equation reduces to 
\begin{align}
 \prod_{\pm,\pm}\left(\tfrac{\beta}{2}\pm P_1\pm P_2\right) = 0\ . 
\end{align}
This leads to the fusion rules of $V^d_{\langle 2,1\rangle}$, from which the fusion rules of $V^d_{\langle 1,2\rangle}$ are deduced by $\beta\to \beta^{-1}$. We write these fusion rules in terms of fusion products, where we index Verma modules by their momentums:
\begin{align}
 \boxed{\mathcal{R}^d_{\langle 2,1\rangle}\times \mathcal{V}_P = \sum_\pm \mathcal{V}_{P\pm \frac{\beta}{2}}} \quad, \quad \boxed{\mathcal{R}^d_{\langle 1,2\rangle}\times \mathcal{V}_P = \sum_\pm \mathcal{V}_{P\pm \frac{1}{2\beta}}}\ . 
 \label{rvvp}
\end{align}
From these simple formulas, all the discrete spectrums of Section \ref{sec:sesc} will follow. For the moment, let us deduce the fusion products of higher degenerate representations $\mathcal{R}^d_{\langle r,s\rangle}$, using the associativity of the fusion product. We start with the remark that a highest-weight representation $\mathcal{R}$ is degenerate if and only if its fusion product with any Verma module $\mathcal{R}\times \mathcal{V}_P$ has finitely many terms:
\begin{itemize}
 \item If $\mathcal{R}=\mathcal{R}^d_{\langle r,s\rangle}$ is degenerate, the condition that $V^d_{\langle r,s\rangle}$ may appear in the OPE $V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)$ leads to polynomial equations of order $rs$ on $\Delta_1,\Delta_2$, just as we saw in the case $(r,s)=(2,1)$. These equations may be interpreted as conditions on residues of OPE coefficients,
 \begin{align}
  V_{\Delta_1}(z_1)V_{\Delta_2}(z_2) \supset V^d_{\langle r,s\rangle} \quad \implies \quad \forall L\in \mathcal{L},\ \underset{\Delta=\Delta_{(r,s)}}{\operatorname{Res}} f^{\Delta,L}_{\Delta_1,\Delta_2} = 0\ .
  \label{resf}
 \end{align}
 (If the residues vanish for $|L|=rs$, then they vanish for all $L\in\mathcal{L}$.)
 \item If $\mathcal{R}$ is not degenerate, the corresponding primary field may appear in any OPE of the type $V_{\Delta_1}(z_1)V_{\Delta_2}(z_2)$, because the OPE Ward identities have a solution. 
\end{itemize}
It follows that a fusion product of degenerate representations is itself a sum of degenerate representations. 
For example, according to Eq. \eqref{rvvp}, the product $\mathcal{R}^d_{\langle 2,1\rangle}\times\mathcal{R}^d_{\langle 2,1\rangle}$ is the sum of two representations of momentums $\{P_{(2,1)} \pm \frac{\beta}{2}\} = \{P_{(1,1)},P_{(3,1)}\}$. These representations must be degenerate, therefore $\mathcal{R}^d_{\langle 2,1\rangle}\times\mathcal{R}^d_{\langle 2,1\rangle}=\mathcal{R}^d_{\langle 1,1\rangle}+\mathcal{R}^d_{\langle 3,1\rangle}$. By associativity of $\mathcal{R}^d_{\langle 2,1\rangle}\times\mathcal{R}^d_{\langle 2,1\rangle}\times \mathcal{V}_P$, we then deduce 
$
 \mathcal{R}^d_{\langle 3,1\rangle} \times \mathcal{V}_P = \mathcal{V}_{P-\beta}+\mathcal{V}_P+\mathcal{V}_{P+\beta}
$. Iterating this reasoning over $r$ or $s$, we obtain 
\begin{align}
 \mathcal{R}^d_{\langle 2,1\rangle}\times \mathcal{R}^d_{\langle r,s\rangle} 
 \underset{r\geq 2}{=} \sum_\pm \mathcal{R}^d_{\langle r\pm 1,s\rangle} 
 \quad , \quad 
 \mathcal{R}^d_{\langle 1,2\rangle}\times \mathcal{R}^d_{\langle r,s\rangle} 
 \underset{s\geq 2}{=}\sum_\pm \mathcal{R}^d_{\langle r,s\pm 1\rangle} \ .
 \label{rrrs}
\end{align}
This allows us to find the fusion product of any degenerate representation with a Verma module, by iteration over $r$ and $s$:
\begin{align}
 \boxed{\mathcal{R}^d_{\langle r,s\rangle}\times \mathcal{V}_P = \sum_{i=-\frac{r-1}{2}}^{\frac{r-1}{2}} \sum_{j=-\frac{s-1}{2}}^{\frac{s-1}{2}} \mathcal{V}_{P+i\beta +j\beta^{-1}}}\ ,
 \label{rrsvp}
\end{align}
where the sums run by increments of $1$. Since this sum has $rs$ terms, the Verma module $\mathcal{V}_{\Delta_{(r,s)}}$ must have a null vector at level $rs$, a result that we admitted in Section \ref{sec:nvvm}, and which we now derived using fusion products. Fusion can even be used to compute the null vectors themselves \cite{fms97}. 

We can then find the fusion product $\mathcal{R}^d_{\langle r_1,s_1\rangle}\times \mathcal{R}^d_{\langle r_2,s_2\rangle}$, either by again iterating over $r_1$ and $s_1$, or by summing the degenerate representations whose momentums appear in both  $\mathcal{R}^d_{\langle r_1,s_1\rangle}\times \mathcal{V}_{P_{(r_2,s_2)}}$ and $\mathcal{R}^d_{\langle r_2,s_2\rangle}\times \mathcal{V}_{P_{(r_1,s_1)}}$:
\begin{align}
  \boxed{\mathcal{R}^d_{\langle r_1,s_1 \rangle} \times \mathcal{R}^d_{\langle r_2,s_2 \rangle} = \sum_{r\overset{2}{=}|r_1-r_2|+1}^{r_1+r_2-1}\ \sum_{s\overset{2}{=}|s_1-s_2|+1}^{s_1+s_2-1} \mathcal{R}^d_{\langle r,s \rangle}}\ ,
  \label{rrsr}
\end{align}
where the sums now run by increments of $2$. 


\subsection{Correlation functions}\label{sec:cor}

Correlation functions are observables of quantum field theory: quantities that we can in principle compute, and compare with experimental data. We will focus on $N$-point functions on the Riemann sphere: functions of $N$ distinct positions $z_1,z_2,\dots, z_N\in \overline{\mathbb{C}}$, which are written in terms of $N$ fields as 
\begin{align}
 \Big< V_1(z_1) V_2(z_2) \cdots V_N(z_N)\Big>\ . 
\end{align}
Correlation functions are assumed to depend linearly on fields: in particular, this implies $\partial_{z_1}\left<  V_1(z_1) \cdots \right> = \left< \partial_{z_1} V_1(z_1) \cdots \right>$.
All the assumptions and results of Section \ref{sec:fope} may be understood as constraints on correlation functions. 
In two-dimensional CFT, there are other observables that we will not consider, such as: 
\begin{itemize}
 \item Correlation functions on higher-genus Riemann surfaces, starting with the torus. 
 \item Correlation functions on Riemann surfaces with boundaries, starting with the disc. 
 \item Correlation functions in the presence of defect lines. 
 \item Entanglement entropy. 
\end{itemize}

\subsubsection{Conformal symmetry constraints}\label{sec:csc}

In order to derive the conformal symmetry constraints for an $N$-point function of primary fields $Z$, it is convenient to consider the $N+1$-point function $Z(y)$ that also includes the energy-momentum tensor $T(y)$:
\begin{align}
 Z = \left< \prod_{i=1}^N V_{\Delta_i}(z_i)\right> \quad , \quad Z(y) = \left< T(y)\prod_{i=1}^N V_{\Delta_i}(z_i)\right>\ .
\end{align}
The function $Z(y)$ is meromorphic, with $N$ poles at $y=z_i$, where its behaviour is constrained by the OPE $T(y)V_{\Delta_i}(z_i)$ \eqref{tvd}. To fully determine $Z(y)$, it remains to determine its behaviour at $y=\infty$. Because our fields live on the Riemann sphere, they must be smooth at $y=\infty$: in the case of $T(y)$, we assume that this means 
\begin{align}
 T(y) \underset{y\to\infty} = O\left(\frac{1}{y^4}\right)\ .
 \label{tinf}
\end{align}
This implies first of all that $\lim_{y\to \infty} Z(y)=0$, therefore $Z(y)$ is completely determined by its residues at $y=z_i$:
\begin{align}
 Z(y) = \sum_{i=1}^N \left(\frac{\Delta_i}{(y-z_i)^2} +\frac{1}{y-z_i}\frac{\partial}{\partial z_i}\right) Z\ .
 \label{zy}
\end{align}
Furthermore, Eq. \eqref{tinf} implies the vanishing of the coefficients of $y^{-1},y^{-2},y^{-3}$ in the Laurent expansion of $Z(y)$ near $y=\infty$, leading to the three \textbf{global Ward identitites} 
\begin{align}
 \sum_{i=1}^N \partial_{z_i} Z = \sum_{i=1}^N \left(z_i \partial_{z_i} + \Delta_i\right) Z = \sum_{i=1}^N \left(z_i^2 \partial_{z_i} + 2\Delta_iz_i\right) Z = 0\ .
 \label{gward}
\end{align}
Equivalently, the behaviour of $Z$ under global conformal transformations \eqref{abcd} must be
\begin{align}
 \left< \prod_{i=1}^N  V_{\Delta_i}\left(\frac{az_i+b}{cz_i+d}\right) \right>
 = \prod_{i=1}^N (cz_i +d)^{2\Delta_i} \left< \prod_{i=1}^N V_{\Delta_i}(z_i) \right>\ .
 \label{zgc}
\end{align}
In particular, considering the transformation $z\mapsto \frac{1}{z}$ leads to $V_\Delta(z)\underset{z\to\infty}{=} O(z^{-2\Delta})$, which allows us to define 
\begin{align}
 V_\Delta(\infty) = \lim_{z\to\infty} z^{2\Delta}V_\Delta(z)\ . 
 \label{vdi}
\end{align}
The global Ward identities are valid not only for primary fields, but also for \textbf{global primary fields} (also called quasi-primary fields): $L_0$-eigenvectors that are annihilated by $L_1$ but not necessarily by $L_{n\geq 2}$. According to the OPE $T(y)T(z)$ \eqref{tt}, the energy-momentum tensor is a global primary field of dimension $\Delta=2$, and the resulting behaviour at infinity \eqref{vdi} is consistent with our assumption \eqref{tinf}. 

Let us solve the global Ward identities in the cases $N=1,2,3,4$. We have $3$ linear differential equations in the $N$ variables $z_i$, and we write their solutions up to $z_i$-independent prefactors:
\begin{itemize}
 \item $\boxed{N=1}$\ : The identities amount to $\partial_{z_1} Z = \Delta_1 Z=0$, and their solution is 
 \begin{align}
  \left<V_{\Delta_1}(z_1)\right>\propto \delta_{\Delta_1,0}\ . 
 \end{align}
 \item $\boxed{N=2}$\ : Again, there are more Ward identities than variables, leading to $Z\neq 0\implies \Delta_1=\Delta_2$, and to the solution
 \begin{align}
 \Big< V_{\Delta_1}(z_1)V_{\Delta_2}(z_2) \Big> \propto \delta_{\Delta_1,\Delta_2} z_{12}^{-2\Delta_1} \ .
 \label{2pt}
\end{align}
\item $\boxed{N=3}$\ : With as many Ward identities as variables, we have a unique solution with no constraints on the conformal dimensions:
\begin{align}
 \left< \prod_{i=1}^3 V_{\Delta_i}(z_i) \right> \propto z_{12}^{\Delta_3-\Delta_1-\Delta_2} z_{13}^{\Delta_2-\Delta_1-\Delta_3} z_{23}^{\Delta_1-\Delta_2-\Delta_3}\ .
 \label{3pt}
\end{align}
\item $\boxed{N=4}$\ : The solution involves an arbitrary function $G(z)$ of the cross-ratio $z=\frac{z_{12}z_{34}}{z_{13}z_{24}}$:
\begin{align}
 \left< \prod_{i=1}^4 V_{\Delta_i}(z_i) \right> 
 \propto z_{13}^{-2\Delta_1} z_{23}^{\Delta_1-\Delta_2-\Delta_3+\Delta_4} z_{24}^{-\Delta_1-\Delta_2+\Delta_3-\Delta_4} z_{34}^{\Delta_1+\Delta_2-\Delta_3-\Delta_4} G\left(\frac{z_{12}z_{34}}{z_{13}z_{24}}\right)\ .
 \label{4pt}
\end{align}
A four-point function is therefore completely determined by its dependence on $1$ of its $4$ variables. In particular, it can be convenient to set $3$ positions to the fixed values $(z_2,z_3,z_4)=(0,\infty,1)$. Using Eq. \eqref{vdi}, this leads to 
\begin{align}
 \Big< V_{\Delta_1}(z) V_{\Delta_2}(0)V_{\Delta_3}(\infty)V_{\Delta_4}(1) \Big> \propto G(z)\ . 
\end{align}
\end{itemize}
In addition to global Ward identities, there are \textbf{local Ward identities}, which follow from $\oint_\infty dy\ \epsilon(y)Z(y)=0$, where $\epsilon(y)$ is a meromorphic function such that $\epsilon(y)\underset{y\to\infty}{=}O(y^2)$, with poles at $y=z_i$. Local Ward identities allow us to determine correlation functions of descendant fields from the corresponding correlation functions of primary fields. In the case $\epsilon(y) = \frac{1}{(y-z_1)^{n-1}}$ with $n\geq -1$, using the expressions \eqref{zy} for $Z(y)$ and \eqref{lvtv} for $L_{-n}V_{\Delta_1}(z_1)$, we obtain the Ward identity
\begin{align}
 \left<L_{-n}V_{\Delta_1}(z_1)\prod_{j=2}^N V_{\Delta_j}(z_j)\right> = \sum_{j=2}^N \left(-\frac{1}{z_{j1}^{n-1}}\frac{\partial}{\partial z_j} +\frac{n-1}{z_{j1}^n} \Delta_j\right) \left<\prod_{j=1}^N V_{\Delta_j}(z_j)\right>\ . 
 \label{lwi}
\end{align}
If $n\geq 2$ this is a local Ward identity, while for $n=-1,0,1$ we recover global Ward identities. 

\subsubsection{Single-valuedness and chiral factorization}

We assume that correlation functions are single-valued functions on the Riemann sphere. However, correlation functions are of the type of $z^\Delta$, which is multivalued unless $\Delta\in\mathbb{Z}$. Single-valued functions like $|z|^{2\Delta}=z^\Delta\bar{z}^\Delta$ are not written in terms of powers of $z$, but also involve $\bar z$. In the literature, the notation $f(z,\bar z)$ is sometimes used for arbitrary functions of $z$, with $f(z)$ reserved to locally holomorphic functions, i.e. functions such that $\frac{\partial}{\partial \bar z} f(z) =0$. We will not use the notation $f(z,\bar z)$, which is redundant since $\bar z$ is itself a function of $z$. 

The generators $\ell_n$ \eqref{lpz} of local conformal transformations are only valid when acting on locally holomorphic functions: for more general functions, the generators are 
\begin{align}
 \ell_n +\bar{\ell}_n \quad , \quad i(\bar\ell_n -\bar \ell_n)\  .
 \label{epbe}
\end{align}
In fact we want the algebra of conformal transformations to act on a complex vector space: the space of complex-valued functions on $\overline{\mathbb{C}}$ for the Witt algebra, the space of states of the CFT for the Virasoro algebra. We should therefore complexify our symmetry algebra, and we obtain two copies of the Virasoro algebra: a \textbf{left-moving or holomorphic} Virasoro algebra $\mathfrak{V}$ with generators $L_n$, and a \textbf{right-moving or antiholomorphic} Virasoro algebra $\bar{\mathfrak{V}}$ with generators $\bar{L}_n$. In the case of the algebra of global conformal transformations, we start with the 6-dimensional real Lie algebra $\mathfrak{sl}_2(\mathbb{C})$, with generators \eqref{epbe} with $n=-1,0,1$, and the complexification yields $\mathfrak{sl}_2(\mathbb{C})^\mathbb{C} = \mathfrak{sl}_2(\mathbb{C})\times \mathfrak{sl}_2(\mathbb{C})$.

In Sections \ref{sec:vir} and \ref{sec:fope}, we have been doing \textbf{chiral CFT}, which means considering $\mathfrak{V}$ only. In a full CFT, the symmetry algebra is the \textbf{conformal algebra} $\mathfrak{V}\times \bar{\mathfrak{V}}$, where for simplicity we assume that the left and right central charges are equal. When it comes to representations, Verma modules of $\mathfrak{V}\times \bar{\mathfrak{V}}$ are simply $\mathcal{V}_\Delta\otimes \bar{\mathcal{V}}_{\bar \Delta}$, where we write a bar over representations of $\bar{\mathfrak{V}}$. There are also representations of $\mathfrak{V}\times \bar{\mathfrak{V}}$ that are not themselves factorized. We will encounter such representations in Section \ref{sec:log}. 

Fields now belong to representations of $\mathfrak{V}\times \bar{\mathfrak{V}}$, and they obey $\frac{\partial}{\partial \bar z} V(z) = \bar L_{-1} V(z)$, which is the antiholomorphic version of Eq. \eqref{pvlv}. This allows us to define a right-moving energy-momentum tensor $\bar T(y) = \sum_{n\in\mathbb{Z}} \frac{\bar L_n^{(z)}}{(\bar y-\bar z)^{n+2}}$. While $T$ is locally holomorphic, $\bar T$ is locally antiholomorphic:
\begin{align}
 \partial_{\bar z} T(z) = 0 \quad , \quad \partial_z \bar T(z) = 0 \ . 
\end{align}
Let $V_{\Delta,\bar\Delta}(z)$ be a field that is primary with respect to the conformal algebra, with the left dimension $\Delta$ and the right dimension $\bar\Delta$. The difference of these dimensions is called the \textbf{conformal spin}
\begin{align}
 S = \Delta -\bar\Delta\ . 
 \label{sdd} 
\end{align}
According to Eq. \eqref{zgc}, 
under a rotation $z\mapsto e^{i\theta}z$, corresponding to a global conformal transformation $\left(\begin{smallmatrix} a & b \\ c & d\end{smallmatrix}\right)= \left(\begin{smallmatrix} e^{\frac{i}{2}\theta} & 0 \\ 0 &  e^{-\frac{i}{2}\theta}\end{smallmatrix}\right)$, a primary field transforms as 
\begin{align}
 V_{\Delta,\bar\Delta}(z) \to  e^{iS\theta} V_{\Delta,\bar\Delta}\left(e^{i\theta} z\right) \ .
 \label{veis}
\end{align}
In order to write correlation functions, let us define the \textbf{modulus squared notation} 
\begin{align}
 \left| f(\Delta, z)\right|^2 = f(\Delta, z)f(\bar\Delta,\bar z)\ ,
 \label{fdz2}
\end{align}
where $z,\bar z$ are complex conjugates, while $\Delta,\bar\Delta$ are generally not. 
For simplicity we write $V_i$ for a primary field of dimensions $\Delta_i,\bar\Delta_i$.
The solution of the left- and right-moving global Ward identities for 2-point functions is the modulus squared of Eq. \eqref{2pt},
\begin{align}
\boxed{ \Big< V_1(z_1)V_2(z_2) \Big> = B_{12} \left|\delta_{\Delta_1,\Delta_2} z_{12}^{-2\Delta_1}\right|^2} \ ,
\label{2ptb}
\end{align}
where the constant, $z_i$-independent coefficient is now called the \textbf{2-point structure constant} $B_{12}$. Similarly, 3-point functions are given by the modulus squared of Eq. \eqref{3pt},
\begin{align}
 \boxed{  \Big< V_1(z_1)V_2(z_2)V_3(z_3) \Big> = C_{123} \left|z_{12}^{\Delta_3-\Delta_1-\Delta_2} z_{13}^{\Delta_2-\Delta_1-\Delta_3} z_{23}^{\Delta_1-\Delta_2-\Delta_3}\right|^2 }\ ,
 \label{3ptc}
\end{align}
where $C_{123}$ is the \textbf{3-point structure constant}. Single-valuedness of the 2-point and 3-point functions implies that spins obey
\begin{align}
 S_i\in\frac12 \mathbb{Z} \quad , \quad S_1+S_2+S_3 \in\mathbb{Z}\ . 
 \label{sihz}
\end{align}
Now we have assumed that fields commute \eqref{comm}, but the $z_i$-dependent factors of the 2-point and 3-point functions are not invariant under permutations. This implies that structure constants behave as
\begin{align}
 B_{21} = (-)^{2S_1} B_{12} \quad ,\quad C_{\sigma(1)\sigma(2)\sigma(3)} = \text{sign}(\sigma)^{S_1+S_2+S_3} C_{123}\ , 
 \label{b21}
\end{align}
where $\sigma$ is a permutation of $\{1,2,3\}$. In particular, for the 2-point function of a field with itself, we have $B_{12}=B_{21}$, which must vanish if the spin is half-integer $S_1\in \frac12+\mathbb{Z}$. Fields with half-integer spins should rather anti-commute with themselves, i.e. they should be fermionic. 
Unless stated otherwise, we will assume that spins are integer:
\begin{align}
 \boxed{S\in \mathbb{Z}}\ .
 \label{siz}
\end{align}

\subsubsection{Crossing symmetry and conformal blocks}\label{sec:cscb}

Let us systematically use OPEs for simplifying correlation functions. Knowing the contribution \eqref{prope} of left-moving descendants of primary fields, the complete OPE of two primary fields reads 
\begin{align}
 V_1(z_1)V_2(z_2) = \sum_{k\in\mathcal{S}} C_{12}^k \left|z_{12}^{\Delta_k-\Delta_1-\Delta_2}\sum_{L\in\mathcal{L}} z_{12}^{|L|}f_{\Delta_1,\Delta_2}^{\Delta_k,L}\right|^2 L\bar L V_k(z_2)\ ,
 \label{tope}
\end{align}
where the basis $\mathcal{L}$ of creation operators was defined in Eq. \eqref{lcm},
we assume that all fields are primaries or descendants thereof, with $\mathcal{S}$ a basis of primaries. Let us insert this OPE in a three-point function, and focus on the leading terms as $z_1\to z_2$. Using the 2-point function \eqref{2ptb}, we obtain
\begin{align}
  \Big< V_1(z_1)V_2(z_2)V_3(z_3) \Big> \underset{z_1\to z_2}{\sim} 
  \left|z_{12}^{\Delta_3-\Delta_1-\Delta_2}z_{23}^{-2\Delta_3}\right|^2 
  \sum_{k\in\mathcal{S}\left|\substack{\Delta_3=\Delta_k\\ \bar{\Delta}_3=\bar\Delta_k}\right. }
  C_{12}^k B_{k3}\ .
\end{align}
Comparing with the 3-point function \eqref{3ptc}, this implies a relation between the 2-point, 3-point and OPE structure constants. Assuming for simplicity $B_{ij}=\delta_{ij}B_i$, the relation is 
\begin{align}
 \boxed{C_{123} = C_{12}^3B_{3}} \ .
 \label{ccb}
\end{align}
If we now insert the OPE in the four-point function $\left<V_1(z)V_2(0)V_3(\infty)V_4(1)\right>$, we obtain a linear combination of 3-point functions of the type $\left<L\bar{L}V_k(0) V_3(\infty)V_4(1)\right>$ with $L,\bar L\in\mathcal{L}$. Deducing 3-point functions of descendants from 3-point functions of primaries using local Ward identities, we can in principle compute the ratios
\begin{align}
 g^L_{\Delta_1,\Delta_2,\Delta_3} = \frac{\left< LV_{\Delta_1}(0) V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right>}{\left< V_{\Delta_1}(0) V_{\Delta_2}(\infty)V_{\Delta_3}(1)\right>}\ .
\end{align}
This allows us to write our 4-point function as 
\begin{align}
 \boxed{\Big<V_1(z)V_2(0)V_3(\infty)V_4(1)\Big> = \sum_{k\in\mathcal{S}} C_{12}^k C_{k34} \left|\mathcal{F}^{(s)}_{\Delta_k}\left(c\middle|\Delta_1,\Delta_2,\Delta_3,\Delta_4\middle|z\right)\right|^2}  \ ,
 \label{sdec}
\end{align}
where we introduce the \textbf{$s$-channel Virasoro blocks}, which are known (in principle) functions of $z$ as well as the central charge and conformal dimensions:
\begin{align}
 \mathcal{F}_{\Delta}^{(s)}\left(c\middle|\Delta_1,\Delta_2,\Delta_3,\Delta_4\middle|z\right) = z^{\Delta-\Delta_1-\Delta_2}\sum_{L\in\mathcal{L}} z^{|L|} f_{\Delta_1,\Delta_2}^{\Delta,L}g^L_{\Delta,\Delta_3,\Delta_4}\ ,
 \label{fsl}
\end{align}
The $s$-channel decomposition \eqref{sdec} reduces the 4-point function to a combination of model-dependent structure constants, and universal Virasoro blocks. Repeatedly using OPEs, any $N$-point function can likewise be decomposed into $N$-point Virasoro blocks. However, these decompositions are not unique. In the case $N=4$, there are 3 possible decompositions, called the \textbf{$s$-channel}, \textbf{$t$-channel} and \textbf{$u$-channel} decompositions, depending on which OPE we perform. For each channel, let us write the relevant OPE, the \textbf{4-point structure constants} that appear as coefficients, the asymptotics of the Virasoro blocks, and a diagram that represents the decomposition:
\begin{align}
 \begin{array}{|r||c|c|c|}
  \hline 
  \text{Channel} & s & t & u
  \\ \hline
  \text{OPE} & V_1(z)V_2(0) & V_1(z)V_4(1) & V_1(z)V_3(\infty)
  \\ \hline 
  \text{4-point} & D^{(s)}_k = C_{12}^k C_{k34} & D^{(t)}_k = C_{41}^k C_{k23} & D^{(u)}_k = C_{13}^k C_{k42}
\\ \hline 
  \text{Asymptotics} & \mathcal{F}^{(s)}_{\Delta}\underset{z\to 0}{\sim} z^{\Delta-\Delta_1-\Delta_2} & \mathcal{F}^{(t)}_{\Delta}\underset{z\to 1}{\sim} (1-z)^{\Delta-\Delta_1-\Delta_4}
  & \mathcal{F}^{(u)}_\Delta  \underset{z\to \infty}{\sim} \left(\tfrac{1}{z}\right)^{\Delta+\Delta_1-\Delta_3}
  \\
  \hline 
\text{Diagram} & 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
\draw (-1,2) node [left] {$2$} -- (0,0) -- node [above] {$k$} (4,0) -- (5,2) node [right] {$3$};
\draw (-1,-2) node [left] {$1$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$4$};
\end{tikzpicture}
& 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
 \draw (-2,3) node [left] {$2$} -- (0,2) -- node [left] {$k$} (0,-2) -- (-2, -3) node [left] {$1$};
\draw (0,2) -- (2,3) node [right] {$3$};
\draw (0,-2) -- (2, -3) node [right] {$4$};
\end{tikzpicture}
& 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .3]
\draw (-2,1) node [left] {$2$} -- (0,0) -- node [left] {$k$} (0,-4) ;
\draw (0,0)-- (2,-5) node [right] {$4$};
\draw (-2,-5) node [left] {$1$} -- (0,-4);
\draw (0,-4) -- (2,1) node [right] {$3$};
\end{tikzpicture} 
  \\
  \hline 
 \end{array}
 \label{stu}
\end{align}
In order to write these decompositions in greater generality, let us define the $x$-channel \textbf{conformal blocks} as 
\begin{align}
 \mathcal{G}^{(x)}_{\Delta_k} = \left|\mathcal{F}_{\Delta_k}^{(x)}\right|^2\ , \qquad (x=s,t,u)\ . 
 \label{gf2}
\end{align}
Our conformal blocks are chirally factorized into Virasoro blocks because of our assumption that all fields are primaries or descendants. However, representations of the conformal algebra that are not factorized give rise to blocks that are also not factorized: this is the case with the logarithmic representations of Section \ref{sec:log}. We now write the \textbf{crossing symmetry equations} as the equality between the 3 decompositions of a four-point function into structure constants and conformal blocks:
\begin{align}
 \boxed{\sum_{k\in\mathcal{S}} D_k^{(s)} \mathcal{G}^{(s)}_{\Delta_k} = \sum_{k\in\mathcal{S}} D_k^{(t)} \mathcal{G}^{(t)}_{\Delta_k} = \sum_{k\in\mathcal{S}} D_k^{(u)} \mathcal{G}^{(u)}_{\Delta_k}} \ . 
 \label{seteu}
\end{align}
Given 4 fields $V_1,V_2,V_3,V_4$, this is a system of infinitely many equations (parametrized by the cross-ratio $z$) for the spectrum $\mathcal{S}$ and the 4-point structure constants $D_k^{(x)}$. Alternatively, we can take the unknowns to be the \textbf{CFT data}: the spectrum and the 2-point and 3-point structure constants. CFT data determine OPEs, and crossing symmetry of all 4-point functions is equivalent to the associativity of OPEs, and therefore to the consistency of the CFT on the sphere. 


\section{Sketching exactly solvable CFTs}\label{sec:sesc}

In this section we derive the spectrums and fusion rules of exactly solvable CFTs. We begin with a general discussion of CFTs, their spectrums, and the consequences of having degenerate fields. Historically, the CFTs we will discuss have been discovered using a variety of techniques: 
\begin{itemize}
 \item the modular bootstrap for minimal models \cite{fms97},
 \item the Lagrangian approach for Liouville theory with $c\geq 25$ \cite{zz95},
 \item lattice constructions for the $O(n)$ and Potts models \cite{fsz87},
 \item the numerical bootstrap for Liouville theory with $c\leq 1$ \cite{rs15}.
\end{itemize}
Here we recover their spectrums from assumptions about Virasoro representations and their fusion rules. Although our assumptions are simple, they are not unique or inevitable, and it can be interesting to relax or modify them. These assumptions could also be useful for exploring CFTs with extended symmetry algebras. 

\subsection{Spectrum and degenerate fields}

\subsubsection{What is a CFT? What is a spectrum?}

We define a \textbf{conformal field theory} as a set of correlation functions that obey the assumptions of Section \ref{sec:bo}, most importantly Virasoro symmetry, the commutativity of fields, the existence of OPEs, and single-valuedness. We already know that on the sphere, a conformal field theory is characterized by a spectrum and 2-point and 3-point structure constants such that crossing symmetry is obeyed.

This definition works very well in \textbf{rational CFTs}, i.e. CFTs whose spectrums are made of finitely many primary fields and their descendants. However, in more general CFTs, the notion of the spectrum becomes fuzzy. To say why, let us introduce various spectrums associated to various objects. By an abuse of terminology, we call spectrum a basis of primary fields: 
\begin{align}
 \begin{array}{|c|c|l|}
  \hline 
  \text{Object} & \text{Spectrum}  & \text{Definition or constraint}
  \\
  \hline \hline 
  V_1V_2 & \text{OPE spectrum } \mathcal{S}_{12} & V_1V_2 \sim \sum_{k\in \mathcal{S}_{12}} V_k 
  \\
  \hline 
  \left<V_1V_2V_3V_4\right> & \text{Channel spectrum } \mathcal{S}^{(s)} &  \mathcal{S}^{(s)}= \mathcal{S}_{12}\cap \mathcal{S}_{34}
  \\
  \hline 
  \text{CFT} & \text{Physical spectrum } \mathcal{S} &  i,j\in\mathcal{S}\implies \mathcal{S}_{i,j}\subset \mathcal{S}  
  \\
  \hline 
  \widetilde{\text{CFT}} & \text{Extended spectrum } \widetilde{\mathcal{S}} & \mathcal{S}\subset \widetilde{\mathcal{S}}\ , \quad i,j\in\widetilde{\mathcal{S}}\implies \mathcal{S}_{i,j}\subset \widetilde{\mathcal{S}}
  \\
  \hline 
 \end{array}
 \label{specs}
\end{align}
The \textbf{physical spectrum} is made of the fields whose correlation functions we are interested in. Our constraint on the physical spectrum is called \textbf{closure under OPEs}. This constraint means that if a field appears in an OPE (or a fortiori in a channel spectrum), then its correlation functions exist. 
We also introduce \textbf{extended spectrums} as larger spectrums that are also closed under OPEs. There are various reasons for considering extended spectrums:
\begin{itemize}
 \item In Section \ref{sec:csc}, we have used the energy-momentum tensor $T$ for deriving Ward identities. However, in Liouville theory, $T$ does not belong to the physical spectrum. Nevertheless, it always makes sense to insert $T$ in correlation functions, because it is a descendant of the identity field. 
 \item In the $O(n)$ model and in Liouville theory, we will use the degenerate field $V^d_{\langle 1,2\rangle}$ for constraining correlation functions, even though it does not belong to the physical spectrum. Correlation functions of the $O(n)$ model that involve $V^d_{\langle 1,2\rangle}$ are not single-valued: they belong to an extended CFT that obeys weaker assumptions. 
 \item The spectrum of Liouville theory is continuous, so that the OPE gives rise to an integral over the real momentums of primary fields. Since the integrand is meromorphic, the integration contour can be deformed in the complex plane. This leads to an extended spectrum of complex momentums. 
\end{itemize}
We will say that \textbf{a field exists} if it belongs to some extended spectrum, i.e. if it can be consistently added to our CFT. 

\subsubsection{Diagonal and non-diagonal fields}

Motivated by the single-valuedness of correlation functions, we have made the assumption \eqref{siz} that conformal spins are integer. In extended spectrums, we may relax this assumption to the half-integer spin condition \eqref{sihz}:
\begin{align}
 i\in\mathcal{S}\implies S_i\in\mathbb{Z} \quad , \quad i \in \widetilde{\mathcal{S}}\implies S_i\in\frac12\mathbb{Z}\ . 
\end{align}
A simple way to satisfy these assumptions is to have fields of spin zero, i.e. \textbf{spinless fields}. However, whenever degenerate fields exist, we will use the slightly different notion of a \textbf{diagonal field}: a spinless field whose OPEs with degenerate fields only produces spinless fields. Conversely, a \textbf{non-diagonal field} is a field that either has nonzero spin, or is related to fields with nonzero spins by taking OPEs with degenerate fields. A \textbf{diagonal CFT} is a CFT whose spectrum only involves diagonal fields.  

Let us summarize the primary fields that we will consider, together with their conformal dimensions, and the representations of the conformal algebra that they generate. 
\begin{align}
 \begin{array}{|r|l|l|l|l|}
  \hline 
  \text{Name} & \text{Notation} & \text{Conditions} & (\Delta,\bar \Delta) & \text{Representation}
  \\
  \hline \hline 
  \text{Degenerate} &  V^d_{\langle r,s\rangle} &  r,s\in\mathbb{N}^* & \left(\Delta_{(r,s)},\Delta_{(r,s)}\right)  & \mathcal{R}^d_{\langle r,s\rangle}\otimes \bar{\mathcal{R}}^d_{\langle r,s\rangle} 
  \\
  \hline 
  \text{Fully degenerate} & V^f_{\langle r,s\rangle} & \begin{array}{l} r,s\in\mathbb{N}^* \\ \beta^2\in\mathbb{Q} \end{array} & \left(\Delta_{(r,s)},\Delta_{(r,s)}\right)  & \mathcal{R}^f_{\langle r,s\rangle}\otimes \bar{\mathcal{R}}^f_{\langle r,s\rangle} 
  \\
  \hline 
  \text{Diagonal} & V_P & P\in\mathbb{C} & \left(\tfrac{c-1}{24}+P^2,\tfrac{c-1}{24}+P^2\right) & \mathcal{V}_P\otimes \bar{\mathcal{V}}_P 
  \\
  \hline 
  \text{Non-diagonal} & V_{(r,s)} & 
  \begin{array}{l} r,s\in\mathbb{C} \\ 
  rs\in \tfrac12\mathbb{Z} \end{array} & \left(\Delta_{(r,s)},\Delta_{(r,-s)}\right) & 
  \begin{array}{l} \mathcal{V}_{P_{(r,s)}} \otimes \bar{\mathcal{V}}_{P_{(r,-s)}} \\ \text{(in general)} \end{array}
  \\
  \hline 
 \end{array}
 \label{fields}
\end{align}
We parametrize non-diagonal primary fiels $V_{(r,s)}$ using the Kac indices defined by Eq. \eqref{prs}, instead of the left and right dimensions. 
According to Eq. \eqref{drms}, the conformal spin of $V_{(r,s)}$ is 
\begin{align}
 \boxed{S_{(r,s)}= -rs} \ . 
 \label{srs}
\end{align}
Then $V_{(r,s)}$ generates the Verma module $\mathcal{V}_{P_{(r,s)}} \otimes \bar{\mathcal{V}}_{P_{(r,-s)}}$, unless that module has null vectors, which occurs if $r,s\in\mathbb{Z}^*$, and also for other values of $r,s$ if $\beta^2\in\mathbb{Q}$. If there are null vectors, $V_{(r,s)}$ may generate a degenerate representation, or belong to a logarithmic representation. 

Our labelling of fields is redundant, because the reflection $P\to -P$ leaved the conformal dimension \eqref{dp} invariant. We therefore assume the \textbf{reflection relations}
\begin{align}
 V_{P} = V_{-P} \quad , \quad V_{(r,s)} = V_{(-r,-s)} \ . 
 \label{refl}
\end{align}
In some cases we will allow a nontrivial \textbf{reflection coefficient} $R_P$ such that $V_P=R_P V_{-P}$. 


\subsubsection{How many degenerate fields?}\label{sec:hmdf}

We assume that the OPE of two diagonal degenerate fields yields all the diagonal degenerate fields that are allowed by the fusion rules \eqref{rrsr}. 
If for example we repeatedly fuse $V^d_{\langle 5,2\rangle}$ with itself, we obtain all $V^d_{\langle r,s\rangle}$ with $(r,s)\in (2\mathbb{N}+1)\times \mathbb{N}^*$. For each one of the two Kac indices $r,s$, allowing one even value implies allowing all values in $\mathbb{N}^*$, and allowing one odd value except $1$ implies allowing all odd values. Modulo $r\leftrightarrow s$, this leads to 7 possible sets of degenerate fields, which we characterize by whether or not they contain $V^d_{\langle 1,1\rangle}, V^d_{\langle 2,1\rangle},V^d_{\langle 3,1\rangle},V^d_{\langle 1,2\rangle}$ and $V^d_{\langle 1,3\rangle}$:
\begin{align}
 %\begin{array}{c}
  \emptyset \quad \left\{V^d_{\langle 1,1\rangle}\right\}  \quad \left\{V^d_{\langle 1,3\rangle}\right\} \quad \left\{V^d_{\langle 1,2\rangle}\right\} 
  % \\
  \quad 
  \left\{V^d_{\langle 3,1\rangle},V^d_{\langle 1,3\rangle}\right\} \quad 
  \left\{V^d_{\langle 3,1\rangle},V^d_{\langle 1,2\rangle}\right\} \quad 
  \left\{V^d_{\langle 2,1\rangle},V^d_{\langle 1,2\rangle}\right\} 
 %\end{array}
 \label{degsets}
\end{align}
In particular, the set that is generated by $\{V^d_{\langle 2,1\rangle},V^d_{\langle 1,2\rangle}\} $ is the full set of degenerate fields $\{V^d_{\langle r,s\rangle}\}_{r,s\in\mathbb{N}^*}$. 
In order to solve CFTs, the existence of degenerate fields matters much more than their presence in the spectrum. We will focus on two types of CFTs:
\begin{itemize}
 \item \textbf{CFTs with 2 degenerate fields}, in the sense that both $V^d_{\langle 2,1\rangle}$ and $V^d_{\langle 1,2\rangle}$ exist. 
 \item \textbf{CFTs with 1 degenerate field} $V^d_{\langle 1,2\rangle}$. Because the invariance under $\beta\to \beta^{-1}$ is broken by choosing $V^d_{\langle 1,2\rangle}$ rather than $V^d_{\langle 2,1\rangle}$, such CFTs depend on $\beta^2$ \eqref{cb} rather than on the central charge $c$. 
\end{itemize}
For $\beta^2\in\mathbb{Q}$, we have to distinguish fully degenerate fields from partly degenerate fields. And the fully degenerate fields $V^f_{\langle 2,1\rangle}$ and $V^f_{\langle 1,2\rangle}$ are not independent, as follows from the identities
\begin{align}
 \beta^2 =\frac{q}{p}>0 \implies V^f_{\langle p-1,1\rangle} = V^f_{\langle 1,q-1\rangle} \quad , \quad  \beta^2 =-\frac{q}{p}<0 \implies V^f_{\langle p+1,1\rangle} = V^f_{\langle 1,q+1\rangle}\ . 
\end{align}
Degenerate fields are so important that it has been proposed to formally extend the conformal algebra into an \textbf{interchiral algebra}, which also includes the degenerate fields \cite{grs12}. While we will not systematically use this concept, we will find it convenient to introduce interchiral blocks in Section \ref{sec:icb}. 

\subsubsection{Degenerate OPEs and their consequences}\label{sec:dotc}

The OPE of $V^d_{\langle 2,1\rangle}$ or $V^d_{\langle 1,2\rangle}$ with a given primary field is constrained by the fusion rules \eqref{rvvp}, which allow 2 left-moving momentums and 2 right-moving momentums, for a total of 4 representations.  In the case of a diagonal field $V_P$, the requirement that only spinless primary fields appear single out 2 of the 4 possibilities:
\begin{align}
 \boxed{V^d_{\langle 2,1\rangle} V_P \sim \sum_\pm V_{P\pm\frac{\beta}{2}}} \quad , \quad \boxed{V^d_{\langle 1,2\rangle} V_P \sim \sum_\pm V_{P\pm\frac{1}{2\beta}}} \ . 
 \label{vpope}
\end{align}
In the case of a non-diagonal field $V_{(r,s)}$, the 4 fields that can a priori appear are
\begin{align}
 V^d_{\langle 2,1\rangle}V_{(r,s)} &\subset \sum_\pm V_{(r\pm 1,s)} + \sum_\pm V_{(r,s\pm \beta^2)}\ ,
 \label{vtovrs}
 \\
 V^d_{\langle 1,2\rangle}V_{(r,s)} &\subset \sum_\pm V_{(r\pm \beta^{-2},s)} + \sum_\pm V_{(r,s\pm 1)}\ .
 \label{votvrs}
\end{align}
Since all fields have half-integer spins, the following spin differences must also be half-integer whenever the corresponding fields exist: 
\begin{align}
 S_{(r\pm 1,s)} - S_{(r,s)} = \mp s &\quad , \quad S_{(r,s\pm \beta^2)} - S_{(r,s)} = \mp r\beta^2\ ,
 \label{sdiff1}
 \\
 S_{(r\pm \beta^{-2},s)} - S_{(r,s)} = \mp s\beta^{-2} &\quad , \quad S_{(r,s\pm 1)} - S_{(r,s)} = \mp r\ . 
 \label{sdiff2}
\end{align}
We now assume that $\beta^2\notin \mathbb{Q}$, and remember $rs\in\frac12\mathbb{Z}$. It follows that $V_{(r\pm 1,s)}$ and $V_{(r,s\pm 1)}$ can coexist neither with $V_{(r,s\pm \beta^2)}$ nor with $V_{(r\pm \beta^{-2},s)}$. Therefore, the OPEs $V^d_{\langle 2,1\rangle}V_{(r,s)}$ and $V^d_{\langle 1,2\rangle}V_{(r,s)}$ each contain at most two primary fields, out of the four that are allowed by fusion rules. For notational simplicity, we choose these two primary fields as follows: 
\begin{align}
 \boxed{V^d_{\langle 2,1\rangle}V_{(r,s)} \sim \sum_\pm V_{(r\pm 1,s)}} \quad ,\quad
 \boxed{V^d_{\langle 1,2\rangle}V_{(r,s)} \sim \sum_\pm V_{(r,s\pm 1)}}\ . 
 \label{vdvrs}
\end{align}
While they were derived under the assumption $\beta^2\notin \mathbb{Q}$, we will assume that these OPEs are valid for any value of the central charge. 

The OPEs \eqref{vdvrs} and \eqref{vpope} indicate which primary fields can appear: we now assume that in each one of these OPEs, the two fields that can appear do appear. 
Together with the closure of the spectrum under OPEs, this leads to constraints on non-diagonal fields. If indeed $V^d_{\langle 1,2\rangle}\in\widetilde{\mathcal{S}}$, then $V_{(r,s)}\in\widetilde{\mathcal{S}}\implies V_{(r,s\pm 1)}\in\widetilde{\mathcal{S}}$. 
 Requiring that the conformal spin \eqref{srs} remains half-integer under $s\to s\pm 1$, we obtain
 $r\in \frac12 \mathbb{Z}$.
Moreover, let us  consider the correlation function $\left<V^d_{\langle 1,2\rangle}\prod_{i=1}^NV_{(r_i,s_i)}\right>$. 
The monodromy of $V^d_{\langle 1,2\rangle}$  around $V_{(r_i,s_i)}$ is $e^{2\pi ir_i}\in \{1,-1\}$, as determined by the OPE \eqref{tope} and the differences of spins \eqref{sdiff2}. These monodromies may be nontrivial, since we do not require correlation functions to be single-valued in an extended CFT. 
But the product of monodromies must be $1$, which implies 
\begin{align}
 \boxed{V^d_{\langle 1,2\rangle}\in\widetilde{\mathcal{S}} \quad \implies\quad  r\in \frac12\mathbb{Z} \quad , \quad \sum_{i=1}^N r_i  \in \mathbb{Z}}\ . 
 \label{sriz}
\end{align}
Similarly, the existence of $V^d_{\langle 2,1\rangle}$ leads to constraints on the second Kac index of non-diagonal fields $V_{(r,s)}$,
\begin{align}
 \boxed{V^d_{\langle 2,1\rangle}\in\widetilde{\mathcal{S}} \quad \implies\quad  s\in \frac12\mathbb{Z} \quad , \quad \sum_{i=1}^N s_i  \in \mathbb{Z}}\ . 
 \label{ssiz}
\end{align}
These constraints also apply in the presence of diagonal fields, if we set $r=s=0$ for any diagonal field. 

Finally, a necessary condition for an OPE $V_1V_2\sim \sum_{k\in\mathcal{S}_{12}}V_k$ \eqref{tope} to converge is that the total conformal dimension be bounded from below over the OPE spectrum $\mathcal{S}_{12}$,
\begin{align}
 \boxed{\inf_{k\in \mathcal{S}_{12}}\Re\left(\Delta_k+\bar\Delta_k\right) > -\infty} \ . 
 \label{iddb}
\end{align}
The total conformal dimension of a non-diagonal field $V_{(r,s)}$ is 
\begin{align}
 \Delta_{(r,s)}+\Delta_{(r,-s)} = \frac12\left[ r^2\beta^{2} + s^2\beta^{-2}  -\left(\beta-\beta^{-1}\right)^2\right]\ .
\end{align}
If $V^d_{\langle 1,2\rangle}$ exists, then the OPE \eqref{vdvrs} increments $s$ by one unit, therefore $s$ is unbounded in real part i.e. $\sup_{V_{(r,s)}\in \widetilde{\mathcal{S}}} \left(\Re s\right) = \infty$. Assuming that this holds not only for the extended spectrum $\widetilde{\mathcal{S}}$ but also for some OPE spectrum $\mathcal{S}_{12}$, we deduce $\Re\beta^{-2}>0$, or equivalently 
\begin{align}
 \boxed{\Re\beta^2 > 0 \quad \text{i.e.} \quad \Re c < 13}\ .
 \label{rbp}
\end{align}
This constraint holds for all known non-diagonal CFTs with at least 1 degenerate field. 

\subsection{Diagonal CFTs with 2 degenerate fields}\label{sec:diag}

\subsubsection{Generalized minimal models}\label{sec:gmm}

For $\beta^2\in\mathbb{C}^*\backslash\mathbb{Q}$, we define the \textbf{generalized minimal model (GMM)} as the CFT whose spectrum of primary fields is made of all diagonal degenerate fields:
\begin{align}
 \boxed{\mathcal{S}^\text{GMM} = \left\{ V^d_{\langle r,s\rangle}\right\}_{r,s\in\mathbb{N}^*}} \ . 
\end{align}
The set of conformal dimensions is in general not bounded from below:
\begin{align}
 \inf_{r,s\in\mathbb{N}^*}\left(\Re\Delta_{(r,s)}\right) = \left\{\begin{array}{ll} \frac{c-1}{24} &\text{ if } \beta^2 \in \mathbb{R}^*\ , \\ -\infty & \text{ else }. \end{array}\right. 
\end{align}
However, thanks to the degenerate fusion rules \eqref{rrsr}, any OPE spectrum is finite, and therefore respects the convergence condition \eqref{iddb}.

For $\beta^2\in \mathbb{Q}$, the degenerate dimensions $\Delta_{(r,s)}$ are not all different, and there is no GMM. However, there exist other CFTs whose primary fields are diagonal and (partly or fully) degenerate, starting with A-series minimal models. One way to explore this issue is to take limits of GMM correlation functions as $\beta^2\to \beta^2_0\in \mathbb{Q}$. This can give rise not only to minimal model correlation functions, but also to logarithmic correlation functions \cite{rib18}, suggesting the existence of non-minimal CFTs. 

Generalized minimal models exist only on the sphere. In particular, their torus partition functions are infinite: if $\beta^2\in\mathbb{C}\backslash \mathbb{R}$, this is because $\left\{ \Delta_{(r,s)}\right\}_{r,s\in\mathbb{N}^*}$ is not bounded from below. Nevertheless, GMMs are interesting because they are very simple and natural CFTs, which give rise to various other CFTs in certain limits --- starting with Liouville theory.

\subsubsection{Liouville theory}\label{sec:liou}

Let us consider the spectrum of a generalized minimal model with $\beta^2\in\mathbb{R}_{>0}\backslash\mathbb{Q}$. The momentums $P_{(r,s)}$ \eqref{prs} are dense in the real line, i.e. $\text{closure}\big(\left\{ P_{(r,s)}\right\}_{r,s\in\mathbb{N}^*}\big) = \mathbb{R}$. Any diagonal field with a real momentum can therefore be obtained as a limit of degenerate fields,
\begin{align}
 \forall P\in\mathbb{R}\ , \quad V_P = \lim_{\substack{r,s\to\infty \\ P_{(r,s)}\to P}} V^d_{\langle r,s\rangle}\ .
 \label{vplim}
\end{align}
We assume that the resulting fields are only characterized by their conformal dimensions. This implies that $V_P$ does not depend on how exactly we take the limit, and also that $V_P=V_{-P}$. The study of correlation functions in Section \ref{sec:ab} will justify this assumption.

If we apply the limit to both fields in the OPE $V^d_{\langle r_1,s_1\rangle}V^d_{\langle r_2,s_2\rangle}$, the resulting OPE is formally given by the degenerate fusion rules \eqref{rrsr} with $r_1,s_1,r_2,s_2\to\infty$, and we obtain
\begin{align}
 \boxed{V_{P_1}V_{P_2} \sim \frac12 \int_\mathbb{R} dP\ V_P} \ ,
 \label{idpv}
\end{align}
where the factor $\frac12$ is because $V_P=V_{-P}$. Now, remember from Section \ref{sec:csope} that OPE coefficients have poles when the momentum $P$ becomes degenerate, and these poles are dense in the real line. The integral in the OPE $V_{P_1}V_{P_2}$ is therefore formally divergent. But it can be regularized by shifting the integration line into the complex plane:
\begin{align}
 V_{P_1}V_{P_2} \sim \frac12 \int_{\mathbb{R}+i\epsilon} dP\ V_P\ .
 \label{ireg}
\end{align}
Let us call \textbf{Liouville theory} the resulting CFT. The spectrum of primary fields is formally
\begin{align}
 \boxed{\mathcal{S}^\text{Liouville} = \frac12 \left\{ V_P\right\}_{P\in \mathbb{R}}}\ .
 \label{sliou}
\end{align}
The regularized OPE \eqref{ireg} requires that we extend the spectrum to complex momentums. This will turn out to be possible, because correlation functions are analytic in $P$. 

For the moment, we have defined Liouville theory for $\beta^2\in\mathbb{R}_{>0}\backslash\mathbb{Q}$. By taking limits, we can extend it to the half-line $c\leq 1$ i.e. $\beta^2\in\mathbb{R}_{>0}$. But we cannot do an analytic continuation the rest of the complex $c$-plane, because of the poles of OPE coefficients. These poles lie on the real $P$-line if $c\leq 1$, but as soon as $c$ strays from this half-line, the poles spread out in the complex $P$-plane, and cross the integration line $\mathbb{R}+i\epsilon$ for any $\epsilon>0$. In the following figures, we draw the regions where poles are found in blue, and the poles $\pm P_{(1,1)}$ as blue circles; the integration line is in red: 
\begin{align}
 \newcommand{\polewedge}[3]{
\begin{scope}[#1]
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 0) {};
\filldraw[opacity = .1, blue] (0,0) -- (3, -5) -- (3, 5) -- cycle;
\end{scope}
}
\begin{array}{ccc}
\begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
  \draw[ultra thick, blue, opacity = .3] (-4.5, 0) -- (4.5, 0);
  \draw (-4.5, 0) -- (4.5, 0);
  \draw[line width = .6mm, red] (-4.5, .5) -- (4.5, .5);
  \draw[-latex] (-4.5,0)  -- (4.5,0) node [below] {$P$};
  \draw (0, -4) -- (0, 4);
\node[below left] at (.2, .1) {$0$};
\node[blue, draw,circle,inner sep=1pt,fill] at (2, 0) {};
\node[blue, draw,circle,inner sep=1pt,fill] at (-2, 0) {};
 \end{tikzpicture}
 & 
 \begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
  \draw (-4.5, 0) -- (4.5, 0);
  \draw[line width = .6mm, red] (-4.5, 0) -- (4.5, 0);
  \draw[-latex] (-4.5,0)  -- (4.5,0) node [below] {$P$};
  \draw (0, -4) -- (0, 4);
\node[below left] at (.2, .1) {$0$};
\polewedge{rotate = 90, shift = {(1,.7)}}{$-\frac{Q}{2}$}{below};
  \polewedge{rotate = -90, shift = {(1, .7)}}{$\frac{Q}{2}$}{above};
 \end{tikzpicture}
 &
 \begin{tikzpicture}[scale = .4, baseline=(current  bounding  box.center)]
 \draw[ultra thick, blue, opacity = .3] (0,1.5) -- (0,4);
 \draw[ultra thick, blue, opacity = .3] (0,-1.5) -- (0,-4);
  \draw (-4.5, 0) -- (4.5, 0);
  \draw[line width = .6mm, red] (-4.5, 0) -- (4.5, 0);
  \draw[-latex] (-4.5,0)  -- (4.5,0) node [below] {$P$};
  \draw (0, -4) -- (0, 4);
\node[below left] at (.2, .1) {$0$};
\node[blue, draw,circle,inner sep=1pt,fill] at (0, 1.5) {};
\node[blue, draw,circle,inner sep=1pt,fill] at (0, -1.5) {};
 \end{tikzpicture}
 \vspace{3mm}
 \\
\beta^2>0 & \beta^2\in\mathbb{C}\backslash \mathbb{R} & \beta^2<0
\end{array}
\end{align}
We nevertheless define Liouville theory for $c\in\mathbb{C}\backslash (-\infty,1]$ by the spectrum \eqref{sliou} and OPE \eqref{idpv}, where we no longer need to shift the integration line. 
We also assume that correlation functions are analytic in momentums and in the central charge, and that degenerate fields exist, so that we have the extended spectrum
\begin{align}
 \boxed{ \widetilde{\mathcal{S}}^\text{Liouville} = \frac12 \left\{ V_P\right\}_{P\in \mathbb{C}} \cup \left\{ V^d_{\langle r,s\rangle}\right\}_{r,s\in\mathbb{N}^*} }\ .
 \label{stliou}
\end{align}
The resulting extended CFT therefore includes a generalized minimal model. 


\subsubsection{A-series minimal models}\label{sec:amm}

Let us look for rational, diagonal CFTs. 
To any degenerate representation of the Virasoro algebra, we can associate a diagonal primary field. We conjecture that this leads to a bijection 
\begin{align}
\begin{array}{c}
 \text{Finite sets of degenerate representations that are closed under fusion}
 \\
 \iff 
 \\
 \text{Rational, diagonal CFTs on the sphere}
\end{array}
\end{align}
To the best of our knowledge, there is no known counterexample to this conjecture (and no proof either). 
From the fusion rules \eqref{rrsr}, no nontrivial finite set of simply degenerate representations can be closed under fusion. We therefore need multiply degenerate representations, which implies $\beta^2\in\mathbb{Q}$.  

In the case $\beta^2=-\frac{q}{p}<0$, with $p,q\in\mathbb{N}^*$ coprime, there are no finite sets of degenerate representations that are closed under fusion. To look for such sets, we could focus on the simplest doubly degenerate representation, 
\begin{align}
 \mathcal{R}^f_{\langle p+1,1\rangle}=\mathcal{R}^f_{\langle 1,q+1\rangle}\ .
\end{align}
The degenerate fusion rules predict  
\begin{align}
 \mathcal{R}^f_{\langle p+1,1\rangle}\times \mathcal{R}^f_{\langle p+1,1\rangle} = \mathcal{R}^d_{\langle 1,1\rangle} + \mathcal{R}^f_{\langle 2p+1,1\rangle}\ .
 \label{rfppo}
\end{align}
The fully degenerate nature of $\mathcal{R}^f_{\langle 2p+1,1\rangle}$ follows from the associativity of $\mathcal{R}^f_{\langle p+1,1\rangle}\times \mathcal{R}^f_{\langle p+1,1\rangle}\times \mathcal{V}_P$, and from the fusion product
\begin{align}
 \mathcal{R}^f_{\langle p+1,1\rangle} \times \mathcal{V}_P = \sum_{\pm} \mathcal{V}_{P\pm \frac12\sqrt{pq}}\ ,
\end{align}
which follows from Eq. \eqref{rrsvp}, with $\{P\pm \frac12\sqrt{pq}\}_\pm = \{P+i\beta\}_{i=-\frac{p}{2},\cdots, \frac{p}{2}} \cap \{P+j\beta\}_{j=-\frac{q}{2},\cdots, \frac{q}{2}}$. 
The two resulting representations in Eq. \eqref{rfppo} have dimensions that differ by an integer, so they might in fact be combined into a single logarithmic representation, see Section \ref{sec:log}. The point is that by repeatedly fusing $V^f_{\langle p+1,1\rangle}$ with itself, we can obtain primary states of dimensions $\Delta_{(r,1)}$ with no bound on $r$. 

We therefore focus on the case $\beta^2 = \frac{q}{p}>0$ with $p,q\in\mathbb{N}^*$ coprime. For simplicity, we will only study the representations that are generated by $\mathcal{R}^f_{\langle 2,1\rangle}$ and $\mathcal{R}^f_{\langle 1,2\rangle}$. This is enough for recovering the known A-series minimal models, but not for investigating other diagonal, rational CFTs that might exist on the sphere. 
Let us show that $\mathcal{R}^f_{\langle 2,1\rangle}$ and $\mathcal{R}^f_{\langle 1,2\rangle}$ generate the representations $\mathcal{R}^f_{\langle r,s\rangle}$  whose indices belong to the \textbf{Kac table} 
\begin{align}
 \boxed{ K_{p, q}=  \big((0,p)\times (0,q)\big)\bigcap \big(\mathbb{N}\times \mathbb{N}\big) }\ .
 \label{kac}
\end{align}
This amounts to showing that $\mathcal{R}^f_{\langle r_1,s_1\rangle} \times \mathcal{R}^f_{\langle r_2,s_2\rangle}$ only involves representations with indices in the Kac table, and that these representations are fully degenerate. Using the vanishing null vectors of doubly degenerate representations of the type 
\begin{align}
 \mathcal{R}^f_{\langle r,s\rangle} = \mathcal{R}^f_{\langle p-r,q-s\rangle}\ , 
 \label{prqs}
\end{align}
we obtain constraints on the fusion rules \eqref{rrsr}
\begin{align}
 \mathcal{R}^f_{\langle r_1,s_1\rangle} \times \mathcal{R}^f_{\langle r_2,s_2\rangle} &\subset \sum_{r\overset{2}{=} |r_1-r_2|+1}^{r_1+r_2-1}\sum_{s\overset{2}{=} |s_1-s_2|+1}^{s_1+s_2-1} \mathcal{R}^d_{\langle r,s\rangle} \ , 
 \\
 \mathcal{R}^f_{\langle r_1,s_1\rangle} \times \mathcal{R}^f_{\langle r_2,s_2\rangle} &\subset \sum_{r'\overset{2}{=} |r_1-r_2|+1}^{2p-r_1-r_2-1} \sum_{s'\overset{2}{=} |s_1-s_2|+1}^{2q-s_1-s_2-1}\mathcal{R}^d_{\langle r',s'\rangle} \ , 
\end{align}
where $\mathcal{R}^d_{\langle r,s\rangle}$ is a representation that may or may not be fully degenerate. Now, $\mathcal{R}^d_{\langle r,s\rangle} = \mathcal{R}^d_{\langle r',s'\rangle}$ implies $(r,s)=(r',s')$ or $(r,s)=(p-r',q-s')$, but the second equality is impossible due to parity: since $p$ and $q$ are coprime, one of them must be odd, say $p$, but $r\equiv r'\equiv |r_1-r_2|+1\bmod 2$. We therefore obtain the fusion rules 
\begin{align}
 \boxed{\mathcal{R}^f_{\langle r_1,s_1\rangle} \times \mathcal{R}^f_{\langle r_2,s_2\rangle} = \sum_{r\overset{2}{=} |r_1-r_2|+1}^{\min(r_1+r_2,2p-r_1-r_2)-1}\sum_{s\overset{2}{=} |s_1-s_2|+1}^{\min(s_1+s_2,2q-s_1-s_2)-1} \mathcal{R}^f_{\langle r,s\rangle}} \ , 
 \label{rfrf}
\end{align}
where $(r,s)\in K_{p,q}$. To show that $\mathcal{R}^f_{\langle r,s\rangle}$ is fully degenerate, it is enough to realize that a Kac table representation is fully degenerate if and only if its fusion with a generic Verma module $\mathcal{V}_P$ is zero. From Eq. \eqref{rrsvp}, 
\begin{align}
 \mathcal{R}^f_{\langle r,s\rangle}\times \mathcal{V}_P \subset \sum_{i=-\frac{r-1}{2}}^{\frac{r-1}{2}} \sum_{j=-\frac{s-1}{2}}^{\frac{s-1}{2}} \mathcal{V}_{P+i\beta +j\beta^{-1}} \cap \sum_{i'=-\frac{p-r-1}{2}}^{\frac{p-r-1}{2}} \sum_{j'=-\frac{q-s-1}{2}}^{\frac{q-s-1}{2}} \mathcal{V}_{P+i'\beta +j'\beta^{-1}}\ .
\end{align}
The modules $\mathcal{V}_{P+i\beta +j\beta^{-1}}$ and $\mathcal{V}_{P+i'\beta +j'\beta^{-1}}$ coincide if and only if their momentums are opposite or equal. If they are opposite, $P=-P_{(i+i',j+j')}$ must belong to the (reflected) Kac table, so it is not generic. If they are equal, we have $i\beta +j\beta^{-1} = i'\beta +j'\beta^{-1}$ i.e. $2(i-i')q = 2(j'-j)p$. 
But parity forbids $(i,j)=(i',j')$, since $p$ or $q$ is odd. And we have $2|i-i'|<p$ and $2|j-j'|<q$, so our equality cannot be satisfied, and 
\begin{align}
 \mathcal{R}^f_{\langle r,s\rangle}\times \mathcal{V}_P = 0 \ . 
\end{align}
Therefore, by associativity of the fusion product, the product of two fully degenerate representations is again a combination of fully degenerate representations.

We therefore define the A-series minimal model AMM$_{p,q}$ by its spectrum, made of fully degenerate fields in the Kac table:
\begin{align}
 \boxed{\mathcal{S}^{\text{AMM}_{p,q}} = \frac12\left\{ V^f_{\langle r,s\rangle} \right\}_{(r,s)\in K_{p,q}} \quad \text{with} \quad 2\leq p<q\ \text{ coprime}}\ .
 \label{samm}
\end{align}
The factor $\frac12$ accounts for the $\mathbb{Z}_2$ symmetry \eqref{prqs}. We assume $p<q$ because AMM$_{p, q}=$AMM$_{q,p}$, and $2\leq p$ for the Kac table to be non-empty.


\subsubsection{Runkel--Watts-type CFTs}\label{sec:rwt}

Let us consider a limit of A-series minimal models where $\frac{q}{p}\to \beta_0^2>0$. We first take the Kac table indices to be fixed. 
The Kac table becomes infinite, which suggests 
\begin{align}
 \lim_{\substack{\frac{q}{p}\to \beta_0^2\\ r,s\text{ fixed}}} \text{AMM}_{p,q} = \text{GMM}\ . 
 \label{mm-gmm}
\end{align}
Since we obtain arbitrary degenerate fields $V^d_{\langle r,s\rangle}$ in the limit, it is also possible to send the indices $r,s$ to infinity, and therefore to send the momentums $P_{(r,s)}$ to arbitrary values $P\in\mathbb{R}$, just as in Eq. \eqref{vplim}. Therefore, Liouville theory with $c\leq 1$ is not only a limit of generalized minimal models, but also a limit of minimal models:
\begin{align}
 \lim_{\substack{\frac{q}{p}\to \beta_0^2\\ P_{(r,s)}\to P}} \text{AMM}_{p,q} = \text{Liouville}\ . 
 \label{mm-liou}
\end{align}
However, if $\beta_0^2\in\mathbb{Q}$, it is also possible to fine-tune the behaviour of $p,q,r,s$ such that constraints from the minimal model's fusion rules survive in the limit. As a result, we can obtain not only Liouville theory with its trivial OPE \eqref{idpv}, but also another diagonal CFT with the same continuous spectrum but a non-trivial OPE, called a \textbf{Runkel--Watts-type theory} after the original example at $c=1$, discovered by Runkel and Watts \cite{rw01}. 

To begin with, we write $\beta_0^2 = \frac{q_0}{p_0}$ with $p_0$ and $q_0$ coprime integers, equivalently $\mathbb{Z}\beta_0+\mathbb{Z}\beta_0^{-1}=\frac{1}{\sqrt{p_0q_0}}\mathbb{Z}$. There exist infinitely many pairs $(p,q)\in \mathbb{N}^2$ such that 
\begin{align}
 qp_0-pq_0 = 1 \ .
\end{align}
Choosing such pairs amounts to fine-tuning the values of $p, q$, because there are many other ways to satisfy $\lim_{p,q\to\infty}\frac{q}{p}= \frac{q_0}{p_0}$, which is equivalent to $qp_0-pq_0 \ll p$. For fixed $r,s$, we compute the momentum
\begin{align}
 P_{(r,s)} = \frac{1}{2\sqrt{p_0q_0}}\left[rq_0-sp_0+ \frac12\left(\frac{r}{p}+\frac{s}{q}\right) + O\left(\frac{1}{p^2}\right)\right]\ . 
 \label{prsrwt}
\end{align}
We now fine-tune $r,s$ such that 
\begin{align}
 \lim(rq_0-sp_0), \lim\frac{r}{p} , \lim\frac{s}{q} <\infty \quad , \quad \lim\frac{r}{p} = \lim\frac{s}{q} \ . 
\end{align}
To achieve this fine-tuning, it is enough to set
\begin{align}
 \left\{\begin{array}{l} r = r_0 + k p_0\ , \\ s = s_0 + k q_0\ , \end{array}\right. \quad  \text{with} \quad k = O(p)\in \mathbb{N}\ .
\end{align}
This leads to 
\begin{align}
 \lim P_{(r,s)} \underset{p,q\to\infty}{=}  \frac{1}{2\sqrt{p_0q_0}}\left(n+x\right)\quad \text{with} \quad \left\{\begin{array}{l} n =r_0q_0 - s_0p_0 \in \mathbb{Z} \ , \\ x =  \lim\frac{r}{p} = \lim\frac{s}{q} \in (0, 1) \ . \end{array}\right.
\end{align}
Now what happens to the minimal model fusion rules $\mathcal{R}^f_{\langle r_1,s_1\rangle} \times \mathcal{R}^f_{\langle r_2,s_2\rangle}$ \eqref{rfrf} when we apply our limit to both representations? Let us examine the momentums \eqref{prsrwt} of the resulting representations $\mathcal{R}^f_{\langle r,s\rangle}$. The combination $n=rq_0-sp_0$ takes integer values such that $n\equiv n_1+n_2+p_0+q_0\bmod 2$, while 
both $\frac{r}{p}$ and $\frac{s}{q}$, and therefore also $x=\frac12\left(\frac{r}{p}+\frac{s}{q}\right)$, are evenly distributed in the interval $(|x_1-x_2|, \min(x_1+x_2,2-x_1-x_2))$. Writing the primary fields as $V_{n,x} = \lim V_{(r,s)}^f$, we thus find the OPE
\begin{align}
 \boxed{V_{n_1,x_1}V_{n_2,x_2} \sim \sum_{n\in n_1+n_2+p_0+q_0+2\mathbb{Z}}
\int_{|x_1-x_2|}^{\min (x_1+x_2,2-x_1-x_2)} dx\ V_{n, x}}\ .
\end{align}
Of course, $V_{n,x}$ is just another notation for the diagonal field $V_P$, with $n,x$ the integer and fractional parts of $2\sqrt{p_0q_0}P$:
\begin{align}
 P=\frac{n+x}{2\sqrt{p_0q_0}} \quad , \quad n=\Big\lfloor 2\sqrt{p_0q_0}P \Big\rfloor \quad , \quad x = \Big\{2\sqrt{p_0q_0}P \Big\}\ .
\end{align}
The reflection relation $V_P=V_{-P}$ is now $V_{n,x}=V_{-n-1,1-x}$. 
The resulting Runkel--Watts-type CFT has the same spectrum as Liouville theory \eqref{sliou} $
 \mathcal{S}^{\text{RWT}_{p_0,q_0}} = \frac12 \left\{ V_P\right\}_{P\in \mathbb{R}}$. In contrast to Liouville theory, the momentums cannot be continued to complex values, where the OPE would no longer make sense. Notice however that if $x_1\neq x_2$, the OPE does not produce fields with degenerate momentums, i.e. fields of the type $V_{n,0}$. So there is no need to regularize the integral over $x$. Alternatively, the OPE may be written in a manifestly reflection-invariant way using the momentums $P_i$ \cite{rs15},
 \begin{align}
  \left<\prod_{i=1}^3 V_{P_i}\right>\neq 0 \implies \prod_{\pm,\pm} \sin\pi\left(\tfrac{p_0+q_0}{2}+\sqrt{p_0q_0}(P_1\pm P_2\pm P_3)\right) < 0 \ .
  \label{rwtz}
 \end{align}
It turns out that Runkel--Watts-type theories can also be obtained as limits of Liouville theory with $\beta^2\in \mathbb{C}\backslash \mathbb{R}$ \cite{mce07}. The limit of Liouville theory for $\beta^2\to \beta_0^2>0$ generally does not make sense, but it exists if $\beta_0^2$ is rational and the momentums are real. In this limit, the condition \eqref{rwtz} emerges from the three-point structure constants of Liouville theory. 


\subsection{Non-diagonal CFTs with 2 degenerate fields}

\subsubsection{D-series minimal models}

Let us look for rational, non-diagonal CFTs, built from the same representations as A-series minimal models: fully degenerate representations with indices in the Kac table \eqref{kac}, with $\beta^2=\frac{q}{p}\in\mathbb{Q}_{>0}$. For any non-diagonal field $V_{(r,s)}$, we require that the left and right dimensions $\Delta_{(r,\pm s)}$ both coincide with dimensions from the Kac table. To achieve this, a simple ansatz is 
\begin{align}
 (r,s) \in \Big[\left(-\tfrac{p}{2},\tfrac{p}{2}\right) \cap \left(\mathbb{Z}+\tfrac{p}{2}\right)\Big] \times \Big[\left(-\tfrac{q}{2},\tfrac{q}{2}\right) \cap \left(\mathbb{Z}+\tfrac{q}{2}\right)\Big] \ . 
\end{align}
This amounts to taking advantage of the identity $\Delta_{(r,s)}=\Delta_{(r+\frac{p}{2},s+\frac{q}{2})}$ for centering the Kac table at $(r,s)=(0,0)$, which makes the table invariant under $(r,s)\to (r,-s)$. It remains to impose the integer spin condition $rs\in\mathbb{Z}$. If $p,q$ are both odd, no field has integer spin. Without loss of generality, we therefore assume $p\in 2\mathbb{N}^*$ and $q\in 2\mathbb{N}+1$, 
and the integer spin condition reduces to $r\in 2\mathbb{Z}$. This completes the determination of the non-diagonal sector. 

Since $q$ is odd, all non-diagonal fields have $s\in \mathbb{Z}+\frac12$, and the conservation of $s\bmod \mathbb{Z}$ \eqref{ssiz} (with $s=0$ for diagonal fields) reduces to the \textbf{conservation of diagonality}:
\begin{align}
D\times D = D \quad , \quad D\times N = N \quad , \quad N\times N = D \ ,
\label{ddd}
\end{align}
where $D$ stands for diagonal and $N$ for non-diagonal fields. 
Moreover, we assume that the diagonal sector is generated by taking OPEs of non-diagonal fields. 
By the degenerate fusion rules \eqref{rrsr}, the diagonal sector involves representations $\mathcal{R}^f_{\langle r,s\rangle}$ with $r\in 2\mathbb{N}+1$, and the spectrum is 
\begin{align}
 \boxed{\mathcal{S}^{\text{DMM}_{p,q}} = \frac12\left\{ V^f_{\langle r,s\rangle} \right\}_{\substack{(r,s)\in K_{p, q}\\ r\equiv 1\bmod 2}} 
 \bigcup 
 \frac12\left\{V_{(r,s)} \right\}_{\substack{(r,s)\in (-\frac{p}{2},\frac{p}{2})\times (-\frac{q}{2},\frac{q}{2})\\ (r,s)\in 2\mathbb{Z}\times (\mathbb{Z}+\frac12)}}
}\ ,
\label{sdmm}
\end{align}
where the non-diagonal fields $V_{(r,s)}$ are fully degenerate. This is valid for 
\begin{align}
 \boxed{p\in 2\mathbb{N}+6 \quad , \quad q \in 2\mathbb{N}+3 \quad ,\quad p,q\text{ coprime}} \ ,
\end{align}
where the lower bounds $p\geq 6$ and $q\geq 3$ ensure that the non-diagonal sector contains fields with nonzero spins. If we allow spins to be half-integer, we obtain the extended spectrum
\begin{align}
 \widetilde{\mathcal{S}}^{\text{DMM}_{p,q}} = \frac12\left\{ V^f_{\langle r,s\rangle} \right\}_{\substack{(r,s)\in (0,p) \times (0,q)\\ (r,s)\in \mathbb{N}\times \mathbb{N}}} 
 \bigcup 
 \frac12\left\{V_{(r,s)} \right\}_{\substack{(r,s)\in (-\frac{p}{2},\frac{p}{2})\times (-\frac{q}{2},\frac{q}{2})\\ (r,s)\in \mathbb{Z}\times (\mathbb{Z}+\frac12)}}
\ .
\end{align}
The corresponding CFT may be called a fermionic minimal model \cite{rw20}. The fusion rules are obtained by combining the fully degenerate fusion rules \eqref{rfrf} with the conservation of diagonality:
\begin{align}
 V^f_{\langle r_1,s_1\rangle}V_{(r_2,s_2)} &\sim \sum_{r\overset{2}{=}\max(r_2-r_1,r_1-r_2-p)+1}^{\min(r_1+r_2,p-r_1-r_2)-1} \sum_{s\overset{2}{=}\max(s_2-s_1,s_1-s_2-q)+1}^{\min(s_1+s_2,q-s_1-s_2)-1} V_{(r,s)} \ ,
 \label{vfvn}
 \\
 V_{(r_1,s_1)} V_{(r_2,s_2)} & \sim \sum_{r\overset{2}{=}|r_1-r_2|+1}^{p-|r_1+r_2|-1} \sum_{s\overset{2}{=}|s_1-s_2|+1}^{q-|s_1+s_2|-1} V^f_{\langle r,s\rangle}\ . 
 \label{vnvn}
\end{align}
It can be checked that for these fusion rules, the D-series minimal model is a closed subsector of its fermionic extension. Curiously, the diagonal field $V^f_{\langle \frac{p}{2}, s\rangle}$ has the same conformal dimensions as the non-diagonal field $V_{(0,s-\frac{q}{2})}$: this an instance of a nontrivial \textbf{field multiplicity}. However, these two fields have different fusion rules. 

\subsubsection{Generalized D-series minimal models}\label{sec:gdmm}

Let us consider a limit of D-series minimal models where $\frac{q}{p}\to \beta^2>0$. There is a natural way of taking the limit of the non-diagonal sector, which is to assume that non-diagonal fields $V_{(r,s)}$ have fixed indices:
\begin{align}
 \lim_{p,q\to\infty} \left. \mathcal{S}^{\text{DMM}_{p,q}} \right|_{\text{non-diagonal}} = 
 \frac12\left\{V_{(r,s)} \right\}_{ (r,s)\in 2\mathbb{Z}\times (\mathbb{Z}+\frac12)}\ .
\end{align}
The diagonal sector only differs from the spectrum $\mathcal{S}^{\text{AMM}_{p,q}}$ \eqref{samm} by the restriction $r\in 2\mathbb{N}+1$. 
As we saw in Section \ref{sec:rwt}, there are several possible limits of A-series minimal models, including Liouville theory and generalized minimal models, and this also applies to our diagonal sector $\left. \mathcal{S}^{\text{DMM}_{p,q}} \right|_{\text{diagonal}} $. However, we will now lift this ambiguity by deriving the diagonal sector from the non-diagonal sector, using the fusion rule \eqref{vnvn}. At first sight, this fusion rule has the limit  
\begin{align}
 \lim_{p,q\to\infty} V_{(r_1,s_1)} V_{(r_2,s_2)}  \overset{?}{\sim} \sum_{r\overset{2}{=}|r_1-r_2|+1}^{\infty} \sum_{s\overset{2}{=}|s_1-s_2|+1}^{\infty} V^d_{\langle r,s\rangle}\ .
\end{align}
This is a sum over infinitely many degenerate fields, whose momentums $P_{(r,s)}$ are dense in the real line if $\beta^2\notin \mathbb{Q}$. The sum is therefore divergent. To obtain a finite limit, we need to compute 
\begin{align}
 \lim_{p,q\to\infty} \frac{1}{q} V_{(r_1,s_1)} V_{(r_2,s_2)} \sim \frac12 \int_\mathbb{R} dP \ V_P\ .
\end{align}
This shows that in the limit CFT, the OPE of two non-diagonal fields is actually 
\begin{align}
 V_{(r_1,s_1)}V_{(r_2,s_2)} \sim \frac12 \int_{\mathbb{R}+i\epsilon} dP\ V_P\ ,
 \label{vrsvrs}
\end{align}
where the imaginary shift $i\epsilon$ is here for avoiding poles of OPE coefficients, just like in $c\leq 1$ Liouville theory \eqref{ireg}. This leads to the spectrum
\begin{align}
\boxed{\mathcal{S}^{\text{GDMM}_{\beta^2}} = \frac12 \left\{V_P\right\}_{P\in \mathbb{R}} \bigcup  \frac12\left\{V_{(r,s)} \right\}_{ (r,s)\in 2\mathbb{Z}\times (\mathbb{Z}+\frac12)}  }\ ,
\end{align}
and we call the corresponding CFT a \textbf{generalized D-series minimal model}. Due to the lack of $r\leftrightarrow s$ symmetry in the non-diagonal sector, this theory depends on $\beta^2$ rather than the central charge $c$, i.e. it is not invariant under $\beta \to \beta^{-1}$. 
The OPEs of this CFT are determined by the conservation of diagonality: in addition to the OPEs of two non-diagonal fields \eqref{vrsvrs} and the OPE of two diagonal fields \eqref{idpv}, we have the mixed OPE 
\begin{align}
 V_{(r_1,s_1)}V_P \sim \frac12 \sum_{r\in 2\mathbb{Z}}\sum_{s\in \mathbb{Z}+\frac12} V_{(r,s)} \ . 
\end{align}
Like Liouville theory, generalized D-series minimal models cannot be analytically continued beyond $\beta^2\in \mathbb{R}_{>0}$. However, we can define these models by their spectrums in the range $\Re\beta^2>0$ \eqref{rbp}, assuming that they exist. There is indeed evidence that they exist \cite{mr17}, although they have not been fully solved, and the OPEs \eqref{vrsvrs} may include discrete terms in addition to the integral \cite{rib19}. 


\subsection{Loop CFTs}

Critical loop models were originally defined as critical limits of statistical models that describe non-intersecting loops in a two-dimensional space. Starting with the Ising model, many statistical models can be reformulated in terms of loops, or directly constructed from loops. But there is a lot of choice about which observables to include in the model. In the Ising model, if we consider only local observables, we obtain the minimal model $\text{AMM}_{4,3}$ in the critical limit. If we also consider non-local observables such as cluster connectivities, we obtain a much richer CFT. For applications to statistical physics, what matters is less to define a consistent CFT than to compute correlation functions, which are then interpreted as probabilities. We will sketch a few consistent CFTs in Section \ref{sec:models}, but our main focus will be on correlation functions, which will be the subject of Section \ref{sec:cloop}.

To begin with, we will now propose a simple extended spectrum that will include all the known loop CFTs, based on the assumption that there exists one degenerate field. 

\subsubsection{Extended spectrum}

Let the extended spectrum $\widetilde{S}^\text{loop}$ be made of all primary fields with half-integer spins that are compatible with the degenerate field $V^d_{\langle 1,2\rangle}$:
\begin{align}
 \boxed{\widetilde{S}^\text{loop} = \left\{V^d_{\langle 1,s\rangle}\right\}_{s\in\mathbb{N}^*}  \bigcup \left\{V_{(r,s)}\right\}_{\substack{r\in \frac12\mathbb{N}^*\\ s\in\frac{1}{2r}\mathbb{Z}}}\bigcup \left\{ V_P\right\}_{P\in\mathbb{C}} } \ .
 \label{sloop}
\end{align}
We therefore include all degenerate fields that are generated from $V^d_{\langle 1,2\rangle}$ by fusion, and all possible diagonal fields. When it comes to non-diagonal fields, the first index $r$ must be half-integer according to Eq. \eqref{sriz}. The reflection relation $V_{(r,s)}=V_{(-r,-s)}$ \eqref{refl} allows us to assume $r\geq 0$, and the sector $r=0$ is redundant with the diagonal sector, since 
\begin{align}
 V_{(0,s)} = V_{\frac12\beta^{-1}s}  \quad \text{i.e.} \quad V_P = V_{(0,2\beta P)} \ .
 \label{sP}
\end{align}
On the other hand, $V_{(r,0)}$ is a genuinely non-diagonal field, whose fusion rules differ from those of the diagonal field with the same dimensions $V_{\frac12\beta r}$. 

Our simple extended spectrum hides important subtleties: 
\begin{itemize}
 \item We characterize fields by their conformal dimensions, but there could be several independent fields with the same dimensions, in other words there could be nontrivial field multiplicities. This is known to occur in the loop CFTs of Section \ref{sec:models}, where the multiplicities are described in terms of representations of global symmetry groups.  
 \item Knowing which primary fields belong to $\widetilde{S}^\text{loop}$ is not enough for determining how the conformal algebra acts on $\widetilde{S}^\text{loop}$. For $(r,s)\in \mathbb{N}^*\times \mathbb{Z}^*$, the primary field $V_{(r,s)}$ has a null vector, and the Verma module $\mathcal{V}_{\Delta_{(r,s)}}\otimes\bar{\mathcal{V}}_{\Delta_{(r,-s)}}$ is not the only representation that includes $V_{(r,s)}$. The correct representation can be determined by starting with $V_{(r,0)}\in \mathcal{V}_{\Delta_{(r,0)}}\otimes\bar{\mathcal{V}}_{\Delta_{(r,0)}}$, and repeatedly taking OPEs with $V^d_{\langle 1,2\rangle}$, see Section \ref{sec:log}. It turns out that $V_{(r,s)}$ and $V_{(r,-s)}$ both belong to the same logarithmic indecomposable representation, which is not left-right factorized. 
\end{itemize}

\subsubsection{Dependence on the central charge and fusion rules}

In loop CFTs, the existence of non-diagonal fields together with $V^d_{\langle 1,2\rangle}$ leads to the half-plane constraint $\Re c<13$ \eqref{rbp} on the central charge. And the asymmetry between the two Kac indices $r,s$ means that loop CFTs really depend on $\beta^2$ \eqref{cb}, not on $c$. 

We now make an assumption that has 3 different formulations:
\begin{enumerate}
 \item Any OPE spectrum is discrete.
 \item Loop CFTs do not include Liouville theory. 
 \item Correlation functions are meromorphic in $\beta$ over the whole domain $\Re c<13$.
\end{enumerate}
These fomulations are equivalent because a continous OPE spectrum would produce non-analyticities on the line $c\leq 1$, as we saw in the context of Liouville theory in Section \ref{sec:liou}. Admittedly, it is only a conjecture that discreteness of the OPEs implies that correlation functions are meromorphic.

In addition to our assumption that OPEs are discrete, known constraints on fusion rules are:
\begin{itemize}
 \item The degenerate field $V^d_{\langle 1,2\rangle}$ implies the conservation of $r$ modulo integers \eqref{sriz}.
 \item OPEs that involve $V^d_{\langle 1,2\rangle}$ are given by Eqs. \eqref{vpope} and \eqref{vdvrs}.
\end{itemize}
The basic expectation is that in any OPE, any non-diagonal field that is not excluded by these constraints appears. For diagonal fields, our constraints are weak. We postpone the full determination of OPEs to Section \ref{sec:cloop}.


\subsubsection{$O(n)$ CFT, $U(n)$ CFT, Potts CFT}\label{sec:models}

Three known models give rise to integer-spin subsets of the extended spectrum $\widetilde{S}^\text{loop}$. 
Their spectrums are 
\begin{align}
\mathcal{S}^{O(n)} &= \left\{V^d_{\langle 1,s\rangle}\right\}_{s\in 2\mathbb{N}+1} \bigcup \left\{V_{(r,s)}\right\}_{\substack{r\in \frac12\mathbb{N}^*\\ s\in\frac{1}{r}\mathbb{Z}}}  \ ,
\label{son}
 \\
 \mathcal{S}^{U(n)} &= \left\{V^d_{\langle 1,s\rangle}\right\}_{s\in\mathbb{N}^*} \bigcup \left\{V_{(r,s)}\right\}_{\substack{r\in \mathbb{N}^*\\ s\in\frac{1}{r}\mathbb{Z}}}  \ ,
 \label{sun}
 \\
 \mathcal{S}^\text{Potts} &= \left\{V^d_{\langle 1,s\rangle}\right\}_{s\in\mathbb{N}^*} \bigcup \left\{V_{(r,s)}\right\}_{\substack{r\in \mathbb{N}+2\\ s\in\frac{1}{r}\mathbb{Z}}} \bigcup  \left\{ V_{P_{(0,s)}}\right\}_{s\in \mathbb{N}+\frac12}\ .
 \label{spotts}
\end{align}
The spectrums of the $O(n)$ and $U(n)$ models are natural constructions: we start with a degenerate field $V^d\in\{V^d_{\langle 1,3\rangle},V^d_{\langle 1,2\rangle}\}$, and add non-diagonal fields $V_{(r,s)}\in\widetilde{S}^\text{loop}$ such that $V_{(r,s)}$ and the fields that appear in $V^dV_{(r,s)}$ have integer spins. 
On the other hand, the Potts spectrum has no simple explanation in our formalism. We can only remark that it is obtained from the $U(n)$ spectrum by removing the non-diagonal fields $\left\{V_{(1,s)}\right\}_{s\in\mathbb{Z}}$ and adding the diagonal fields $\left\{ V_{P_{(0,s)}}\right\}_{s\in \mathbb{N}+\frac12}$, see Section \ref{sec:coup} for a justification from statistical physics.  

Each one of these CFTs has
\begin{itemize}
 \item a modular-invariant torus partition function,
 \item a group of global symmetries that commutes with conformal symmetry: the orthogonal group $O(n)$, the unitary group $U(n)$, or the symmetric group $S_Q$ in the case of the Potts CFT. The parameters of these groups can take arbitrary complex values \cite{gnjrs21, br19}
 \begin{align}
  \boxed{n = -2\cos\left(\pi \beta^2\right)} \quad , \quad \boxed{Q = 4\cos^2\left(\pi \beta^2\right)}\ .
  \label{nQ}
 \end{align}
\end{itemize}
Degenerate fields are invariant under global symmetries, while other fields can transform in non-trivial representations \cite{jrs22}. For example, in the $O(n)$ CFT, the fields $V_{(\frac12,0)},V_{(1,0)}$ and $V_{(1,1)}$ transform under $O(n)$ as a vector, a symmetric 2-tensor and an antisymmetric 2-tensor respectively. There are two fields of the type $V_{(\frac32,0)}$, which transform as symmetric and antisymmetric 3-tensors. And for $r\geq \frac52$, it also happens that several different fields have the same conformal dimensions and the same behaviour under $O(n)$. The situation is similar in the $U(n)$ and Potts CFTs: let us only mention that the diagonal non-degenerate fields $V_{P_{(0,s)}}$ of the Potts CFT transform in the standard  representation of $S_Q$, whose dimension is $Q-1$. 

A puzzle has arisen in the $O(n)$ CFT, when it was found that there is one field $V_{(2,0)}$ that is invariant under $O(n)$ \cite{gz20}. From the point of view of the renormalization group flow triggered by the field $V^d_{\langle 1,3\rangle}$, this field is \textit{dangerously irrelevant}, i.e. it becomes relevant along the flow, and could prevent the flow from reaching the dense phase from the dilute phase. But numerical studies show that the flow does reach the dense phase. The puzzle is resolved by noticing that $V^d_{\langle 1,3\rangle}$ is degenerate, and cannot produce the non-diagonal field $V_{(2,0)}$ by repeated fusion, even if $O(n)$ symmetry would allow it \cite{js23}. Therefore, it is global symmetry itself that is \textit{dangerously irrelevant} to the understanding of this flow. 

\subsection{Completing the picture}

\subsubsection{Summary of spectrums}

For each CFT, we indicate the values of $\beta^2$, of the Kac indices of degenerate fields, of the indices of non-diagonal fields, and of the momentums of diagonal fields:
\begin{align}
 \begin{array}{|c|c|c|c|c|}
  \hline 
  \text{CFT} & \beta^2  & V^{d/f}_{\langle r,s\rangle} & V_{(r,s)} & V_P
  \\
  \hline \hline 
  \text{GMM} & \mathbb{C}\backslash \mathbb{Q}  & \mathbb{N}^*\times \mathbb{N}^* &  - & -
  \\
  \hline 
  \text{Liouville} & \mathbb{C}^*  & - & - &  \mathbb{R}
  \\
  \hline 
  \widetilde{\text{Liouville}} & \mathbb{C}^*  & \mathbb{N}^*\times \mathbb{N}^* & - & \mathbb{C}
  \\
  \hline
  \text{AMM} & \frac{q}{p} > 0  & 
  \begingroup\renewcommand*{\arraystretch}{1}
  \begin{array}{c} \mathbb{N}\times \mathbb{N}\\  (0,p)\times (0,q)\end{array}\endgroup & - &  -
  \\
  \hline 
  \text{RWT} & \frac{q}{p} > 0  & - & - &  \mathbb{R}
  \\
  \hline \hline 
  \text{DMM} & \begingroup\renewcommand*{\arraystretch}{1}
  \begin{array}{c}\frac{q}{p} > 0 \\ p \in 2\mathbb{N} \end{array}\endgroup
  & \begingroup\renewcommand*{\arraystretch}{1}
  \begin{array}{c}
  (2\mathbb{N}+1)\times \mathbb{N} \\ (0,p)\times (0,q)\end{array}\endgroup
  &  \begingroup\renewcommand*{\arraystretch}{1}
  \begin{array}{c} 2\mathbb{Z}\times (\mathbb{Z}+\frac12) \\ (-\frac{p}{2},\frac{p}{2})\times (-\frac{q}{2},\frac{q}{2}) \end{array}\endgroup & - 
  \\
  \hline 
  \text{GDMM} & \left\{\Re\beta^2>0\right\} & - & 2\mathbb{Z}\times (\mathbb{Z}+\frac12) & \mathbb{R} 
  \\
  \hline\hline 
  \widetilde{\text{Loop}} & \left\{\Re\beta^2>0\right\} & \{1\}\times \mathbb{N}^* & \frac12\mathbb{N}^* \times \frac{1}{2r}\mathbb{Z}  & \mathbb{C} 
  \\
  \hline 
  O(n) & \left\{\Re\beta^2>0\right\} & \{1\}\times(2\mathbb{N}+1) &  \frac12\mathbb{N}^* \times \frac{1}{r}\mathbb{Z} & - 
  \\
  \hline 
  U(n) & \left\{\Re\beta^2>0\right\} & \{1\}\times \mathbb{N}^* &  \mathbb{N}^* \times \frac{1}{r}\mathbb{Z} & - 
  \\
  \hline 
  \text{Potts} & \left\{\Re\beta^2>0\right\} & \{1\}\times \mathbb{N}^* &  (\mathbb{N}+2) \times \frac{1}{r}\mathbb{Z} & 
  \{P_{(0,s)}\}_{s\in\mathbb{N}+\frac12}
  \\
  \hline 
 \end{array}
 \label{sostab}
\end{align}

\subsubsection{Limits of diagonal CFTs}\label{sec:lod}

Taking limits played an important role in deriving some of the CFTs of Section \ref{sec:diag}. 
Let us summarize the limits that relate Liouville theory, (generalized) minimal models, and Runkel--Watts-type theories: 
\begin{align}
\begin{tikzpicture}[scale = .25, baseline=(current  bounding  box.center)]
\fill[red!50, rounded corners = 10] (-6, -10) rectangle (6, 10);
\fill[green!15, rounded corners = 10] (7, -10) rectangle (19, 10);
\fill[blue!30, rounded corners = 10] (20, -10) rectangle (32, 10);
\node at (0, 11) {$\beta^2\in\mathbb{Q}_{>0}$};
\node at (13, 11) {$\beta^2\in\mathbb{R}_{>0}$};
\node at (26, 11) {$\beta^2\in \mathbb{C}\backslash \mathbb{R}$};
\node[left] at (-6.5, 7) {Discrete};
\node[left] at (-6.5, -7) {Continuous};
\draw (0, 7) node[draw, fill = white] (mm) {AMM};
\draw (13, 7) node[draw, fill = white] (gmm1) {GMM};
\draw (26, 7) node[draw, fill = white] (gmm2) {GMM};
\draw (0, -7) node[draw, fill = white] (rwt) {RWT};
\draw (13, -7) node[draw, fill = white] (clo) {Liouville};
\draw (26, -7) node[draw, fill = white] (liou) {Liouville};
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex, 
       out = -10, in = -170] (mm) to (gmm1);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex, dashed,
       out = 170, in = 10] (gmm1) to (mm);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex] (gmm2) to (gmm1);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex] (mm) to (clo);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex, dashed] (mm) to (rwt);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex] (rwt) to (clo);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex] (gmm1) to (clo);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex,
       out = -165, in = -15, dashed] (liou) to (rwt);
\draw [ultra thick, shorten <= 2mm, shorten >= 2mm, -latex, dashed] (liou) to (gmm2);
\end{tikzpicture}
\label{lims}
\end{align}
Somewhat subjectively, we have distinguished limits that are straightforward (full arrows) from limits that are subtle (dashed arrows). The subtle limits are:
\begin{itemize}
 \item $\boxed{\text{AMM}\to \text{RWT}}$ (Section \ref{sec:rwt}): This involves fine-tuning the parameters $p,q$ of the minimal models, as well as the parameters $r,s$ of the primary fields.
  \item $\boxed{\text{Liouville}\to \text{RWT}}$ (Section \ref{sec:rwt}): This requires a detailed analysis of structure constants. 
 \item $\boxed{\text{GMM}\to \text{AMM}}$ (\cite{rib18}): This requires a detailed analysis of correlation functions, and only some of the GMM correlation functions tend to AMM correlation functions. 
 \item $\boxed{\text{Liouville}\to \text{GMM}}$ (Section \ref{sec:essc}): This requires a detailed analysis of correlation functions.
\end{itemize}

\subsubsection{Other exactly solvable CFTs}

Let us mention a few other solvable CFTs:
\begin{itemize}
 \item \textbf{E-series minimal models} exist for $\beta^2=\frac{q}{p}$ with $p=12, 18, 30$ \cite{fms97}. They have finitely many primary fields, which belong to fully degenerate representations from the Kac table. 
They have two independent degenerate fields $\left\{V^f_{\langle r,1\rangle},V^f_{\langle 1,2\rangle}\right\}$ with $r=4,5,7$. 
However, we do not know how to derive their known spectrums from the study of fusion rules. 
Solving E-series minimal models is apparently still an open problem. 
\item \textbf{Logarithmic minimal models} are believed to exist for $\beta^2\in \mathbb{Q}_{>0}$ \cite{prz06}. Their primary fields belong to the extended Kac table, i.e. they have integer Kac indices. Their spectrums include logarithmic representations. Their spectrums and fusion rules are not fully known. It is in fact not clear how many such CFTs exist at any given central charge. Presumably, they can be obtained as limits of generalized minimal models. 
\item At $c=1$, the \textbf{compactified free boson} and its $\mathbb{Z}_2$ orbifold the \textbf{Ashkin--Teller model} are better understood in terms of an extended symmetry algebra (an abelian affine Lie algebra), although they can also be solved in terms of Virasoro symmetry only \cite{nr21}. They have a degenerate field $V^f_{\langle 1, 3\rangle}=V^f_{\langle 3,1\rangle}$, which however behaves as the identity field under fusion with non-diagonal fields. As a result, the constraints \eqref{sriz} are not obeyed. These models have a continuous parameter: the compactification radius $R$. For a special value of $R$, the compactified free boson is a $c\to 1$ limit of the $O(n)$ CFT, and the Ashkin--Teller model is a $c\to 1$ limit of the Potts CFT.
\end{itemize}


\section{Analytic bootstrap}\label{sec:ab}

In Section \ref{sec:csope}, we have worked out how local conformal symmetry constrains operator product expansions. This was done by using the associativity of operator products of the type $TVV$, where $T$ is the energy-momentum tensor. The result was that in the OPE $VV$, the contribution of descendant fields are determined by the contributions of primary fields. Similarly, we will now study how degenerate fields constrain structure constants, by using the associativity of 
operator products of the type $V^d_{\langle 2,1\rangle}VV$ or $V^d_{\langle 1,2\rangle}VV$.  
This will determine how structure constants behave under momentum shifts of the type $P\to P+ \beta$ or $P\to P+ \beta^{-1}$. 

\subsection{Degenerate 4-point functions}

Associativity of OPEs is equivalent to crossing symmetry of 4-point functions, so let us consider a 4-point function that involves a degenerate field. Since fusion products of degenerate representations \eqref{rrsvp} are finite, our 4-point function is a combination of finitely many conformal blocks in any one of the 3 channels $s,t,u$. This makes crossing symmetry equations particularly simple, and allows them to be solved analytically. 
And since any degenerate field $V^d_{\langle r,s\rangle}$ can be obtained from the 2 basic degenerate fields $V^d_{\langle 2,1\rangle}$ and $V^d_{\langle 1,2\rangle}$ by fusion, the crossing symmetry equations for $\left<V^d_{\langle r,s\rangle}V_1V_2V_3\right>$ follow from the 2 cases $(r,s)=(2,1)$ and $(r,s)=(1,2)$, which are related to one another by $\beta\to \beta^{-1}$.  

\subsubsection{BPZ equations}

As we have seen in Section \ref{sec:cor}, for any creation operator $L\in\mathcal{L}$, local conformal symmetry determines descendant correlation functions $\left<LV_0\cdots \right>$ in terms of the corresponding primary correlation functions $\left<V_0\cdots \right>$.
In the case of 4-point functions, we have 
\begin{align}
 \Big<LV_0(z)V_1(0)V_2(\infty)V_3(1)\Big> = P_L(z,\partial_z) \Big<V_0(z)V_1(0)V_2(\infty)V_3(1)\Big>\ ,
\end{align}
where $P_L(z,\partial_z)$ is a differential polynomial whose degree in $\partial_z$ is the level $|L|$ of the descendant field. If now our field is degenerate $V_0= V^d_{\langle r,s\rangle}$, then the null vector equation $L_{\langle r,s\rangle}V^d_{\langle r,s\rangle}=0$ \eqref{lvdz} leads to a differential equation of order $rs$,
\begin{align}
 P_{L_{\langle r,s\rangle}}(z,\partial_z) \Big<V^d_{\langle r,s\rangle}(z)V_1(0)V_2(\infty)V_3(1)\Big> = 0\ .
\end{align}
This is called a \textbf{Belavin--Polyakov--Zamolodchikov equation} or \textbf{BPZ equation}.  
Let us derive the BPZ equation for a 4-point function  of the degenerate field $V_{\langle 2,1\rangle}$, together with 3 other primary fields:
\begin{align}
 G(z)=\Big<V_{\langle 2,1\rangle}^d(z)V_{1}(0)V_{2}(\infty)V_{3}(1)\Big>\ .
 \label{goz}
\end{align}
The relevant creation operator is $L_{\langle 2,1\rangle} = L_{-1}^2 -\beta^2L_{-2}$ \eqref{ars}, and the insertion of $L_{-2}$ is in principle determined by the local Ward identity \eqref{lwi}. However, this identity involves derivatives in the positions of $V_{i}$, which are now fixed to $0,\infty,1$. We can eliminate these derivatives using global Ward identities. A technical trick to do this is to rewrite the local Ward identity as $G_\infty(z) = G_{z}(z) + G_0(z) + G_1(z)$, where we define
\begin{align}
 G_{z_0}(z) = \frac{1}{2\pi i} \oint_{z_0} \frac{y(y-1)}{y-z} \Big< T(y)V_{\langle 2,1\rangle}(z)V_{1}(0)V_{2}(\infty)V_{3}(1)\Big> \ .
\end{align}
We then compute $G_{z_0}(z)$ using the OPE $T(y)V_\Delta(z_0)$ \eqref{tvd}. The case $T(y)V_\Delta(\infty) = \frac{\Delta}{y^2} V_\Delta(\infty) + O(\frac{1}{y})$ is obtained from the case $z_0\in\mathbb{C}$ using the global conformal transformation $z\to \frac{1}{z}$ and the definition \eqref{vdi} of $V_\Delta(\infty)$. We find 
\begin{align}
 G_\infty(z) &= \Delta_2 G(z) \quad , \quad G_0(z) = \frac{\Delta_1}{z}G(z)\quad , \quad G_1(z) = \frac{\Delta_3}{1-z}G(z)\ ,
 \\
 G_z(z) &= \left(\Delta_{\langle 2,1\rangle} + (2z-1)\partial_z\right) G(z) + z(z-1)\Big<L_{-2}V_{\langle 2,1\rangle}(z)V_{1}(0)V_{2}(\infty)V_{3}(1)\Big>
 \ .
\end{align}
Combining our rewritten local Ward identity with the null vector equation $L_{\langle 2,1\rangle}V^d_{\langle 2,1\rangle}=0$, and using $L_{-1}^2 V^d_{\langle 2,1\rangle}(z) = \partial_z^2 V^d_{\langle 2,1\rangle}(z)$ \eqref{pvlv}, we obtain the BPZ equation 
\begin{align}
 \left(\frac{z(z-1)}{\beta^2}\frac{\partial^2}{\partial z^2} + (2z-1)\frac{\partial}{\partial z} + \frac{\Delta_1}{z} + \Delta_{\langle 2,1\rangle}-\Delta_2  +\frac{\Delta_3}{1-z} \right) G(z) = 0 \ .
\end{align}

\subsubsection{Hypergeometric conformal blocks}

According to the degenerate fusion rule \eqref{rvvp}, the decomposition of $G(z)$ into $s$-channel left-moving conformal blocks is a combination of two blocks with momentums $P_1\pm \frac{\beta}{2}$. The situation is similar in the $t$- and $u$-channels, and we write the resulting blocks as $\mathcal{F}^{(x)}_\pm(z)$ with $x\in\{s,t,u\}$:
\begin{align}
\mathcal{F}^{(s)}_\pm = 
 \begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .35]
\draw (-1,2) node [left] {$1$} -- (0,0) -- node [above] {$P_1\pm\frac{\beta}{2}$} (4,0) -- (5,2) node [right] {$2$};
\draw (-1,-2) node [left] {$\langle 2,1\rangle\!$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$3$};
\end{tikzpicture}
\quad 
\mathcal{F}^{(t)}_\pm = 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .35]
 \draw (-2,3) node [left] {$1$} -- (0,2) -- node [left] {$P_3\pm\frac{\beta}{2}$} (0,-2) -- (-2, -3) node [left] {$\langle 2,1\rangle\!$};
\draw (0,2) -- (2,3) node [right] {$2$};
\draw (0,-2) -- (2, -3) node [right] {$3$};
\end{tikzpicture}
\quad 
\mathcal{F}^{(u)}_\pm = 
\begin{tikzpicture}[baseline=(current  bounding  box.center), very thick, scale = .35]
\draw (-2,1) node [left] {$1$} -- (0,0) -- node [left] {$P_2\pm \frac{\beta}{2}$} (0,-4) ;
\draw (0,0)-- (2,-5) node [right] {$3$};
\draw (-2,-5) node [left] {$\langle 2,1\rangle\!$} -- (0,-4);
\draw (0,-4) -- (2,1) node [right] {$2$};
\end{tikzpicture} 
\end{align}
The conformal blocks provide 3 bases $\left\{\mathcal{F}^{(x)}_\pm(z)\right\}_\pm$ of solutions of the BPZ equation. Each solution is characterized by its asymptotic behaviour \eqref{stu} in a limit $z\to z_0$ with $z_0\in\{0,\infty,1\}$. Using the definition \eqref{dp} of the momentum, we compute 
\begin{align}
 \delta=\Delta\left(P+\tfrac{\beta}{2}\right) - \Delta(P) -\Delta_{\langle 2,1\rangle} = \beta P + \tfrac{1-\beta^2}{2}\ .
\end{align}
If $\varphi(z) = z^{\delta_1}(1-z)^{\delta_3}$, we deduce that the differential equation for $\varphi^{-1}(z) G(z)$ has holomorphic solutions near $z=0$ and near $z=1$, namely $\varphi(z)\mathcal{F}^{(s)}_+(z)$ and $\varphi(z)\mathcal{F}^{(t)}_+(z)$ respectively. By a tedious but straightforward calculation, we find that the equation for $\varphi^{-1}(z) G(z)$ is a \textbf{hypergeometric differential equation} 
\begin{align}
 \left(z(1-z)\frac{\partial^2}{\partial z^2} + \left[C-(A+B+1)\right]\frac{\partial}{\partial z} -AB\right) \varphi^{-1}(z) G(z) = 0 \ , 
\end{align}
with the parameters 
\begin{align}
 \{A,B\} = \left\{\tfrac12+\beta(P_1\pm P_2+P_3)\right\}_\pm \quad , \quad  C=1+2\beta P_1\ .
\end{align}
This allows us to write our conformal blocks in terms of the \textbf{hypergeometric function} ${}_2F_1$,
\begin{align}
 \mathcal{F}_+^{(s)}(z) &= z^{\beta P_1 +\frac{1-\beta^2}{2}}(1-z)^{\beta P_3 + \frac{1-\beta^2}{2}} {}_2F_1\left(\tfrac12+ \beta P_{123},\tfrac12+\beta P_{13}^2,1+2\beta P_1,z\right) \ , 
 \\
 \mathcal{F}_+^{(t)}(z) &= z^{\beta P_1 +\frac{1-\beta^2}{2}}(1-z)^{\beta P_3 + \frac{1-\beta^2}{2}} {}_2F_1\left(\tfrac12+ \beta P_{123},\tfrac12+\beta P_{13}^2,1+2\beta P_3,1-z\right) \ , 
 \\
 \mathcal{F}_+^{(u)}(z) &= z^{-\beta P_{23} -\frac{\beta^2}{2}}(z-1)^{\beta P_3 + \frac{1-\beta^2}{2}} {}_2F_1\left(\tfrac12+ \beta P_{123},\tfrac12+\beta P_{23}^1,1+2\beta P_2,\tfrac{1}{z}\right) \ , 
\end{align}
where we used the notations $P_{123}=P_1+P_2+P_3$ and $P_{12}^3 = P_1+P_2-P_3$. The block $\mathcal{F}^{(x)}_-$ is obtained from $\mathcal{F}^{(x)}_+$ by $P_i\to -P_i$ where $i=1,3,2$ for $x=s,t,u$. 
Let us write 
the change of basis that relates the $s$- and $t$-channel conformal blocks as 
\begin{align}
 \mathcal{F}^{(s)}_{\epsilon_1} = \sum_{\epsilon_3\pm} F_{\epsilon_1,\epsilon_3} \mathcal{F}^{(t)}_{\epsilon_3}\ , 
 \label{fsfft}
\end{align}
where the size two matrix $\left(F_{\epsilon_1,\epsilon_3}\right)_{\epsilon_1,\epsilon_3=\pm}$ is a \textbf{degenerate fusing matrix}. This matrix has the coefficients 
\begin{align}
 \boxed{F_{\epsilon_1,\epsilon_3} = \frac{\Gamma(1+2\beta\epsilon_1P_1)\Gamma(-2\beta \epsilon_3P_3)}{\prod_\pm \Gamma(\frac12 +\beta \epsilon_1P_1 \pm \beta P_2 -\beta \epsilon_3P_3)}}\ ,
 \label{fee}
\end{align}
and the determinant 
\begin{align}
 \det F = -\frac{P_1}{P_3}\ .
 \label{detf}
\end{align}
The degenerate fusing matrix is built from \textbf{Euler's Gamma function} $\Gamma(x)$: a meromorphic function of $x\in\mathbb{C}$ with simple poles for $x\in -\mathbb{N}$ and no zeros, which obeys $\Gamma(x+1)=x\Gamma(x)$ and $\Gamma(x)\Gamma(1-x)=\frac{\pi}{\sin(\pi x)}$. 

\subsubsection{Crossing symmetry}

We will now assemble hypergeometric conformal blocks into crossing-symmetric 4-point functions. We assume that fusion with $V_{\langle 2,1\rangle}$ acts diagonally on $V_1,V_2,V_3$, i.e. the left and right momentums $P_i,\bar P_i$ are shifted by the same amount $\frac{\beta}{2}$ or $-\frac{\beta}{2}$. (The case where they are shifted by opposite amounts is equivalent, and can be obtained by $\bar P_i\to -\bar P_i$.) This assumption is fulfilled by diagonal fields $V_P$, but also by non-diagonal fields $V_{(r,s)}$ with momentums of the type $(P,\bar P)= (P_{(r,s)},P_{(r,-s)})$. 
Then the degenerate 4-point function \eqref{goz} decomposes into degenerate $x$-channel conformal blocks as 
\begin{align}
 \Big<V_{\langle 2,1\rangle}^dV_{1}V_{2}V_{3}\Big> 
 = \sum_\pm d^{(x)}_\pm \left|\mathcal{F}^{(x)}_\pm \right|^2  
 \ ,
\end{align}
where we use the modulus squared notation \eqref{fdz2}.
Crossing symmetry is the equality of the three decompositions $x=s,t,u$, and leads to relations between the degenerate four-point structure constants $d^{(x)}_\pm$. In particular, applying the change of basis \eqref{fsfft} to the $s$-channel decomposition, and comparing with the $t$-channel decomposition, we obtain 
\begin{align}
 \forall \epsilon,\bar\epsilon \in \{+,-\}\ , \qquad \sum_\pm d_\pm^{(s)} F_{\pm,\epsilon}\bar F_{\pm, \bar\epsilon} = \delta_{\epsilon,\bar\epsilon} d_\epsilon^{(t)}\ . 
 \label{feeb}
\end{align}
The two cases $\epsilon = -\bar\epsilon$ give us two linear relations between $d^{(s)}_+$ and $d^{(s)}_-$, whose compatibility amounts to 
\begin{align}
 \frac{F_{++}F_{--}}{F_{+-}F_{-+}} = \frac{\bar F_{++}\bar F_{--}}{\bar F_{+-}\bar F_{-+}}\ .
 \label{ffff}
\end{align}
With our degenerate fusing matrix \eqref{fee}, we find 
\begin{align}
 \frac{F_{++}F_{--}}{F_{+-}F_{-+}} = \prod_\pm \frac{\cos \pi \beta(P_1\pm P_2-P_3)}{\cos \pi \beta(P_1\pm P_2+P_3)}\ . 
\end{align}
Thanks to the conservation of the second Kac index $s=\beta(\bar P-P)$ modulo integers \eqref{ssiz}, this expression satisfies the compatibility condition \eqref{ffff}. Then the crossing symmetry relations \eqref{feeb} determine all the structure constants $d^{(s)}_\pm,d^{(t)}_\pm$ in terms of one of them,
\begin{align}
 \frac{d^{(s)}_-}{d^{(s)}_+} = -\frac{F_{++}\bar F_{+-}}{F_{-+}\bar F_{--}}\quad , \quad 
 \frac{d^{(t)}_+}{d^{(s)}_+} = \frac{F_{++}}{\bar F_{--}} \det \bar F \quad , \quad 
 \frac{d^{(t)}_-}{d^{(s)}_+} = -\frac{\bar F_{+-}}{F_{-+}} \det F\ .
\end{align}
Explicitly, these relations read 
\begin{align}
  \frac{d^{(s)}_-}{d^{(s)}_+} = -\frac{\Gamma(1+2\beta P_1)}{\Gamma(1-2\beta P_1)}\frac{\Gamma(1+2\beta\bar P_1)}{\Gamma(1-2\beta\bar P_1)} (-)^{2s_2}
 \frac{\prod_{\pm,\pm}\Gamma\left(\tfrac12 -\beta\bar P_1\pm\beta \bar P_2\pm\beta \bar P_3)\right)}{\prod_{\pm,\pm}
 \Gamma\left(\tfrac12 +\beta P_1\pm \beta P_2\pm\beta P_3)\right)}\  ,
 \label{dmdp}
\end{align}
\begin{align}
 \frac{d^{(t)}_+}{d^{(s)}_+} = \frac{\Gamma\left(1+2\beta P_1\right)}{\Gamma\left(-2\beta\bar P_1\right)} 
 \frac{\Gamma\left(-2\beta P_3\right)}{\Gamma\left(1+2\beta\bar P_3\right)} 
  \frac{\prod_\pm\Gamma\left(\frac12 -\beta\bar P_1 \pm \beta\bar P_2 +\beta\bar P_3\right)}{\prod_\pm\Gamma\left(\frac12+\beta P_1 \pm \beta P_2 -\beta P_3\right)}\ ,
 \label{dpdp}
\end{align}
\begin{align}
 \frac{d^{(t)}_-}{d^{(s)}_+} = \frac{\Gamma\left(1+2\beta \bar P_1\right)}{\Gamma\left(-2\beta P_1\right)} 
 \frac{\Gamma\left(2\beta \bar P_3\right)}{\Gamma\left(1-2\beta P_3\right)} 
  \frac{\prod_\pm\Gamma\left(\frac12 -\beta P_1 \pm \beta P_2 -\beta P_3\right)}{\prod_\pm\Gamma\left(\frac12+\beta \bar P_1 \pm \beta \bar P_2 +\beta \bar P_3\right)}\ .
 \label{dtdp}
\end{align}
Let us also write Eq. \eqref{dmdp} in the special case $\left<V_{\langle 2,1\rangle}^d V_1V_{\langle 2,1\rangle}^d V_1\right>$, where 2 of the fields are degenerate and the remaining 2 are equal:
\begin{align}
\frac{d^{(s)}_-}{d^{(s)}_+} =
-\frac{\Gamma\left(1+2\beta P_1\right)}{\Gamma\left(1-2\beta P_1\right)} \frac{\Gamma\left(1+2\beta \bar P_1\right)}{\Gamma\left(1-2\beta \bar P_1\right)} 
 \frac{\Gamma\left(\beta^2-2\beta P_1\right)\Gamma\left(1-\beta^2-2\beta P_1\right)}{\Gamma\left(\beta^2+2\beta \bar P_1\right)\Gamma\left(1-\beta^2+2\beta \bar P_1\right)}\ .
 \label{ddb}
\end{align}
To conclude, we have seen that crossing symmetry allows us to determine degenerate 4-point functions up to an overall constant factor, by imposing relations on 4-point structure constants. Next we will deduce shift equations for the 2-point and 3-point structure constants. 


\subsection{Shift equations for structure constants}

\subsubsection{Degenerate OPE structure constants}

Let us write the degenerate 4-point structure constants $d^{(x)}_\pm$ in terms of 2-point structure constants $B_{ij}=\delta_{ij}B_i$ and 3-point structure constants $C_{ijk}$. We also need to introduce \textbf{degenerate OPE structure constants} $c_i^\pm$ such that 
\begin{align}
V_{\langle 2,1\rangle}^d V_i \sim c^+_i V_{i^+} + c^-_i V_{i^-}\ ,
\end{align}
where we use the notation $i^\pm$ for the labels of the primary fields that appear in the degenerate OPE. 
The reflection relation \eqref{refl} determines $c_i^-$ from $c_i^+$:
\begin{align}
 c_i^- = c^+_{-i}\ ,
 \label{cim}
\end{align}
where we use the notation $-i$ for the label of a reflected field. 
Moreover,
Eq. \eqref{ccb} allows us to rewrite $c_i^\pm$ in terms of 2-point and 3-point structure constants; using the permutation relation \eqref{b21}, we deduce 
\begin{align}
 c_i^- B_{i^-} = (-)^{s_i} c^+_{i^-} B_i\quad , \quad \frac{B_{i^-}}{B_{i^+}} =(-)^{2s_i} \frac{c_i^+}{c_i^-}\frac{c_{i^-}^+}{c_{i^+}^-}\ ,
 \label{cbcb}
\end{align}
where the second equation is obtained from the first one, applied to $i$ and $i^+$. 
With these notations, the degenerate 4-point structure constants are:
\begin{align}
 \begin{tikzpicture}[baseline=(base), very thick, scale = .4]
 \coordinate (base) at (0, -5);
\draw (-1,2) node [left] {$1$} -- (0,0) -- node [above] {$1^\pm$} (4,0) -- (5,2) node [right] {$2$};
\draw (-1,-2) node [left] {$\langle 2,1\rangle$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$3$};
\node at (1.5, -5) {$d^{(s)}_\pm = \colorboxed{red}{c^\pm_1}\, \colorboxed{red}{C_{1^\pm23}}  $};
\draw[dashed, ->, red] (1.3,-4) to [out=90, in=-70] (.2, -.3);
\draw[dashed, ->, red] (3.5,-4.1) to [out=90, in=-110] (3.8, -.3);
\end{tikzpicture} 
\quad
\begin{tikzpicture}[baseline=(base), very thick, scale = .4]
 \coordinate (base) at (0, -5);
\draw (-1,2) node [left] {$1$} -- (0,0) -- node [above] {$1^\pm$} (4,0) -- (5,2) node [right] {$\langle 2,1\rangle$};
\draw (-1,-2) node [left] {$\langle 2,1\rangle$} -- (0,0);
\draw (4,0) -- (5,-2) node [right] {$1$};
\node at (1.5, -5) {$d^{(s)}_\pm = \colorboxed{red}{c^\pm_1}\, \colorboxed{red}{B_{1^\pm}}\, \colorboxed{red}{c^\pm_1}  $};
\draw[dashed, ->, red] (1,-4) to [out=90, in=-70] (.2, -.3);
\draw[dashed, ->, red] (5,-4) to [out=90, in=-110] (3.8, -.3);
\draw[dashed, ->, red] (3,-4.1) to [out=90, in=-90] (2, -.3);
\end{tikzpicture} 
\quad
\begin{tikzpicture}[baseline=(base), very thick, scale = .4]
\coordinate (base) at (0, -4);
\draw (-2,5) node [left] {$1$} -- (0,4) -- node [left] {$3^\pm$} (0,0) -- (-2,-1) node [left] {$\langle 2,1\rangle$};
\draw (2, 5) node [right] {$2$} -- (0,4);
\draw (0,0) -- (2,-1) node [right] {$3$};
\node at (0, -4) {$d^{(t)}_\pm = \colorboxed{red}{(-)^{s_3}c_3^\pm}\, \colorboxed{red}{C_{123^\pm}}  $};
\draw[dashed, ->, red] (0,-2.9) to [out=90, in=-70] (0, -.4);
\draw[dashed, ->, red] (3,-3) to [out=50, in=-30] (.4, 3.8);
\end{tikzpicture} 
\label{cs}
\end{align}
Notice that the OPEs $V^d_{\langle 2,1\rangle}V_3$ and $V_3V^d_{\langle 2,1\rangle}$ are related by a permutation, under which the OPE structure constant picks a factor $(-)^{S_3-S_{3^\pm}} = (-)^{s_3}$, according to Eq. \eqref{b21}. This explains the sign factor in $d^{(t)}_\pm$. In the case of the 4-point function $\left<V_{\langle 2,1\rangle}^d V_iV_{\langle 2,1\rangle}^d V_i\right>$, Eq. \eqref{cs} gives us $\frac{d^{(s)}_-}{d^{(s)}_+}=\frac{(c_i^-)^2}{(c_i^+)^2} \frac{B_{i^-}}{B_{i^+}}$. Using Eq. \eqref{cbcb} for eliminating the 2-point structure constants, we obtain the relation
\begin{align}
 \frac{d^{(s)}_-}{d^{(s)}_+}= (-)^{2s_i}\frac{c_i^-}{c_{i^+}^-} \frac{c_{i^-}^+}{c_i^+}\ ,  
 \label{ddcccc}
\end{align}
whose left-hand side is explicitly known by Eq. \eqref{ddb}.

If we want to determine $B_i,C_{ijk}$, what do we do with $c^\pm_i$? In the bootstrap approach, we are free to perform \textbf{field renormalizations} using arbitrary constant coefficients $\lambda_i$,
\begin{align}
 V_i(z) \to \lambda_i V_i(z)\quad \implies \quad B_i \to \lambda_i^2B_i \ , \ C_{ijk}\to \lambda_i\lambda_j\lambda_k C_{ijk}\ .
 \label{vlv}
\end{align}
For a quantity to be meaningful, it must be invariant under field renormalizations. And invariant combinations of structure constants do not involve $c_i^\pm$. For example, the $s$-channel 4-point structure constant $D^{(s)}_k = \frac{C_{12k}C_{k34}}{B_k}$ is invariant under renormalization of the channel field $V_k$, and $D^{(s)}_{k^+}$ is a combination of degenerate 4-point structure constants \eqref{cs}, such that the contributions of $c_k^+$ cancel. 
It is however not practical to only work with renormalization-invariant combinations of structure constants. In particular, the invariant $\frac{C_{123}}{\sqrt{B_1B_2B_3}}$ involves a square root, and suffers from the corresponding sign ambiguity. Instead, we propose
\begin{align}
 c^+_i = \beta^{2\beta(P_i+\bar P_i)} \frac{\Gamma(-2\beta P_i)}{\Gamma(1+2\beta \bar P_i)} \quad , \quad c^-_i = \beta^{-2\beta(P_i+\bar P_i)} \frac{\Gamma(2\beta P_i)}{\Gamma(1-2\beta \bar P_i)}\ ,
 \label{cpcm}
\end{align}
This obeys the reflection relation \eqref{cim}. This also obeys Eq. \eqref{ddcccc}, thanks to $s_i=\beta(\bar P_i-P_i) \in \frac12\mathbb{Z}$. The existence and uniqueness of $c_i^\pm$ are subtle issues: in particular, in a CFT with two degenerate fields $V^d_{\langle 2,1\rangle}$ and $V^d_{\langle 1,2\rangle}$, the degenerate OPE coefficients for the two fields are related. (See \cite[Exercise 3.2]{rib14} for the case of Liouville theory.) Our determination of $c_i^\pm$ will be validated by the existence of solutions of the shift equations for $B_i,C_{ijk}$. 


\subsubsection{Explicit shift equations}

Combining the crossing symmetry equation \eqref{dmdp}, and \eqref{ddb} with the determination \eqref{cs} of degenerate 4pt structure constants and the choice \eqref{cpcm} of degenerate OPE structure constants, we obtain
\begin{align}
 \boxed{\frac{C_{1^-23}}{C_{1^+23}} = 
 (-)^{2s_2}\beta^{4\beta (P_1+\bar P_1)} \frac{\prod_{\pm,\pm}\Gamma\left(\tfrac12 -\beta\bar P_1\pm\beta \bar P_2\pm\beta \bar P_3)\right)}{\prod_{\pm,\pm}
 \Gamma\left(\tfrac12 +\beta P_1\pm \beta P_2\pm\beta P_3)\right)}} \ ,
 \label{sh-mp}
\end{align}
\begin{align}
\boxed{\frac{B_{1^-}}{B_{1^+}} =
\beta^{8\beta (P_1+\bar P_1)} 
 \frac{\Gamma(-2\beta P_1)}{\Gamma(2\beta P_1)} \frac{\Gamma(1-2\beta \bar P_1)}{\Gamma(1+2\beta \bar P_1)}
 \frac{\Gamma\left(\beta^2-2\beta P_1\right)\Gamma\left(1-\beta^2-2\beta P_1\right)}{\Gamma\left(\beta^2+2\beta \bar P_1\right)\Gamma\left(1-\beta^2+2\beta \bar P_1\right)}}\ .
 \label{sh-b}
\end{align}
These are called \textbf{shift equations}, because they determine how structure constants behave when the momentums $P_1,\bar P_1$ of fields are shifted by $\beta$, under the condition $s_i\in \frac12 \mathbb{Z}$ \eqref{ssiz}. If $s_i\in\mathbb{Z}$, then not only $S_{i^-}-S_{i^+}\in\mathbb{Z}$ but also $S_{i}-S_{i^+}\in\mathbb{Z}$, and we also have more refined shift equations: an equation for the 3-point structure constant, deduced from Eq. \eqref{dpdp},
\begin{align}
 \boxed{\frac{C_{123^+}}{C_{1^+23}} = 
 (-)^{s_3} \beta^{2\beta(P_1+\bar P_1-P_3-\bar P_3)}
 \frac{ \prod_\pm\Gamma\left(\frac12 -\beta\bar P_1 \pm \beta\bar P_2 +\beta\bar P_3\right)}{ \prod_\pm\Gamma\left(\frac12+\beta P_1 \pm \beta P_2 -\beta P_3\right)}}\ ,
 \label{sh-pp}
\end{align}
and an equation for the 2-point structure constant, deduced from Eq. \eqref{cbcb}:
\begin{align}
 \boxed{\frac{B_1}{B_{1^+}} =  (-)^{s_1}\beta^{4\beta (P_1+\bar P_1)+2\beta^2}\frac{\Gamma(-2\beta P_1)}{\Gamma(1+2\beta \bar P_1)}\frac{\Gamma(1-\beta^2-2\beta\bar P_1)}{\Gamma(\beta^2+2\beta P_1)} }\ .
 \label{sh-bb}
\end{align}
In Liouville theory with $c\notin (-\infty,1]$ and in non-diagonal CFTs with 2 degenerate fields, we will have to use slighly modified shift equations, obtained by choosing slighly different degenerate OPE structure constants $c_i^\pm$, which is made possible by relaxing the reflection relation. 

\subsection{Solutions of shift equations}\label{sec:essc}

Since shift equations produce Gamma functions, their solutions should be written in terms of \textbf{Barnes' double Gamma function} $\Gamma_\beta$, which obeys
\begin{align}
\frac{\Gamma_\beta(x+\beta)}{\Gamma_\beta(x)} = \sqrt{2\pi}\frac{\beta^{\beta x-\frac12}}{\Gamma(\beta x)}
\quad , \quad 
\frac{\Gamma_\beta(x+\beta^{-1})}{\Gamma_\beta(x)} = \sqrt{2\pi}\frac{\beta^{\frac12-\beta^{-1}x}}{\Gamma(\beta^{-1}x)} \ .
\label{gshift}
\end{align}
The double Gamma function also obeys $\Gamma_\beta(x)= \Gamma_{\beta^{-1}}(x)$. It is a meromorphic function of $x\in\mathbb{C}$, with simple poles for $x\in -\beta\mathbb{N}-\beta^{-1}\mathbb{N}$ and no zeros. It is also a meromorphic function of $\beta\in \mathbb{C}\backslash i\mathbb{R}$. We will often use the following consequence of Eq. \eqref{gshift}:
\begin{align}
 \frac{\prod_\pm \Gamma_\beta\left(x \pm (y-\frac{\beta}{2})\right)}{\prod_\pm \Gamma_\beta\left(x \pm (y+\frac{\beta}{2})\right)} = \beta^{-2\beta y}\frac{\Gamma\left(\beta x+\beta y - \frac12 \beta^2\right)}{\Gamma\left(\beta x-\beta y -\frac12 \beta^2\right)}\ . 
\end{align}


\subsubsection{Diagonal CFTs with 2 degenerate fields}

Let us start with Liouville theory for $c\in (-\infty ,1]$ i.e. $\beta^2\in\mathbb{R}_{>0}$. 
We assume that the structure constants are meromorphic functions of the momentums, and continuous functions of $\beta$. 
The shift equations determine the structure constants $B_{P_1},C_{P_1,P_2,P_3}$ modulo a factor that is invariant under $P_i\to P_i+\beta$ and $P_i\to P_i+\beta^{-1}$. 
If $\beta^2\notin \mathbb{Q}$, this factor must be constant on the complex $P_i$-plane. By continuity in $\beta$, the structure constants are unique on $c\in (-\infty,1]$ modulo an unimportant $P_i$-independent factor. The unique solutions for $B_{P_1}$ and $C_{P_1,P_2,P_3}$ turn out to be holomorphic functions of $P_i\in\mathbb{C}$ and $\beta\in \mathbb{C}\backslash i\mathbb{R}$:
\begin{align}
 \boxed{B_{P_1} = \prod_{\pm,\pm}\Gamma_\beta^{-1}\left(\beta^{\pm 1}\pm 2P_1\right)} \ \  , \ \ \boxed{C_{P_1,P_2,P_3} =\prod_{\pm,\pm,\pm} \Gamma_\beta^{-1}\left(\tfrac{\beta+\beta^{-1}}{2} \pm P_1\pm P_2\pm P_3\right)}\ . 
 \label{bc}
\end{align}
These expressions indeed obey the shift equations \eqref{sh-mp}-\eqref{sh-bb} with $s_i=0$ and $P_i=\bar P_i$.
They are invariant under $P_i\to -P_i$, i.e. they obey the reflection relation \eqref{refl}.
And they are invariant under $\beta \to \beta^{-1}$, so they also obey the shift equations from $V^d_{\langle 1,2\rangle}$. 
Remarkably, the 2-point and 3-point functions can be analytically continued beyond the half-line $c\in (-\infty ,1]$, while $n$-point functions with $n\geq 4$ cannot, as follows from our discussion of the OPE in Section \ref{sec:liou}. 

The expressions \eqref{bc} for 2-point and 3-point structure constants are also valid in generalized minimal models, and in A-series minimal models. In such models, solutions of shift equations are unique, up to a field-independent factor. In the case of the 2-point structure constant $B_{P_{(r,s)}}$, this is because the Kac indices $r,s$ are integer, and Eq. \eqref{sh-bb} governs how $B_{P_{(r,s)}}$ changes under $r\to r+1$. In the case of the 3-point structure constant $C_{P_{(r_1,s_1)},P_{(r_2,s_2)},P_{(r_3,s_3)}}$, our shift equations \eqref{sh-mp} and \eqref{sh-pp}, together with the invariance under permutations of the 3 fields, determine all integer shifts that preserve $r_1+r_2+r_3\bmod 2$. But the fusion rules \eqref{rrsr} imply that the 3-point structure constant exists only if $r_1+r_2+r_3\equiv 1\bmod 2$, and can therefore be deduced from $C_{P_{(1,1)},P_{(1,1)},P_{(1,1)}}$ using shift equations. This implies in particular that the double Gamma functions can be replaced with products of Gamma functions. (See \cite[Section 3.2.1]{rib14} for explicit expressions.) This makes the 3-point structure constants well-defined for any $\beta\in \mathbb{C}^*$, including in the regime $\beta\in i\mathbb{R}$ where $\Gamma_\beta$ is not defined.

In (generalized) minimal models, the structure constants are always non-vanishing, even though the function $\Gamma_\beta^{-1}$ has zeros. For the 3-point structure constant, this is again because of the fusion rules. 
The factor $\Gamma_\beta^{-1}\left(\frac{1+\sum_i\epsilon_ir_i}{2}\beta + \frac{1-\sum_i \epsilon_is_i}{2}\beta^{-1}\right)$ (with $\epsilon_i\in \{+,-\}$) of $C_{P_{(r_1,s_1)},P_{(r_2,s_2)},P_{(r_3,s_3)}}$ would indeed vanish if the 2 integers $\frac{1+\sum_i\epsilon_ir_i}{2}$ and $\frac{1-\sum_i \epsilon_is_i}{2}$ were both negative, but the fusion rules imply that the 3 integers $\sum_i\epsilon_i,\sum_i\epsilon_ir_i,\sum_i\epsilon_is_i$ all have the same (nonzero) sign. Conversely, if the fusion rules are violated, then $C_{P_{(r_1,s_1)},P_{(r_2,s_2)},P_{(r_3,s_3)}}$ vanishes in some cases, but not in some others. This has been a source of puzzlement \cite{zam05}. In the bootstrap approach, there is no puzzle, because structure constants make sense only provided fusion rules are obeyed. 

We have chosen normalizations such that the structure constants \eqref{bc} have simple expressions, and are holomorphic functions of $\beta,P_i$. In (generalized) minimal models, it is common to choose normalizations such that $V^d_{\langle 1,1\rangle}$ is the identity field, and such that 2-point functions are trivial. Calling $\widetilde{B}_{\langle r_1,s_1\rangle},\widetilde{C}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle \langle r_3,s_3\rangle}$ the corresponding structure constants, these conditions amount to 
\begin{align}
 \widetilde{B}_{\langle r_1,s_1\rangle} = \widetilde{C}_{\langle 1,1\rangle\langle r_2,s_2\rangle \langle r_2,s_2\rangle} = 1\ .
\end{align}
Such normalizations exists, thanks to the identity 
\begin{align}
 \frac{C_{P_{(1,1)}, P, P}}{B_P} = \text{constant}\ . 
\end{align}
Our conditions are therefore fulfilled by 
\begin{align}
 \widetilde{C}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle \langle r_3,s_3\rangle} 
 = \frac{C_{P_{(r_1,s_1)},P_{(r_2,s_2)},P_{(r_3,s_3)}}}{C_{P_{(1,1)},P_{(1,1)},P_{(1,1)}}}
 \frac{B_{P_{(1,1)}}^\frac32}
 {\sqrt{B_{P_{(r_1,s_1)}}B_{P_{(r_2,s_2)}} B_{P_{(r_3,s_3)}}}}\ .
 \label{wtc}
\end{align}
For example, in the Ising minimal model at $\beta^2=\frac34$, the nontrivial structure constant is $\widetilde{C}_{\langle 2,1\rangle\langle 2,1\rangle\langle 1,2\rangle}=\frac12$. In this case, the double Gamma functions not only combine into Gamma functions, but further simplify into a rational number. 

Finally, let us focus on Liouville theory with $c\in \mathbb{C}\backslash (-\infty,1]$. This includes the half-line $c\in [25,\infty)$ i.e. $\beta\in i\mathbb{R}^*$, where the function $\Gamma_\beta$ is not defined.
Instead, we should use the function $\hat{\Gamma}_\beta(x) = \frac{1}{\Gamma_{i\beta}(i\beta -ix)}$, which obeys shift equations that are very similar to the equations \eqref{gshift} for $\Gamma_\beta(x)$: 
\begin{align}
 \frac{\hat\Gamma_\beta(x+\beta)}{\hat\Gamma_\beta(x)} = \sqrt{2\pi}\frac{(i\beta)^{\beta x-\frac12}}{\Gamma(\beta x)}
\quad , \quad 
\frac{\hat\Gamma_\beta(x+\beta^{-1})}{\hat\Gamma_\beta(x)} = \sqrt{2\pi}(i\beta)^{\frac12-\beta^{-1}x}\Gamma(1-\beta^{-1}x) \ .
\label{hgshift}
\end{align}
Since we now have powers of $i\beta$ instead of $\beta$, we need to slightly modify the degenerate OPE structure constants \eqref{cpcm}, for example $c_i^+ = \beta^{4\beta P_i}\frac{\Gamma(-2\beta P_i)}{\Gamma(1+2\beta P_i)} \to (i\beta)^{4\beta P_i}\frac{\Gamma(-2\beta P_i)}{\Gamma(1+2\beta P_i)}$. The shift equations for structure constants \eqref{sh-mp}-\eqref{sh-bb} are similarly modified. Their solutions $\hat B_{P_1},\hat C_{P_1,P_2,P_3}$ are obtained from $B_{P_1},C_{P_1,P_2,P_3}$ \eqref{bc} by $\Gamma_\beta \to \hat\Gamma_\beta$. Explicitly,
\begin{align}
 \boxed{\hat B_{P_1} = \prod_\pm \Gamma_b\left(\pm 2iP_1\right)\Gamma_b\left(Q\pm 2iP_1\right)} \quad , \quad 
 \boxed{\hat C_{P_1,P_2,P_3} = \prod_{\pm,\pm,\pm} \Gamma_b\left(\tfrac{Q}{2} \pm iP_1\pm iP_2\pm iP_3\right)}\ ,
 \label{bci}
\end{align}
where we use the notations 
\begin{align}
 b = i\beta \quad , \quad Q = b + b^{-1} \ . 
 \label{bQ}
\end{align}
By a field renormalization \eqref{vlv}, the 2-point and 3-point structure constants become 
\begin{align}
 \hat B^\text{DOZZ}_{P_1} = \frac{\Gamma_b\left(- 2iP_1\right)\Gamma_b\left(Q+ 2iP_1\right)}{\Gamma_b\left( 2iP_1\right)\Gamma_b\left(Q- 2iP_1\right)} \quad , \quad 
 \hat C^\text{DOZZ}_{P_1,P_2,P_3} = \frac{\prod_{\pm,\pm,\pm} \Gamma_b\left(\tfrac{Q}{2} \pm iP_1\pm iP_2\pm iP_3\right)}{\prod_{k=1}^3 \Gamma_b(2iP_k)\Gamma_b(Q-2iP_k)}\ ,
 \label{dozz}
\end{align}
which are the expressions found by Dorn--Otto and Zamolodchikov--Zamolodchikov when first solving Liouville theory: in particular, their formula for the 3-point structure constant is called the \textbf{DOZZ formula}. In this normalization, the 2-point structure constant coincides with the reflection coefficient, i.e. it obeys the relations 
\begin{align}
 \hat B^\text{DOZZ}_{P_1}\hat B^\text{DOZZ}_{-P_1}=1 \quad , \quad  \hat C^\text{DOZZ}_{P_1,P_2,P_3} = \hat B^\text{DOZZ}_{P_1}\hat C^\text{DOZZ}_{-P_1,P_2,P_3} \quad , \quad V_{P_1} = \hat B^\text{DOZZ}_{P_1} V_{-P_1}\ . 
\end{align}
A remarkable property of Liouville theory in the DOZZ normalization is that degenerate fields are limits of non-degenerate fields,
\begin{align}
 \lim_{P\to P_{(r,s)}} V_P = V^d_{\langle r,s\rangle} \ .
 \label{limvp}
\end{align}
This relation is natural in the path integral construction of Liouville theory \cite{zz95}, but not necessarily in the bootstrap approach: it is not true in Liouville theory with $c\in (-\infty, 1]$, and for $c\in\mathbb{C}\backslash (-\infty,1]$ it requires a particular normalization. It is thanks to this relation that generalized minimal models can be obtained as limits of Liouville theory, as announced in Section \ref{sec:lod}. This relation follows from the analytic properties of the structure constants, as we will now show in the case $(r,s)=(1,1)$. (See \cite[Section 3.1.5]{rib14} for the general case $r,s\in\mathbb{N}^*$.) Since $2iP_{(1,1)}=Q$ and $\Gamma_b(x)$ has a pole at $x=0$, we have $\hat C^\text{DOZZ}_{P_{(1,1)},P_2,P_3} = 0$ and it may seem that $\lim_{P_1\to P_{(1,1)}} V_{P_1} = 0$. However, it is not so easy to take the limit of the OPE 
\begin{align}
V_{P_1}V_{P_2} \sim \frac12 \int_{\mathbb{R}}dP\ \frac{\hat C^\text{DOZZ}_{P_1,P_2,P}}{\hat B^\text{DOZZ}_{P}}V_P\ , 
\end{align}
because of the poles of $\hat C^\text{DOZZ}_{P_1,P_2,P}$. In particular, each factor $\Gamma_b(\frac{Q}{2}-iP_1\pm (iP_2-iP))$ has a pole at $P= P_2\pm (P_{(1,1)}-P_1)$. In the limit $P_1\to P_{(1,1)}$, these two poles coincide at $P=P_2$, with one pole coming from above the integration line and one from below. As a result, the limit of the integral is not zero: 
\begin{align}
 \lim_{P_1\to P_{(1,1)}}V_{P_1}V_{P_2} \sim \lim_{P_1\to P_{(1,1)}}  \underset{P=P_1+P_2-P_{(1,1)}}{\operatorname{Res}}\frac{\hat C^\text{DOZZ}_{P_1,P_2,P}}{\hat B^\text{DOZZ}_{P}}V_P=V_{P_2}\ ,
\end{align}
which implies Eq. \eqref{limvp} in the case $(r,s)=(1,1)$. 

\subsubsection{Non-diagonal CFTs with 2 degenerate fields}

Let us start with the 2-point structure constants, which can be straightforwardly determined by solving shift equations. For diagonal fields, the same expression $B_{P_1}$ \eqref{bc} as in $c\leq 1$ Liouville theory is still valid. For non-diagonal fields $V_{(r,s)}$ with $r\in 2\mathbb{Z}$ and $s\in\mathbb{Z}+\frac12$, we find 
\begin{align}
 \boxed{B_{(r,s)} = (-)^\frac{r}{2} \prod_\pm \Gamma_\beta^{-1}\left(\beta\pm 2P\right)\Gamma_\beta^{-1}\left(\beta^{-1}\pm 2\bar P\right)}\ ,
 \label{nbrs}
\end{align}
with $\{P,\bar P\}=\{P_{(r,s)},P_{(r,-s)}\}$. (The formula is invariant under $P\leftrightarrow \bar P$.)
The sign prefactor is needed for obeying the $r\to r+2$ shift equation \eqref{sh-b}. When it comes to the second Kac index, $B_{(r,s)}$ obeys
\begin{align}
 \frac{B_{(r,s)}}{B_{(r,s+1)}} = \beta^{-4\beta^{-1}(P+\bar P)-2\beta^{-2}} \frac{\Gamma(-2\beta^{-1}P)}{\Gamma(1+2\beta^{-1}\bar P)} \frac{\Gamma(1-\beta^{-2}-2\beta^{-1}\bar P)}{\Gamma(\beta^{-2}+2\beta^{-1} P)} \ ,
\end{align}
with $(P, \bar P)=(P_{(r,-s)},-P_{(r,s)})$, so that the shift $s\to s+1$ corresponds to $(P,\bar P)\to (P+\frac{\beta^{-1}}{2},\bar P+\frac{\beta^{-1}}{2})$. This agrees with the shift equation \eqref{sh-bb}, after the transformation $\beta \to \beta^{-1}$. 

Let us move to 3-point structure constants. Due to the conservation of diagonality \eqref{ddd}, there are only two cases, with either $0$ or $2$ of the $3$ fields being non-diagonal. Let us begin with the latter case. We introduce the ansatz 
\begin{align}
 \boxed{C_{P_1,(r_2,s_2),(r_3,s_3)} = (-)^{\frac{r_3}{2}}\prod_{\pm,\pm}
 \Gamma_\beta^{-1}\left(\tfrac{\beta+\beta^{-1}}{2}+P_1 \pm P_2\pm P_3\right) 
 \Gamma_\beta^{-1}\left(\tfrac{\beta+\beta^{-1}}{2}-P_1 \pm \bar P_2\pm \bar P_3\right)}\ ,
 \label{cdnn}
\end{align}
whose sign prefactor ensures the correct behaviour under permutations \eqref{b21}. Moreover, we have the identities
\begin{align}
 \frac{C_{P_{(1,1)},(r,s),(r,s)}}{B_{(r,s)}} = \text{constant} \quad ,\quad 
 C_{P_1,(r_2,s_2),(r_3,s_3)}=C_{-P_1,(r_2,s_2),(r_3,s_3)} \ .
 \label{cpcmp}
\end{align}
The second identity is equivalent to the invariance of $C_{P_1,(r_2,s_2),(r_3,s_3)}$ under $(P_2,P_3)\leftrightarrow (\bar P_2,\bar P_3)$. To prove it, we notice that it can be rewritten in terms of the \textbf{double Sine function}
\begin{align}
 S_\beta(x) = \frac{\Gamma_\beta(x)}{\Gamma_\beta(\beta + \beta^{-1}-x)}\quad \implies \quad \frac{S_\beta(x+\beta)}{S_\beta(x)} = 2\sin(\pi\beta x)\ .
 \label{sb}
\end{align}
The double Sine function obeys the identity 
\begin{align}
 r,s\in\mathbb{Z} \implies \frac{\prod_\pm S_\beta\left(\frac{\beta+\beta^{-1}}{2} +P \pm P_{(r,s)}\right)}{\prod_\pm S_\beta\left(\frac{\beta+\beta^{-1}}{2} +P \pm P_{(r,-s)}\right)} =(-)^{rs}\ .
 \label{dsr}
\end{align}
Applying this to $P=P_1$ and $(r,s)=(r_2\pm r_3,s_2\pm s_3)$, we obtain the second identity in Eq. \eqref{cpcmp}.

Having worked out the basic properties of our ansatz \eqref{cdnn}, let us check whether it obeys the shift equations. The spectrum \eqref{sdmm} of D-series minimal models is invariant under $s\to s+1$, both in the diagonal and non-diagonal sectors. Therefore, when it comes to the shifts from $V^d_{\langle 1,2\rangle}$, we have to check the two shift equations \eqref{sh-mp} and \eqref{sh-pp} with $\beta\to\beta^{-1}$ and $r_i\leftrightarrow s_i$, where the shifted fields may be diagonal or non-diagonal. This is straightforward, if we remember $r_2,r_3\in 2\mathbb{Z}$, leading to trivial sign factors $(-)^{r_i}=1$. We will now deal with the subtler case of the shifts from $V^d_{\langle 2,1\rangle}$. The spectrum of D-series minimal models is invariant under $r\to r+2$ but not $r\to r+1$, so we only have to deal with the shift equation \eqref{sh-mp}. If we shift a non-diagonal field, our ansatz \eqref{cdnn} behaves as 
\begin{align}
 \frac{C_{(r_1-1,s_1),(r_2,s_2),P_3}}{C_{(r_1+1,s_1),(r_2,s_2),P_3}} = - \beta^{4\beta(P_1+\bar P_1)}\frac{\prod_{\pm,\pm} \Gamma(\frac12-\beta \bar P_1\pm \beta\bar P_2\pm \beta P_3)}{\prod_{\pm,\pm} \Gamma(\frac12+\beta P_1\pm \beta P_2\pm \beta P_3)}\ , 
\end{align}
where the overall sign comes from $\prod_\pm \frac{\cos \pi\beta(P_1\pm P_2-P_3)}{\cos\pi\beta(\bar P_1\pm \bar P_2-P_3)} = \prod_\pm (-1)^{s_1\pm s_2} = -1$. This agrees with Eq. \eqref{sh-mp} with $\bar P_3=P_3$ and $(-)^{2s_2}=-1$. If we now shift the diagonal field, our ansatz leads to 
\begin{align}
 \frac{C_{P_1-\frac{\beta}{2},(r_2,s_2),(r_3,s_3)}}{C_{P_1+\frac{\beta}{2},(r_2,s_2),(r_3,s_3)}} =\beta^{4\beta(P_1+\bar P_1)}\frac{\prod_{\pm,\pm} \Gamma(\frac12-\beta P_1\pm \beta\bar P_2\pm \beta \bar P_3)}{\prod_{\pm,\pm} \Gamma(\frac12+\beta P_1\pm \beta P_2\pm \beta P_3)}\ .
\end{align}
Now this ratio differs from Eq. \eqref{sh-mp} with $\bar P_1=P_1$ by an overall sign. Let us cancel this sign in D-series minimal models. Since diagonal fields are in fact degenerate, they can be labelled by Kac indices, and subjected to the field renormalization 
$V^d_{\langle r,s\rangle}\to (-)^{\frac{r+1}{2}} V^d_{\langle r,s\rangle}$. 
This renormalization flips the sign of Eq. \eqref{sh-mp}, while leaving the other shift equations unchanged. (Eq. \eqref{sh-bb} would be changed, but it does not make sense in a D-series minimal model.) As a result of this renormalization, we obtain a sign prefactor in the diagonal 3-point structure constant:
\begin{align}
 \boxed{C^\text{DMM}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle\langle r_3,s_3\rangle} = (-)^\frac{r_1+r_2+r_3+1}{2} C_{P_{(r_1,s_1)},P_{(r_2,s_2)},P_{(r_3,s_3)}}}\ , 
 \label{cdmm}
\end{align}
where $C_{P_1,P_2,P_3}$ is given in Eq. \eqref{bc}.

Now that we know the structure constants for D-series minimal models, let us deduce generalized D-series minimal models. As argued in Section \ref{sec:gdmm}, this amounts to taking the limit $P_{(r_1,s_1)}\to P_1\in\mathbb{R}$ in the diagonal sector. This is easily done in the cases of $B_{P_1}$ and $C_{P_1,(r_2,s_2),(r_3,s_3)}$, which are meromorphic functions of $P_1$, and are therefore valid in minimal models and in the limit. When it comes to the diagonal 3-point structure constant \eqref{cdmm}, the sign prefactor does not have a smooth limit, and the structure constant becomes a distribution in the limit \cite{rib19},
\begin{align}
 \boxed{C^\text{GDMM}_{P_1,P_2,P_3} = \beta C_{P_1,P_2,P_3}\sum_{n\in\mathbb{Z}}(-)^n \frac{\prod_{i=1}^3 \cos(2\pi n\beta P_i)}{\cos(\pi n\beta^2)}}\ .
 \label{cgdmm}
\end{align}
The sum over $n$ is divergent, but it converges when inserted in the $s$-channel decomposition of a correlation function with non-diagonal fields, for example $\left<V_{P_1}V_{P_2}V_{(r_3,s_3)}V_{(s_4,s_4)}\right>$. 

Without the field renormalization $V^d_{\langle r,s\rangle}\to (-)^{\frac{r+1}{2}} V^d_{\langle r,s\rangle}$, would we have obtained a smooth diagonal 3-point structure constant $C_{P_1,P_2,P_3}$, and a distribution in the non-diagonal sector? Of course not: renormalizations cannot make a difference. To see this, we may study the 4-point function $\left<V_{P_1}V_{P_2}V_{(r_3,s_3)}V_{(r_4,s_4)}\right>$ in the $s$-channel: whatever the normalization, the 4-point structure constant has a factor $C^\text{GDMM}_{P_1,P_2,P_s}$ in the limit. Our field renormalization only makes this clearer at the level of 3-point structure constants. 

\subsubsection{Loop CFTs}

In the loop CFTs' extended spectrum $\widetilde{S}^\text{loop}$ \eqref{sloop}, it is clear that shift equations do not determine the structure constants:
\begin{itemize}
 \item In the case of non-diagonal fields $V_{(r,s)}$, the dependence on $r$ is not constrained, because the spectrum $\widetilde{S}^\text{loop}$ does not include the degenerate field $V_{\langle 2,1\rangle}^d$. We only have $V^d_{\langle 1,2\rangle}$, whose shift equations determine how structure constants behave under $s\to s+2$, whereas $s$ takes fractional values.
 \item In the case of diagonal fields $V_P$, the shift equations from $V^d_{\langle 1,2\rangle}$ determine how structure constants behave under $P\to P+\beta^{-1}$. 
\end{itemize}
Let us nevertheless look for simple solutions of the shift equations. As an ansatz, we introduce the \textbf{reference structure constants} 
\begin{align}
\boxed{C^\text{ref}_{(r_1,s_1)(r_2,s_2)(r_3,s_3)} =\prod_{\epsilon_1,\epsilon_2,\epsilon_3=\pm} \Gamma_\beta^{-1} \left(\tfrac{\beta+\beta^{-1}}{2} + \tfrac{\beta}{2}\left|\textstyle{\sum_i} \epsilon_ir_i\right| + \tfrac{\beta^{-1}}{2}\textstyle{\sum_i} \epsilon_is_i\right)}\ .
 \label{cref}
\end{align}
This expression is also supposed to be valid if some of the fields are diagonal, via the identification $V_P = V_{(0,2\beta P)}$ \eqref{sP}. If all fields are diagonal, it reduces to $C_{P_1,P_2,P_3}$ \eqref{bc}. For reference 2-point structure constants of non-diagonal fields, we define 
\begin{align}
 \boxed{B^\text{ref}_{(r,s)} = \frac{(-)^{rs}}{2\sin\left(\pi(\{r\}+s)\right)\sin\left(\pi(r+\beta^{-2}s)\right)}\prod_{\pm,\pm}\Gamma_\beta^{-1}\left(\beta\pm \beta r \pm \beta^{-1}s\right)} \ ,
 \label{bref}
 \end{align}
 where $\{r\}\in\{0,\frac12\}$ is the fractional part of $r\in\frac12\mathbb{N}^*$. This is formally ill-defined if $r\in\mathbb{N}^*$ and $s\in\mathbb{Z}$, but can be regularized by taking a limit from generic values of $s$. We have $B^\text{ref}_{(0,2\beta P)} = \frac{1}{2\sin(2\pi\beta P)^2}B_P$, but we find it more convenient to set $B^\text{ref}_P = B_P$ for diagonal fields.

 The reference 2-point structure constant obeys the shift equation \eqref{sh-b}. Moreover, if $r\in \mathbb{N}^*$, we have
 \begin{align}
  \frac{B_{(r,s)}}{B_{(r,s+1)}} = (-)^r \beta^{-4\beta^{-2}s-2\beta^{-2}} \frac{\Gamma(-r-\beta^{-2}s)}{\Gamma(1-r+\beta^{-2}s)} \frac{\Gamma(1-\beta^{-2}+r-\beta^{-2}s)}{\Gamma(\beta^{-2}+r+\beta^{-2}s)}\ ,
 \end{align}
which obeys the shift equation \eqref{sh-bb} with $\beta\to\beta^{-1}$ and $(P_1,\bar P_1)=\left(P_{(r,-s)},-P_{(r,s)}\right)$. On the other hand, the reference 3-point structure constant only obeys the shift equations \eqref{sh-mp}, \eqref{sh-pp} and permutation equation \eqref{b21} up to signs. Let us define the normalized 3-point structure constant 
\begin{align}
 C^\text{norm} = \frac{C}{C^\text{ref}}\ , 
\end{align}
then the shift equations amount to \cite{nrj23}
\begin{align}
 \frac{C^\text{norm}_{(r_1,s_1+1)(r_2,s_2)(r_3,s_3)}}{C^\text{norm}_{(r_1,s_1-1)(r_2,s_2)(r_3,s_3)}} &\ =\  (-)^{2r_3}(-)^{\max(2r_1, 2r_2, 2r_3,r_1+r_2+r_3)} \ ,
 \label{tpt}
 \\
 \frac{C^\text{norm}_{(r_1,s_1+1)(r_2,s_2)(r_3,s_3)}}{C^\text{norm}_{(r_1,s_1)(r_2,s_2)(r_3,s_3+1)}} &\underset{r_i\in\mathbb{N}^*}{=} 
 \left\{\begin{array}{ll} (-)^{r_1+r_2} &\text{ if } r_2\geq |r_1-r_3|\ ,
                        \\ (-)^{r_3} &\text{ else}\ .
                       \end{array}\right. 
\label{tppt}
\end{align}
Let us focus in particular on diagonal fields. If $r_1=0$, then $r_2\equiv r_3\bmod\mathbb{Z}$, and Eq. \eqref{tpt} reduces to the invariance of $C^\text{norm}$ under $s_1\to s_1+2$. As a function of the momentum $P$ of a diagonal field, $C^\text{norm}$ is therefore periodic with period $\beta^{-1}$, and it is also even by reflection invariance \eqref{refl}. So it is a function of the \textbf{loop weight}
\begin{align}
 \boxed{w = 2\cos(2\pi\beta P)}\ .
 \label{wP}
\end{align}
There is a conjecture that $C^\text{norm}$ is in fact a polynom of loop weights, and that its dependence on the central charge is in fact polynomial in the \textbf{contractible loop weight}
\begin{align}
 \boxed{n= w\left(P_{(1,1)}\right) = -2\cos(\pi \beta^2)} \ .
 \label{ncb}
\end{align}
(This is the same $n$ as in the $O(n)$ CFT \eqref{nQ}.) In Section \ref{sec:cloop} we will formulate this conjecture in more detail. 

Even if the conjecture only applies to loop CFTs, it is interesting to compute the normalized 3-point structure constant associated to $C_{P_1,(r_2,s_2),(r_3,s_3)}$ \eqref{cdnn} from (generalized) D-series minimal models:
\begin{align}
 C^\text{norm}_{P_1,(r_2,s_2),(r_3,s_3)} = (-)^{\frac{r_3}{2}}(-)^{\frac{s_2+s_3}{2}} \prod_\pm \prod_{j=-\frac{|r_2\pm r_3|-1}{2}}^{\frac{|r_2\pm r_3|-1}{2}} 2\cos \pi(\beta P_1+\beta^2j) \ ,
\end{align}
where the product over $j$ runs by steps of $1$. Since $r_2,r_3\in\mathbb{Z}+\frac12$, there is one $j=0$ factor, which is $2\cos(\pi \beta P_1)$. The rest of the product can be written in terms of 
\begin{align}
 4\cos \pi(\beta P_1+\beta^2j)\cos \pi(\beta P_1-\beta^2j) = 2\cos(2\pi\beta P_1)+2\cos(2\pi \beta^2j)\ , 
\end{align}
which for $j\in\frac12\mathbb{Z}^*$ is polynomial in loop weights. 

\subsubsection{Summary table}\label{sec:table}

Let us summarize the solutions of shift equations for 2-point and 3-point structure constants. For each solution we indicate to which models it applies. Lighter green means an alternative field normalization. In the models' names, ``(G)MM'' means A-series minimal models and generalized minimal models, and ``Liou'' means Liouville theory. 
\begin{center}
\begin{tabular}{|l|c|c|c|c|c|c|c|c|}
\hline 
 Constants & Eqs. & (G)MM & Liou$_{c\leq 1}$ & RWT & Liou & DMM & GDMM & Loop 
 \\
 \hline
  $B_{P_1}$ & \eqref{bc} & \cellcolor{green} & \cellcolor{green} & \cellcolor{green} &  & \cellcolor{green} & \cellcolor{green} & \cellcolor{green} 
  \\
  \hline 
  $C_{P_1,P_2,P_3}$& \eqref{bc} & \cellcolor{green} & \cellcolor{green} & \cellcolor{green} &  &  &  & \cellcolor{green} 
  \\
  \hline 
  $\widetilde{C}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle\langle r_3,s_3\rangle}$ & \eqref{wtc} & \cellcolor{green!20} & & & & & & 
  \\
  \hline 
  $\hat{B}_{P_1},\hat{C}_{P_1,P_2,P_3}$ &  \eqref{bci} & & & & \cellcolor{green} & & & 
  \\
  \hline 
  $\hat{B}^\text{DOZZ}_{P_1},\hat{C}^\text{DOZZ}_{P_1,P_2,P_3}$ & \eqref{dozz} & & & & \cellcolor{green!20} & & &
  \\
  \hline 
  $B_{(r,s)}$ & \eqref{nbrs} & & & & & \cellcolor{green} & \cellcolor{green} & 
  \\
  \hline 
  $C_{P_1,(r_2,s_2),(r_3,s_3)}$ & \eqref{cdnn} & & & & & \cellcolor{green} & \cellcolor{green} & 
  \\
  \hline 
  $C^\text{DMM}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle\langle r_3,s_3\rangle}$ & \eqref{cdmm} &
  & & & & \cellcolor{green} & & 
  \\
  \hline 
  $C^\text{GDMM}_{\langle r_1,s_1\rangle\langle r_2,s_2\rangle\langle r_3,s_3\rangle}$ & \eqref{cgdmm} &
  & & & & & \cellcolor{green} & 
  \\
  \hline 
  $B^\text{ref}_{(r,s)}$ & \eqref{bref} & & & & & & & \cellcolor{green}
  \\
  \hline 
  $C^\text{ref}_{(r_1,s_1)(r_2,s_2)(r_3,s_3)}$ & \eqref{cref} & & & & & & & \cellcolor{green}
  \\
  \hline 
\end{tabular}
\end{center}

% Reproduce all the formulas here? 

\section{Numerical bootstrap}

In the analytic bootstrap approach of Section \ref{sec:ab}, we have used the crossing symmetry of 4-point functions that include degenerate fields, and deduced constraints on 2-point and 3-point structure constants. However, in a consistent CFT, arbitrary 4-point functions must be crossing symmetric. In the absence of degenerate fields, crossing symmetry equations involve infinite sums and are hard to deal with analytically. We will thus need to solve them numerically. This will not prevent us from deducing exact results for structure constants. 

\subsection{Approaches to crossing symmetry}

\subsubsection{Achievements and limitations of analytic approaches}

It is not easy to directly evaluate the crossing symmetry equations \eqref{seteu}: conformal blocks are complicated, and their sums are even more complicated. Another approach is to construct 4-point functions in channel-independent ways, and then show that they can be decomposed into conformal blocks. This has led to analytic proofs of crossing symmetry in CFTs that can be constructed by perturbing a free bosonic CFT: 
\begin{itemize}
 \item In A-series minimal models, 4-point functions can be constructed as Coulomb gas integrals \cite{df84}.
 \item In Liouville theory with $c\geq 25$, 4-point functions can be constructed from chiral vertex operators \cite{tes03b}.
 \item Again in Liouville theory with $c\geq 25$, 4-point functions can be constructed as expectation values in a probabilistic Gaussian free field theory \cite{ckrv05}. 
\end{itemize}
From these cases, all diagonal CFTs with 2 degenerate fields can be obtained by analytic continuation and taking limits \eqref{lims}, although mathematical rigor is lost in the process. In particular, the probabilistic construction only makes sense for $c\geq 25$. 

In this text we will focus on a numerical approach to crossing symmetry, based on directly computing 4-point functions. This approach is applicable to any CFT whose spectrum is exactly known, and therefore to all the exactly solvable CFTs that we have considered. 


\subsubsection{Various flavours of numerics}\label{sec:vfn}

We consider a 4-point function $\left<V_1V_2V_3V_4\right>$, where the 4 primary fields are characterized by their conformal dimensions.
We assume that we exactly know the spectrum in each channel. If we do not know the structure constants, we view crossing symmetry as a system of linear equations \eqref{seteu} for the 4-point structure constants, normalized by the condition $D_{k_0}^{(s)}=1$. 

In the following diagram, we sketch what we can learn from numerically solving crossing symmetry, and give examples from exactly solvable CFTs. Potts connectivities are 4-point functions of the type $\Big<V_{P_{(0,\frac12)}}^4\Big>$, which have been an important testing ground for numerical bootstrap techniques. 
\begin{center}
 \begin{tikzpicture}[baseline=(base), scale = .5]
% \coordinate (base) at (0, -4);
\node [right] at (7.5, -15) {$\bullet$ Potts connectivities \cite{nr20}, loop CFTs \cite{rib22, nrj23}};
 \node [right] at (7.5, -14) {Compute 4-point structure constants};
\draw [ultra thick, -latex] (4.5, -6) -- (4.5, -14) -- (7.5, -14);
 \node [right] at (7.5, -12.5) {$\bullet$ Potts connectivities \cite{prs16, prs19}};
 \node [right] at (7.5, -11.5) {Compute 4-point function};
 \draw [ultra thick, -latex] (4.5, -6) -- (4.5, -11.5) -- (7.5, -11.5);
\node [right] at (4.5, -8) {Yes};
  \node [right] at (7.5, -10) {$\bullet$ Potts connectivities \cite{hjs20, nr20}};
 \node [right] at (7.5, -9) {Correct spectrum!};
 \draw [ultra thick, -latex] (4.5, -6) -- (4.5, -9) -- (7.5, -9);
 \node [right] at (11, -7) {$\bullet$ $O(n)$ CFT \cite{gnjrs21}, Potts CFT \cite{niv22}, loop CFTs \cite{gjnrs23}};
 \node [right] at (11, -6) {Determine the dimension of the space of solutions};
 \draw [ultra thick, -latex] (8.8, -6) -- node[above]{No} (11, -6);
\draw (0, -6) node[right, draw, fill = red!10] {Is the solution unique?};
 \draw [ultra thick, -latex] (4.5, -3.6) -- node[right]{Yes} (4.5, -5.3);
 \draw (18, -3) node[right] {Wrong spectrum!};
\draw [ultra thick, -latex] (15.4, -3) -- node[above]{No} (18, -3);
\draw [ultra thick, -latex] (4.5, -.6) -- node[right]{No} (4.5, -2.3);
\draw (0, -3) node[right, draw, fill = red!10] {Does crossing symmetry have a solution?};
\draw (14.5, 0) node[right] {Check crossing symmetry};
\draw (14.5, -1) node[right] {$\bullet$ Liouville \cite{zz95, rs15}, RWT \cite{rs15}, GDMM${}_{c\leq 1}$ \cite{rib19}};
\draw [ultra thick, -latex] (12, 0) -- node[above]{Yes} (14.5, 0);
\draw (0, 0) node[right, draw, fill = red!10] {Are structure constants known?};
 \end{tikzpicture}
\end{center}


\subsubsection{Factorization of 4-point structure constants}

In order to solve a CFT, we should not only determine 4-point structure constants, but also factorize them into 2-point and 3-point structure constants. Factorization is simple enough if field multiplicities are trivial. However, there are nontrivial field multiplicities in D-series minimal models and in loop CFTs. 
This complicates factorization, because conformal blocks only depend on conformal dimensions. Solving the crossing symmetry equations \eqref{seteu} does not quite give us access to factorized 4-point structure constants $D^{(s)}_k = C^k_{12}C_{k34}$ \eqref{stu}, but to coefficients of conformal blocks:
\begin{align}
 D^{(s)}_{\Delta,\bar\Delta} = \sum_{k\in\mathcal{S}^{(s)}\left|\substack{\Delta_k=\Delta\\ \bar{\Delta}_k=\bar\Delta}\right.} C^k_{12}C_{k34} \ .
\end{align}
This is a sum of as many terms as the multiplicity of the primary field $V_{\Delta,\bar\Delta}$ in the $s$-channel spectrum $\mathcal{S}^{(s)}$. Therefore, factorization only constrains 4-point structure constants if we know field multiplicities. In principle, knowing the spectrum means knowing field multiplicities. In practice however, in loop CFTs, we know the spectrum of conformal dimensions without knowing the multiplicities. 

If the multiplicity $m(V_{\Delta,\bar\Delta})$ of $V_{\Delta,\bar\Delta}$ in the full spectrum is finite, it can in principle be determined from the values of $D^{(s)}_{\Delta,\bar\Delta}$ for all possible 4-point functions $\left<V_{k_1}V_{k_2}V_{k_3}V_{k_4}\right>$: 
\begin{align}
 m\left(V_{\Delta,\bar\Delta}\right) = \text{rank}\left(\left.D^{(s)}_{\Delta,\bar\Delta}\right|_{\left<V_{k_1}V_{k_2}V_{k_3}V_{k_4}\right>}\right)_{k_i\in\mathcal{S}}\ .
\end{align}
In principle it is impossible to compute the rank of an infinite matrix, but 
in practice it may be enough to study a few 4-point functions for guessing a given multiplicity. This has been done in a few examples of diagonal 4-point functions in loop CFTs \cite{rib22}.


\subsection{Virasoro conformal blocks and Zamolodchikov's recursion}

Derive the recursion for blocks? hard part is coef $R_{r,s}$ but it obeys simple shift equations. Rewrite it in terms of Upsilon functions, and somehow derive it from Liouville theory! But cancellation of double poles hard to argue? And need to determine sign, since we get square of $R_{r,s}$. We can choose any value of the continuous parameters including $c$, but is there a value that makes $R_{r,s}$ simple enough? And what about the $\Delta\to\infty$ prefactors? See Yin et al? See Appendix D of \cite{msz15} for the pillow geometry that underlies the variable $q$.

\subsection{Interchiral blocks} \label{sec:icb}

Notion of interchiral symmetry. Liouville 4pt is only one interchiral block? Same for MM, including non-diagonal. Distinguish double interchiral from simple interchiral, cf nb of deg. fields. 

\subsection{Linear equations for 4-point structure constants}

3 channels. 

Symmetries, relations between 4-point structure constants. 

Permutation symmetry: must assume that the fields are indeed the same, what if we have multiplicities? 

\subsection{Numerical implementation}

Choice of parameters: $c$

Truncating spectrum, blocks.

Random positions.

Deviations. Detection of solutions. Counting of solutions.


\section{Correlation functions in loop CFTs} \label{sec:cloop}

We will now take a short break from CFT, and build correlation functions as statistical sums over loop ensembles. This will motivate the introduction of combinatorial maps, which give rise to a basis of solutions of crossing symmetry. We can then forget about the statistical sums, which are not fundamental or universal quantities, while keeping the combinatorial maps, which are intrinsic features of the CFT.

\subsection{Statistical sums over loop ensembles}

\subsubsection{Sums over configurations of non-intersecting loops}

In statistical physics, loop models have correlation functions of the type
\begin{align}
 Z(\mathcal{E}) = \sum_{E\in\mathcal{E}} W(E)\ , 
\end{align}
where $\mathcal{E}$ is an ensemble of non-intersecting closed loops on the Riemann sphere $\overline{\mathbb{C}}$, and $W$ is a weight function. The easiest way to define $\mathcal{E}$ may be to discretize $\overline{\mathbb{C}}$, and draw the loops on the resulting graph: then the ensemble $\mathcal{E}$ is finite, and the number of loops per configuration $E$ is also finite: $|\mathcal{E}|, |E|<\infty$. 
However, we then have to show that $Z(\mathcal{E})$ has a well-defined limit when the graph size tends to infinity, and that conformal symmetry emerges in that limit. Alternatively, it is possible to define a conformal loop ensemble $\mathcal{E}$ without discretizing $\overline{\mathbb{C}}$, then $|\mathcal{E}|=|E|=\infty$. 
 
We will remain agnostic on the precise definition of $\mathcal{E}$, and only assume that numbers of loops are finite, $|E|<\infty$. We assume that the energy $\log W(E)$ is extensive: then the weight of a configuration is a product of weights of individual loops $w(\ell)$. On the sphere, all loops are topologically the same, and must all have the same weight by conformal symmetry: 
\begin{align}
 W(E) = \prod_{\ell \in E } w(\ell) = n^{|E|}\ ,
\end{align}
where $n$ is the \textbf{loop weight}. 


\subsubsection{Weight-changing punctures}

Our correlation function $Z(\mathcal{E})$ is the analog of a 0-point function in CFT. In order to have analogs of an $N$-point function, 
we introduce $N$ punctures on our sphere with positions $z_1,\dots, z_N$. 
Without violating conformal symmetry, we can let the weight of a loop depend on how the loop splits $\{z_1,\dots, z_N\}$ into two subsets, i.e. on the loop's combinatorial properties. It cannot however depend on the loop's topology in $\overline{\mathbb{C}}\backslash \{z_1,\dots, z_N\}$, because we want $Z(\mathcal{E})$ to be a single-valued function of $z_1,\dots, z_N$. For example, in the case $N=4$, the following two loops are topologically different but combinatorially equivalent, and must therefore have the same weight: 
\begin{align}
\begin{tikzpicture}[baseline=(base), scale = .4]
\coordinate (base) at (0, 1);
 \draw (0, 0) node[cross]{};
  \draw (3, 0) node[cross]{};
  \draw (0, 3) node[cross]{};
  \draw (3, 3) node[cross]{};
 \draw[red, thick] (-.5, -.5) to [out = -45, in = -45] (3.7, 4) to [out = 135, in = 90] (-.6, 2.8) to [out = -90, in = 135] (3.5, 3.5) to [out = -45, in = 135] (-.5, -.5);
\end{tikzpicture}
\qquad \qquad \qquad 
\begin{tikzpicture}[baseline=(base), scale = .4]
\coordinate (base) at (0, 1);
 \draw (0, 0) node[cross]{};
  \draw (3, 0) node[cross]{};
  \draw (0, 3) node[cross]{};
  \draw (3, 3) node[cross]{};
 \draw[red, thick] (0, -.6) to [out = 0, in = 0] (0, 3.6) to [out = 180, in = 180] (0, -.6);
\end{tikzpicture}
\end{align}
This leads to 8 combinatorially inequivalent classes of loops, with 8 different weights: contractible loops with weight $n$, $i$-loops around the vertex at $z_i$ with weight $w_i$, and $s$-loops, $t$-loops, $u$-loops that split the 4 vertices in pairs:
\begin{align}
 \begin{tikzpicture}[baseline=(base), scale = .6]
\coordinate (base) at (0, 1);
 \draw (0, -.2) node[cross]{};
  \draw (3, -.2) node[cross]{};
  \draw (0, 2.6) node[cross]{};
  \draw (3, 2.6) node[cross]{};
  \draw[red, thick] (0, -.2) circle [radius = .4]; 
   \draw[red, thick] (3, -.2) circle [radius = .4]; 
    \draw[red, thick] (0, 2.6) circle [radius = .4]; 
   \draw[red, thick] (3, 2.6) circle [radius = .4]; 
   \draw[blue, thick] (0, -.8) to [out = 0, in = 0] (0, 3.8) to [out = 180, in = 180] (0, -.8);
   \draw[blue, thick] (-1.4, 0) to [out = 90, in = 90] (3.8, 0) to [out = -90, in = -90] cycle;
   \draw[blue, thick] (-1, 4) to [out = 45, in = 135] (2.4, 2.4) to [out = -45, in = 45] (4, -1) to
   [out = -135, in = -45] (.6, .6) to [out = 135, in = -135] cycle;
   \draw[thick, green!60!black] (6, 1) circle [radius = 1.3];
   \node[blue] at (-1.9, 1.5) {$w_s$};
   \node[blue] at (-1.9, -.5) {$w_t$};
   \node[blue] at (-1.9, 3.5) {$w_u$};
   \node[green!60!black] at (7.7, 1) {$n$};
   \node[red] at (0, .5) {$w_1$};
   \node[red] at (0, 3.3) {$w_2$};
    \node[red] at (3, .5) {$w_4$};
   \node[red] at (3, 3.3) {$w_3$};
  \end{tikzpicture}
\end{align}
Since loops do not intersect, a configuration $E$ that contains $s$-loops has no $t$-loops and $u$-loops. 

\subsubsection{Loop-ending punctures and combinatorial maps}

We also introduce another type of punctures, where open loops can end. Such a puncture has a valency $2r\in\mathbb{N}^*$, with $r=0$ corresponding to the previously introduced weight-changing punctures. In the presence of $N$ punctures, the number of open loops is 
\begin{align}
 \sum_{i=1}^N r_i \in \mathbb{N} \ . 
 \label{srin}
\end{align}
Conformal symmetry allows us to specify how vertices are related by open loops: this information is called a combinatorial map \cite{gjnrs23}. For example, in the presence of punctures of valencies $3,2,1,0$, there exist 4 combinatorial maps:
\begin{align}
  \begin{tikzpicture}[baseline=(base), scale = .4]
   \uvertex 
   \draw (0, 0) -- (0, 3);
   \draw (0, 0) to [out = 60, in = -150] (3, 3) to [out = -120, in = 30] (0, 0);
  \end{tikzpicture}
\qquad \qquad 
\begin{tikzpicture}[baseline=(base), scale = .4]
   \uvertex 
   \draw (0, 3) -- (0, 0) -- (3, 3);
   \draw (0, 0) to [out = -30, in = -135] (3.5, -0.5) to [out = 45, in = -60] (3, 3);
  \end{tikzpicture}
  \qquad  \qquad 
\begin{tikzpicture}[baseline=(base), scale = .4]
   \uvertex 
   \draw (0, 3) -- (3, 3) -- (0, 0);
   \draw (0, 0) to [out = 20, in = 90] (3.5, 0) to [out = -90, in = -20] (0, 0);
  \end{tikzpicture}
  \qquad  \qquad 
\begin{tikzpicture}[baseline=(base), scale = .4]
   \uvertex 
   \draw (0, 0) to [out = 70, in = 0] (0, 3.5) to [out = 180, in = 110] (0, 0);
   \draw (0, 0) -- (0, 3);
   \draw (3, 3) to [out = -70, in = 0] (3, -.5) to [out = 180, in = -110] (3, 3);
  \end{tikzpicture}
  \label{4maps}
\end{align}
Notice that we forbid open loops that can be pulled inside punctures, as they are indistinguishable from contractible loops. This is the reason why we do not count the following map, where the bottom left vertex would have valency $1$ and not $3$:
\begin{align}
 \begin{tikzpicture}[baseline=(base), scale = .4]
   \uvertex 
   \draw (0, 3) -- (3, 3) -- (0, 0);
   \draw (0, 0) to [out = 20, in = 90] (2, 0) to [out = -90, in = -20] (0, 0);
  \end{tikzpicture}
\end{align}
To a combinatorial map $M$, we associate the ensemble $\mathcal{E}_M$ of configurations of non-intersecting open and closed loops, such that the open loops connect the punctures according to $M$. The map $M$ dictates which types of closed loops can exist: for example, the last map in Eq. \eqref{4maps} allows closed loops with weights $n,w_4,w_s$. The weights of open loops are again constrained by conformal symmetry, which allows them to depend on the relative angles of open loops at vertices. More precisely, at any puncture we have a weight factor that depends on an angular momentum $s$,
\begin{align}
 \boxed{w_{(r,s)}(\{\theta_k\}) = \exp \left\{\tfrac{i}{2} s\textstyle{\sum}_{k=1}^{2r}\theta_{k}\right\}}\ .
 \label{wrs}¨
\end{align}
where the angles are measured with respect to a reference direction, and a reference open loop whose angle is $\theta_1$:
\begin{align}
 \theta_{k}\in [\theta_{1}, \theta_{1}+2\pi)
\qquad \qquad 
 \begin{tikzpicture}[baseline=(base), scale = .5]
  \coordinate (base) at (0, 0);
  \draw [domain=0:410,variable=\t,smooth,samples=35,red,-latex]
        plot ({90-\t}: {1.6- \t/1000});
  \draw[-latex, red] (0, 2.4) arc (90:10:2.4);
  \draw[-latex, red] (0, 2) arc (90:-60:2);
  \draw (0, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
  \foreach\t in {10, 40, 120, 150, 230, 300}{
  \draw (0, 0) -- ++(\t:3);
  }
  \draw[ultra thick, blue, dashed] (0, 0) -- ++(90:3);
  \draw[ultra thick] (0, 0) -- ++(10:3);
  \node[right] at ++(10:3) {$\theta_{1}$};
  \node[right] at ++(300:3) {$\theta_{2}$};
  \node[right] at ++(40:3) {$\theta_{2r}$};
 \end{tikzpicture}
 \label{titt}
\end{align}
The reference direction would define each angle modulo $2\pi$. Thanks to the reference open loop and the cyclic ordering of open loops around the vertex, our angles are actually defined modulo a collective shift $(\theta_k) \to (\theta_k+2\pi)$. This shift leaves our weight factor invariant provided 
\begin{align}
 rs\in \mathbb{Z}\ . 
\end{align}
Under a change of reference direction or reference open loop, the weight of a configuration $E$ changes by an $E$-independent factor.

We define correlation functions that depend on the punctures $z_1,\dots,z_N$ with their parameters $(r_1,s_1),\dots, (r_N,s_N)$, on the map $M$ and on the weights of closed loops $\{w_k\}$:
\begin{align}
 Z\Big(\{z_i\},\{(r_i,s_i)\},\{w_k\}\Big|\mathcal{E}_M\Big) =\sum_{E\in\mathcal{E}_M} \prod_{i=1}^N w_{(r_i,s_i)}(E) \prod_{\ell\in E} w(\ell) \ , 
 \label{zbig}
\end{align}
where the last product is over closed loops, with $w(\ell)\in\{w_k\}$. 


\subsubsection{Cases of the $O(n)$, $U(n)$ and Potts models}\label{sec:coup}

In the $O(n)$ model, there are no weight-changing punctures. All closed loops have the same weight $n$, whether or not they are contractible. On the other hand,  
all possible loop-ending punctures are allowed. 

In the $U(n)$ model, we add the restriction that all loops (closed and open) can be oriented such that any two neighbouring loops have opposite orientations. Equivalently, the Riemann sphere should be bicolorable, with each loop separating two regions of different colors. This allows only punctures with even valencies $2r\in 2\mathbb{N}^*$:
\begin{align}
 \begin{tikzpicture}[baseline=(current  bounding  box.center), scale = .4]
 \clip (-4, -4) rectangle (4, 4);
  \filldraw[thick, fill = red!30] (0, 0) to [out = 100, in = -120] (0, 2) to [out = 60, in = -150] (0, 4.2) -- (4.2, 4.2) -- (4.2, 1) to [out = 160, in = 60] (2, 1.5) to [out = -120, in = 20] (0, 0);
  \filldraw[thick, fill = red!30] (0, 0) to [out = -20, in = 80] (1, -2) to [out = -100, in = 130] (2, -4.2) -- (-3.5, -4.2) to [out = 50, in = -40] (-3, -2) to [out = 120, in = -110] (0, 0);
  \filldraw[thick, fill = red!30] (-3.5, 2) to [out = 90, in = 120] (-1.5, 3) to [out = -60, in = -80] (-2.5, 1.5) to [out = 100, in = -90] (-3.5, 2);
   \draw (0, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
 \end{tikzpicture}
\end{align}
The Potts model is the same as the $U(n)$ model, except that the fundamental geometrical objects are clusters instead of loops, with loops forming the boundaries of clusters. In general, loops and clusters are equivalent: in the above example, a puncture of valency 4 is a point where 2 large clusters meet, where a cluster is large if it cannot be pulled inside the puncture. In the following example, an open loop can be pulled inside the puncture, and we have a squeezed cluster rather than the meeting of two different clusters:
\begin{align}
 \begin{tikzpicture}[baseline=(current  bounding  box.center), scale = .4]
  \clip (-4, -4) rectangle (4, 4);
  \filldraw[thick, fill = red!30] (0, 0) to [out = 100, in = -120] (0, 2) to [out = 60, in = -150] (0, 4.2) -- (4.2, 4.2) -- (4.2, -4.2) -- (-3.5, -4.2) to [out = 50, in = -40] (-3, -2) to [out = 120, in = -110] (0, 0) to [out = -50, in = -80] (2.5, -.5) to [out = 100, in = 35] (0, 0);
   \draw (0, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
 \end{tikzpicture}
\end{align}
However, there is a subtle difference between loops and clusters in the case of a puncture of valency 2. In the following two examples, which are equivalent in the loop model, the puncture belongs to a large cluster in the first case but not in the second one: 
\begin{align}
 \begin{tikzpicture}[baseline=(current  bounding  box.center), scale = .4]
  \fill[red!30] (-2, -3) rectangle (5, 2);
  \filldraw[thick, fill = white] (0, 0) to [out = -90, in = -80] (3, -.5) to [out = 100, in = 55] (0, 0);
   \draw (0, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
   \filldraw[thick, fill = red!30] (10, 0) to [out = -90, in = -80] (13, -.5) to [out = 100, in = 55] (10, 0);
   \draw (10, 0) node[fill, circle, minimum size = 2mm, inner sep = 0]{};
 \end{tikzpicture}
\end{align}
The correct condition for a puncture to belong to one large cluster is in fact that no closed loop goes around that puncture. 
Therefore, the Potts model has punctures with valencies $2r\in 2(\mathbb{N}+2)$, and weight-changing punctures of weight $w=0$.


\subsection{Relation with loop CFTs}

The claim that loop CFTs describe the critical limit of loop models is supported by a large body of work, including very precise numerical results. However, it is not easy to derive it with simple arguments. In fact, it is already tricky to derive the relation between the central charge $c$ and the contractible loop weight $n$. Historical arguments give the correct relation but are complicated and not always conceptually compelling. See for example Appendix A of \cite{grz18} for a discussion of Kondev's original argument, which relies on a shaky construction using a free boson, and for an attempt to patch the argument's perceived flaws with the help of the torus partition function. 

We will now propose an argument that starts with relating non-diagonal primary fields $V_{(r,s)}$ with loop-ending punctures. This is relatively straightforward, because both objects have discrete parameters. We will then deduce the relation between diagonal fields $V_P$ and weight-changing punctures, and finally the relation between the central charge and the contractible loop weight. 
This argument avoids the introduction of auxiliary or complicated objects, with the hope of being reasonably clear and simple. 

\subsubsection{Relations between punctures and primary fields}

Our starting assumption is that in the critical limit, a loop-ending puncture tends to a primary field of a loop CFT. We have used the same notations $r,s$ for these punctures' parameters as for the parameters of non-diagonal fields $V_{(r,s)}$. Let us show that this is justified by an identification of parameters:
\begin{itemize}
 \item In the CFT, as a result of the existence of the degenerate field $V^d_{\langle 1,2\rangle}$, the first Kac index $r$ is half-integer, and conserved modulo $\mathbb{Z}$, see Eq. \eqref{sriz}. For a loop-ending puncture, $2r$ is the valency, and it obeys the same constraints, see Eq. \eqref{srin}.
 \item In the CFT, $rs$ is the conformal spin, and it is integer for bosonic fields. Under a rotation around the puncture, which we interpret as $\theta_k\mapsto \theta_k + \theta$, the weight factor \eqref{wrs} picks a factor $e^{irs\theta}$: according to Eq. \eqref{veis}, this means that our loop-ending puncture has the conformal spin $rs$. 
\end{itemize}
Therefore, a loop-ending puncture can be identified with a non-diagonal primary field $V_{(r,s)}$ in a CFT where $V^d_{\langle 1,2\rangle}$ exists. 

Next, let us consider a weight-changing puncture of weight $w$. We again assume that it tends to a primary field. Since $w$ is a continuous parameter, this must be a diagonal field. To determine its momentum, let us use the idea \eqref{sP} that a diagonal field is a non-diagonal field with $r=0$. The analogous idea for punctures is that the weight $w$ of a closed loop is related to the weight factor \eqref{wrs} associated to a rotation $\theta = 2\pi$. In fact, since our closed loop is not oriented, we have to add the rotations by $2\pi$ and $-2\pi$, and we find $w=2\cos(\pi s)$, i.e. Eq. \eqref{wP}. 

Finally, the identity field $V^d_{\langle 1,1\rangle}$ should not change the weight of loops. Assuming that 
the corresponding loop weight is computed from Eq. \eqref{wP} with $P=P_{(1,1)}$, we obtain the expression \eqref{ncb} for the contractible loop weight $n$ in terms of the central charge. We do not discuss the loop model interpretation of the non-trivial degenerate fields $V^d_{\langle 1,s\geq 2\rangle}$, because we will not study their correlation functions. These fields cannot simply correspond to weight-changing punctures, since  the weight associated to $P=P_{(1,3)}$ is again $n$. 

\subsubsection{Correlation functions}

According to our identification of punctures with primary fields, the loop model $N$-point function \eqref{zbig} should correspond to a loop CFT $N$-point function of the type $\left<\prod_{i=1}^N V_{(r_i,s_i)}\right>$, which should be single-valued and crossing-symmetric. In any channel, the spectrum that appears in the crossing symmetry equations is made of 
\begin{itemize}
 \item all non-diagonal fields that are allowed by the conservation of $r\bmod 1$,
 \item if integer values of $r$ are allowed, all diagonal fields that have the correct loop weight \eqref{wP}. 
\end{itemize}
For example, in the case $N=4$, the $s$-channel spectrum that appears in the crossing symmetry equation is 
\begin{align}
\renewcommand{\arraystretch}{1.5} 
 \mathcal{S}^{(s)} = 
 \left\{\begin{array}{ll} 
          \left\{V_{(r,s)}\right\}_{\substack{r\in \frac12+\mathbb{N} \\ s\in\frac{1}{r}\mathbb{Z}}} & \text{ if } r_1+r_2\equiv \frac12 \bmod 1 \ , 
          \\
          \left\{V_{(r,s)}\right\}_{\substack{r\in \mathbb{N}^* \\ s\in\frac{1}{r}\mathbb{Z}}}
          \cup \left\{V_{P_s+k\beta^{-1}}\right\}_{k\in\mathbb{Z}} & \text{ if } r_1+r_2\equiv 0 \bmod 1 \ , 
        \end{array}
\right.
\end{align}
where the diagonal fields take all possible momentums that correspond to the loop weight $w_s=2\cos(2\pi \beta P_s)$. 

The crossing symmetry equations for $\left<\prod_{i=1}^N V_{(r_i,s_i)}\right>$, with the spectrums that we just sketched, define a vector space of solutions. 
The conjecture is that each combinatorial map corresponds to a solution, and that these solutions form a basis of the space of solutions \cite{gjnrs23}. 
For example, the existence of the 4 combinatorial maps
\eqref{4maps} implies that for any allowed values of the parameters $s_1,s_2,s_3,P_4$, the space of 4-point functions of the type $\left<V_{(\frac32,s_1)}V_{(1,s_2)}V_{(\frac12,s_3)}V_{P_4}\right>$ has dimension 4. 

How do we interpret the dependence of the $s$-channel spectrum on a channel weight $w_s$? The $s$-channel spectrum of a 4-point function should only depend on the 4 fields $V_{(r_i,s_i)}$. For $w_s\neq n$, the dependence on $w_s$ is conjectured to be a manifestation of the presence of an $s$-channel combinatorial defect --- an object that gives non-trivial weights to $s$-loops \cite{rib22}. 

loop weights depend not just on topology so defect is combinatorial.

4pt fct not really correl. fct but more elaborate object. (Mention torus partition function?)

Preserves decomposition into blocks, 

Relate individual maps: signature of a combinatorial map. 

Cases of $O(n)$, Potts etc: modified counting of solutions, need to forbid or allow some maps based on deg. fields fusion rules etc. 

\subsubsection{Values of the central charge}

The $O(n)$, $U(n)$ and Potts CFTs were originally defined as critical limits of statistical lattice models. In each case, the lattice model has a critical limit under some conditions on $n$ or $Q$. If these parameters are assumed to be real, the conditions are $n\in (-2,2)$ or $Q\in (0,4)$, equivalently $c\in (-2,1)$. The region of criticality actually extends into the complex $c$-plane, although it is much smaller than the half-plane $\Re c<13$ \cite{bjjz22}. Outside that region, certain fields become relevant, so the models may become multicritical. Moreover, the $O(n)$ lattice model has a dilute and a dense phase, and each phase gives rise to a different CFT in the critical limit. Each phase has its own value of $\beta^2$, given by solving Eq. \eqref{nQ} with $\beta^2\in (0,1)$ (dense phase) or $\beta^2\in (1,2)$ (dilute phase), if we assume $n\in (-2,2)$. 
As a result, there can exist two different $O(n)$ CFTs with the same central charge but different values of $n$, related by $\beta \to\beta^{-1}$. Similar phenomenons also occurs in the $U(n)$ and Potts CFTs.

Values of parameters: non-rational $\beta^2$? Statement on basis of solutions true for all allowed values. But relation with statistical model limited to critical region, cite equation for  this region! Case of momentum: region not known...
Loop weight invariant under shifts, but CFT not invariant, discussion of criticality and values of the central charge and loop weights. $\Re\Delta_{(1,3)}>1$. 

Pb of $n$ vs $-n$ in Potts, $U(n)$ and degenerate fields. Gamsa--Cardy operators. Degenerate fields do have nontrivial correlators! But $s\to s+2$ same weight, how do we distinguish energy operator from identity in loop model?

How do we see that a field is degenerate in the loop CFT? In the CFT deg. fields have special OPEs. But in the loop model their weight is a special value of a continuous parameter: what happens to the argument that single-valuedness excludes $V_{\langle 1,2\rangle}^d$ from the $O(n)$ model? 

\subsection{Analytic properties of structure constants}

Poles and their cancellations. Polynomials are natural in statistical model but valid only after stripping off non-polynomial structure constants. 

Signature of maps, trying to match individual bootstrap solutions. Degrees of polynomials. Triogonometric coefficients. 


\subsection{Examples of 4-point structure constants}

\section{Logarithmic representations and fields} \label{sec:log}

Higher equations of motion in Liouville theory, summarized in Artemev--Belavin. Relevant to log CFT? 

Reread results on limits of 4pt functions, try to infer general rules on appearance of logarithms, depending on fusion rules?

Logarithmic fields?

Criterion for $b^2\in\mathbb{Q}$ limit to become logarithmic? For 4pt function, criterion about vanishing of residues, which depends on fusion rules being obeyed for NV? In MM case we completely escape log. reps, criterion should account for that.  
For $c>25$, what happens to GMM at rational $b^2$? Concidences of dimensions boil down to $\Delta_{(r,s)}-\Delta_{(r,-s)} \in \mathbb{Z}$ modulo $(p, -q)$. 

We need log reps. Can deduce them from non-log using degenerate fields. Issue is conceptually less important if we adopt interchiral symmetry, since logarithms only appear for interchiral descendants. 

To get log reps we need associativity of OPE of degenerate field. We might say that this does not belong to the chiral, algebraic part of the review. However, to get conformal blocks we need associativity of OPEs of the energy-momentum tensor. Again, interchiral point of view changes things! And we need bootstrap axioms, including single-valuedness? 

Emergence of logarithms: $\Delta_{P+\frac{\beta}{2}}-\Delta_{P-\frac{\beta}{2}} = \beta P$ integer $\implies P=P_{(0,s)}$. This calculation is a diagonal version of the argument about integer spin that leads to non-diagonal $O(n)$ space of states.

In $V^d_{\langle 1,2\rangle}V^N_{(r,0)} = \sum_\pm V^N_{(r,\pm 1)}$ it is not just spins but also dimensions that differ by integers. Study singularities of OPE coefficients. 

Need we assume that $V^N_{(r,0)}$ is the limit of diagonal fields? Why would we not get $V_{P_{(r,0)}}$? Are there two ways to take the limit? See OPE coefficients. 

Compute vanishings of ratios of structure constants in $V^d_{\langle 2,1\rangle}V_P$. 
For $P=P_{(0,n)}$ with $n\in\mathbb{N}$ we find only $V_{P_{(-1,n)}}$ i.e. the coef of $V_{P_{(1,n)}}$ vanishes. For $n>0$, this is a consequence of Virasoro symmetry i.e. appearance of NV whose fusion rules would be violated. For $n=0$ this does not follow from Virasoro symmetry: interpret as interchiral phenomenon?

For $P=P_{(1,n)}$ with $n\in\mathbb{N}$ we find only $V_{P_{(2,n)}}$ i.e. the coef of $V_{P_{(0,n)}}$ vanishes. Now, Virasoro symmetry is not responsible. In fact it would be perfectly consistent to have $V_{P_{(0,n)}}$ alone, the OPE coefs are not divergent. The problem is purely interchiral: it is about the ratio of coefs in an interchiral module, not in a Virasoro module. 

\bibliographystyle{cft}
\bibliography{cft}

%\input{refs.tex}

\end{document}


\appendix




\end{document}

